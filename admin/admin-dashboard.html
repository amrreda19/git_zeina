<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</title>
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" as="script">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="../js/supabase-config.js"></script>
    <script src="../js/admin-security.js"></script>
    <script src="../js/product-requests-service.js"></script>
    <script src="../js/advertising-service.js"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1994970196400389"
     crossorigin="anonymous"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            direction: rtl;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 2em;
            font-weight: bold;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
        }

        .nav-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            text-decoration: none;
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .welcome-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            margin-bottom: 30px;
            text-align: center;
        }

        .welcome-title {
            font-size: 2.5em;
            color: #333;
            margin-bottom: 15px;
        }

        .welcome-subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 1.1em;
            font-weight: 600;
        }

        .quick-actions {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.8em;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .action-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .action-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .action-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .action-description {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .recent-activity {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .activity-list {
            list-style: none;
        }

        .activity-item {
            padding: 15px 0;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            font-size: 1.5em;
            color: #667eea;
        }

        .activity-content {
            flex: 1;
        }

        .activity-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .activity-time {
            color: #666;
            font-size: 0.9em;
        }

        .user-info {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .user-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .user-role {
            opacity: 0.9;
            font-size: 0.9em;
        }

        /* Product Requests Styles */
        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            color: #6b7280;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .filter-btn:hover {
            border-color: #667eea;
            color: #667eea;
        }

        .filter-btn.active {
            background: #667eea;
            border-color: #667eea;
            color: white;
        }

        .filter-btn.debug-btn {
            background: #f59e0b;
            border-color: #f59e0b;
            color: white;
        }

        .filter-btn.debug-btn:hover {
            background: #d97706;
            border-color: #d97706;
        }

        .filter-btn.test-btn {
            background: #10b981;
            border-color: #10b981;
            color: white;
        }

        .filter-btn.test-btn:hover {
            background: #059669;
            border-color: #059669;
        }

        .request-card {
            background: white;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .request-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .request-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .request-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .status-pending {
            background: #fef3c7;
            color: #d97706;
        }

        .status-approved {
            background: #d1fae5;
            color: #059669;
        }

        .status-rejected {
            background: #fee2e2;
            color: #dc2626;
        }

        .request-images {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .request-image {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
        }

        .request-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-approve {
            background: #10b981;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-approve:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        .btn-reject {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-reject:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

        .btn-view {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-view:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .nav-buttons {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .actions-grid {
                grid-template-columns: 1fr;
            }
        }

        .btn-modal-secondary:hover {
            border-color: #9ca3af;
            color: #374151;
        }

        /* ===== ØªØµÙ…ÙŠÙ… Ù…Ø­ØªØ±Ù Ù„Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ===== */
        
        /* Ø®Ù„ÙÙŠØ© Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.9) 0%, rgba(118, 75, 162, 0.9) 100%);
            backdrop-filter: blur(10px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .modal-overlay[style*="display: flex"] {
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .modal-overlay.show {
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        /* Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal-content {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 24px;
            max-width: 700px;
            width: 95%;
            max-height: 85vh;
            overflow-y: auto;
            transform: translateY(-30px) scale(0.95);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.15),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .modal-overlay.show .modal-content {
            transform: translateY(0) scale(1);
        }
        
        .modal-overlay[style*="display: flex"] .modal-content {
            transform: translateY(0) scale(1);
        }
        
        /* Ø±Ø£Ø³ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 28px 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 24px 24px 0 0;
            position: relative;
            overflow: hidden;
        }
        
        .modal-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 50%, rgba(255,255,255,0.1) 100%);
            animation: shimmer 3s ease-in-out infinite;
        }
        
        @keyframes shimmer {
            0%, 100% { transform: translateX(-100%); }
            50% { transform: translateX(100%); }
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 800;
            color: white;
            margin: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: relative;
            z-index: 1;
        }
        
        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            font-size: 1.5rem;
            color: white;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 50%;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: rotate(90deg) scale(1.1);
        }
        
        /* Ø¬Ø³Ù… Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal-body {
            padding: 32px;
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            position: relative;
        }
        
        .modal-body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.2), transparent);
        }
        
        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ù†Ø§ÙØ°Ø© */
        .modal-content {
            position: relative;
        }
        
        .modal-content::after {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #667eea, #764ba2, #667eea);
            border-radius: 26px;
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .modal-content:hover::after {
            opacity: 0.1;
        }
        
        /* ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© */
        .modal-footer {
            padding: 28px 32px;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 0 0 24px 24px;
            display: flex;
            justify-content: flex-end;
            gap: 16px;
            border-top: 1px solid rgba(226, 232, 240, 0.8);
        }

        /* ===== ØªØµÙ…ÙŠÙ… Ù…Ø­ØªØ±Ù Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ===== */
        
        .form-group {
            margin-bottom: 24px;
            position: relative;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }
        
        .form-group label:hover {
            color: #667eea;
        }
        
        .form-group select,
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.3s ease;
            background: linear-gradient(145deg, #ffffff 0%, #f9fafb 100%);
            box-shadow: 
                0 2px 4px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }
        
        .form-group select:focus,
        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 
                0 0 0 3px rgba(102, 126, 234, 0.1),
                0 4px 8px rgba(102, 126, 234, 0.15);
            transform: translateY(-1px);
        }
        
        .form-group select:hover,
        .form-group input:hover,
        .form-group textarea:hover {
            border-color: #d1d5db;
            transform: translateY(-1px);
        }
        
        .form-group select:disabled {
            background: linear-gradient(145deg, #f3f4f6 0%, #e5e7eb 100%);
            color: #9ca3af;
            cursor: not-allowed;
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„ØµÙÙˆÙ */
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 24px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
                gap: 16px;
            }
        }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn-modal-primary,
        .btn-modal-secondary {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            min-width: 140px;
        }
        
        .btn-modal-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .btn-modal-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn-modal-primary:hover::before {
            left: 100%;
        }
        
        .btn-modal-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-modal-primary:active {
            transform: translateY(0);
        }
        
        .btn-modal-secondary {
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            color: #374151;
            border: 2px solid #d1d5db;
            padding: 14px 28px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-modal-secondary:hover {
            background: linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%);
            border-color: #9ca3af;
            transform: translateY(-1px);
        }
        
        .btn-modal-primary span,
        .btn-modal-secondary span {
            font-size: 1.1rem;
            transition: transform 0.3s ease;
        }
        
        .btn-modal-primary:hover span,
        .btn-modal-secondary:hover span {
            transform: scale(1.1);
        }
        
        /* Request Details Styles */
        .request-detail-item {
            margin-bottom: 15px;
            padding: 12px;
            background: #f9fafb;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }

        .request-detail-label {
            font-weight: 600;
            color: #374151;
            margin-bottom: 5px;
            display: block;
        }

        .request-detail-value {
            color: #6b7280;
            line-height: 1.5;
        }

        .request-images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }

        .request-image-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid #e5e7eb;
        }

        .request-image-item img {
            width: 100%;
            height: 120px;
            object-fit: cover;
            transition: transform 0.2s ease;
        }

        .request-image-item:hover img {
            transform: scale(1.05);
        }

        .request-image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .request-image-item:hover .request-image-overlay {
            opacity: 1;
        }

        .request-image-overlay button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background 0.2s ease;
        }

        .request-image-overlay button:hover {
            background: #2563eb;
        }

        /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
        .advertising-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 10px 20px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .tab-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .tab-btn:hover:not(.active) {
            background: #f3f4f6;
        }

        .add-ad-btn {
            background: #10b981;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-ad-btn:hover {
            background: #059669;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .ads-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-label {
            display: block;
            color: #6b7280;
            font-size: 0.875rem;
            margin-bottom: 5px;
        }

        .stat-value {
            display: block;
            font-size: 1.5rem;
            font-weight: 600;
            color: #111827;
        }
        
        /* Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø© */
        .stats-overview {
            padding: 20px;
        }
        
        .stats-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .main-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.15);
        }
        
        .stat-card.primary {
            border-left: 4px solid #3b82f6;
        }
        
        .stat-card.success {
            border-left: 4px solid #10b981;
        }
        
        .stat-card.info {
            border-left: 4px solid #06b6d4;
        }
        
        .stat-card.warning {
            border-left: 4px solid #f59e0b;
        }
        
        .stat-icon {
            font-size: 2.5rem;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: #f3f4f6;
        }
        
        .stat-content {
            flex: 1;
        }
        
        .stat-content .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #111827;
            margin-bottom: 5px;
        }
        
        .stat-content .stat-label {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
        }
        
        .performance-stats {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .performance-stats h4 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 20px;
        }
        
        .performance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .performance-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: #f9fafb;
            border-radius: 8px;
        }
        
        .performance-label {
            font-weight: 500;
            color: #374151;
        }
        
        .performance-value {
            font-weight: 600;
            color: #111827;
            font-size: 1.125rem;
        }
        
        .detailed-stats {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        
        .detailed-stats h4 {
            font-size: 1.25rem;
            font-weight: 600;
            color: #111827;
            margin-bottom: 20px;
        }
        
        .stats-section {
            margin-bottom: 30px;
        }
        
        .stats-section h5 {
            font-size: 1.125rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 15px;
        }
        
        .stats-table-container {
            overflow-x: auto;
        }
        
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stats-table th {
            background: #f3f4f6;
            padding: 15px;
            text-align: right;
            font-weight: 600;
            color: #374151;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .stats-table td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .stats-table tr:hover {
            background: #f9fafb;
        }
        
        .stats-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .btn-secondary {
            background: #6b7280;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            background: #4b5563;
        }

        .ads-table-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .ads-table {
            width: 100%;
            border-collapse: collapse;
        }

        .ads-table th,
        .ads-table td {
            padding: 12px;
            text-align: right;
            border-bottom: 1px solid #e5e7eb;
        }

        /* Ø£Ù†Ù…Ø§Ø· Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
        .ads-cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .ad-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
        }

        .ad-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .ad-card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            position: relative;
        }

        .ad-card-header .ad-type-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255,255,255,0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            backdrop-filter: blur(10px);
        }

        .ad-card-header .ad-status-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .ad-card-header .ad-status-badge.active {
            background: #10b981;
            color: white;
        }

        .ad-card-header .ad-status-badge.paused {
            background: #f59e0b;
            color: white;
        }

        .ad-card-header .ad-status-badge.expired {
            background: #ef4444;
            color: white;
        }

        .ad-card-title {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .ad-card-subtitle {
            font-size: 0.875rem;
            opacity: 0.9;
        }

        .ad-card-body {
            padding: 20px;
        }

        .ad-card-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .ad-info-item {
            display: flex;
            flex-direction: column;
        }

        .ad-info-label {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .ad-info-value {
            font-size: 0.875rem;
            color: #1f2937;
            font-weight: 500;
        }

        .ad-card-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
        }

        .ad-stat-item {
            text-align: center;
        }

        .ad-stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3b82f6;
            display: block;
        }

        .ad-stat-label {
            font-size: 0.75rem;
            color: #6b7280;
            margin-top: 4px;
        }

        .ad-card-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .ad-action-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .ad-action-btn.edit {
            background: #3b82f6;
            color: white;
        }

        .ad-action-btn.edit:hover {
            background: #2563eb;
        }

        .ad-action-btn.delete {
            background: #ef4444;
            color: white;
        }

        .ad-action-btn.delete:hover {
            background: #dc2626;
        }

        .ad-action-btn.pause {
            background: #f59e0b;
            color: white;
        }

        .ad-action-btn.pause:hover {
            background: #d97706;
        }

        .ad-action-btn.activate {
            background: #10b981;
            color: white;
        }

        .ad-action-btn.activate:hover {
            background: #059669;
        }

        /* Ø±Ø³Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª */
        .no-ads-message {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .no-ads-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .no-ads-message h3 {
            color: #374151;
            margin-bottom: 10px;
            font-size: 1.5rem;
        }

        .no-ads-message p {
            color: #6b7280;
            margin-bottom: 30px;
            font-size: 1.125rem;
        }

        .ads-table th {
            background: #f9fafb;
            font-weight: 600;
            color: #374151;
        }

        .ads-table tr:hover {
            background: #f9fafb;
        }

        .requests-filters {
            margin-bottom: 20px;
        }

        .requests-filters select {
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .btn-modal-success {
            background: #10b981;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-modal-success:hover {
            background: #059669;
        }

        .btn-modal-danger {
            background: #ef4444;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-modal-danger:hover {
            background: #dc2626;
        }

        /* Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ù…Ø±ØªØ¨Ø· */
        .ad-product-info {
            background: #f8fafc;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin: 15px 20px;
            overflow: hidden;
        }

        .ad-product-info.no-product {
            background: #fef3c7;
            border-color: #f59e0b;
        }

        .product-header {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 12px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ad-product-info.no-product .product-header {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .product-badge {
            font-size: 0.875rem;
            font-weight: 600;
        }

        .product-category {
            background: rgba(255,255,255,0.2);
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
        }

        .no-product-badge {
            font-size: 0.875rem;
            font-weight: 600;
        }

        .product-details {
            padding: 15px;
        }

        .product-name {
            font-size: 1.125rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 8px;
        }

        .product-description {
            color: #6b7280;
            margin-bottom: 12px;
            line-height: 1.5;
        }

        .product-price {
            font-size: 1rem;
            font-weight: 600;
            color: #059669;
            margin-bottom: 12px;
        }

        .product-location {
            display: flex;
            gap: 15px;
            margin-bottom: 12px;
        }

        .location-item {
            background: #e5e7eb;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.75rem;
            color: #374151;
        }

        .product-images {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
        }

        .images-count {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .product-thumbnail {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 6px;
            border: 2px solid #e5e7eb;
        }

        .product-social {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .social-item {
            background: #dbeafe;
            color: #1e40af;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        /* Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .ad-card-elegant {
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #e5e7eb;
            cursor: pointer;
            position: relative;
        }

        .ad-card-elegant:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
        }

        .ad-card-image-container {
            position: relative;
            height: 250px;
            overflow: hidden;
        }

        .ad-card-main-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.4s ease;
        }

        .ad-card-elegant:hover .ad-card-main-image {
            transform: scale(1.1);
        }

        .ad-card-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(0,0,0,0.1) 0%, rgba(0,0,0,0.4) 100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
        }

        .ad-card-elegant:hover .ad-card-overlay {
            opacity: 1;
        }

        .ad-card-badges {
            display: flex;
            gap: 10px;
            justify-content: space-between;
        }

        .ad-type-badge-elegant {
            background: rgba(255,255,255,0.9);
            color: #374151;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        .ad-status-badge-elegant {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            color: white;
        }

        .ad-status-badge-elegant.active {
            background: rgba(16, 185, 129, 0.9);
        }

        .ad-status-badge-elegant.paused {
            background: rgba(245, 158, 11, 0.9);
        }

        .ad-status-badge-elegant.expired {
            background: rgba(239, 68, 68, 0.9);
        }

        .ad-card-hover-info {
            text-align: center;
            color: white;
        }

        .hover-text {
            background: rgba(0,0,0,0.7);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .ad-card-content {
            padding: 20px;
        }

        .ad-card-header-elegant {
            margin-bottom: 15px;
        }

        .ad-card-title-elegant {
            font-size: 1.25rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 5px;
            line-height: 1.3;
        }

        .ad-card-subtitle-elegant {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
        }

        .ad-card-product-info {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 12px;
            border-left: 4px solid #3b82f6;
        }

        .product-name-elegant {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 8px;
        }

        .product-price-elegant {
            font-size: 1rem;
            font-weight: 600;
            color: #059669;
            margin-bottom: 5px;
        }

        .product-category-elegant {
            font-size: 0.875rem;
            color: #6b7280;
            font-weight: 500;
        }

        .ad-card-meta {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px;
            background: #f1f5f9;
            border-radius: 8px;
            font-size: 0.875rem;
        }

        .meta-icon {
            font-size: 1rem;
        }

        .meta-text {
            color: #475569;
            font-weight: 500;
        }

        .ad-card-actions-elegant {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .ad-action-btn-elegant {
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .ad-action-btn-elegant.edit {
            background: #3b82f6;
            color: white;
        }

        .ad-action-btn-elegant.edit:hover {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .ad-action-btn-elegant.delete {
            background: #ef4444;
            color: white;
        }

        .ad-action-btn-elegant.delete:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        /* ØªØ­Ø³ÙŠÙ† Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        #active-ads-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            padding: 20px 0;
        }
    </style>
</head>
<body>
    <script>
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø£Ù…Ø§Ù† - Ø³ÙŠØªÙ… ØªÙ†ÙÙŠØ°Ù‡ Ø¨Ø¹Ø¯ ØªØ­Ù…ÙŠÙ„ adminSecurity
        async function checkAuthOnLoad() {
            // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Supabase Ø£ÙˆÙ„Ø§Ù‹
            let attempts = 0;
            while (!window.supabaseClient && attempts < 100) {
                await new Promise(resolve => setTimeout(resolve, 100));
                attempts++;
            }
            
            if (!window.supabaseClient) {
                console.error('Supabase client not available');
                window.location.href = 'admin-login.html';
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„
            try {
                const { data: { user } } = await window.supabaseClient.auth.getUser();
                if (!user) {
                    console.log('No user logged in, redirecting to login');
                    window.location.href = 'admin-login.html';
                    return;
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø³Ø¬Ù„
                console.log('User in dashboard:', user);
                
                // Ø§Ù„Ø³Ù…Ø§Ø­ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ù…Ø¤Ù‚ØªØ§Ù‹)
                if (user.email) {
                    console.log('âœ… User authenticated successfully');
                } else {
                    console.log('User not authenticated');
                    window.location.href = 'admin-login.html';
                    return;
                }
                
                console.log('âœ… User authenticated successfully');
                
            } catch (error) {
                console.error('Auth check error:', error);
                window.location.href = 'admin-login.html';
                return;
            }
            
            // Ø¥Ø°Ø§ ÙˆØµÙ„Ù†Ø§ Ù‡Ù†Ø§ØŒ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ ÙˆÙ„Ø¯ÙŠÙ‡ ØµÙ„Ø§Ø­ÙŠØ§Øª
            // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ adminSecurity Ù„Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø®Ø±Ù‰
            while (!window.adminSecurity) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
        }
        checkAuthOnLoad();
    </script>

    <header class="header">
        <div class="header-content">
            <h1>ğŸ  Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h1>
            <div class="nav-buttons">
                <a href="../index.html" class="nav-btn">ğŸ  Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                <a href="admin-users.html" class="nav-btn">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</a>
                <button class="nav-btn" onclick="showAdvertisingPanel()">ğŸ“¢ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</button>
                <button class="nav-btn" onclick="handleLogout()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="welcome-section">
            <h1 class="welcome-title">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h1>
            <p class="welcome-subtitle">Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ù„Ø¬Ù…ÙŠØ¹ Ø¬ÙˆØ§Ù†Ø¨ Ø§Ù„Ù†Ø¸Ø§Ù…</p>
            <div class="user-info" id="userInfo">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
            </div>
        </div>

        <!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ‘¥</div>
                <div class="stat-number" id="totalUsers">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ“¦</div>
                <div class="stat-number" id="totalProducts">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ–¼ï¸</div>
                <div class="stat-number" id="totalImages">0</div>
                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙˆØ±</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ“¸</div>
                <div class="stat-number" id="avgImagesPerProduct">0</div>
                <div class="stat-label">Ù…ØªÙˆØ³Ø· Ø§Ù„ØµÙˆØ±/Ù…Ù†ØªØ¬</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-number" id="activeUsers">0</div>
                <div class="stat-label">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ””</div>
                <div class="stat-number" id="recentLogs">0</div>
                <div class="stat-label">Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ø®ÙŠØ±Ø©</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ“</div>
                <div class="stat-number" id="pendingRequests">0</div>
                <div class="stat-label">Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
            </div>
        </div>

        <!-- Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø© -->
        <div class="quick-actions">
            <h2 class="section-title">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h2>
            <div class="actions-grid">
                <a href="../index.html" class="action-card">
                    <div class="action-icon">ğŸ </div>
                    <div class="action-title">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
                    <div class="action-description">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ù…ÙˆÙ‚Ø¹</div>
                </a>
                <a href="admin-users.html" class="action-card">
                    <div class="action-icon">ğŸ‘¥</div>
                    <div class="action-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
                    <div class="action-description">Ø¥Ø¶Ø§ÙØ© ÙˆØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>
                </a>
                <a href="add-product.html" class="action-card">
                    <div class="action-icon">â•</div>
                    <div class="action-title">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</div>
                    <div class="action-description">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù†Ø¸Ø§Ù…</div>
                </a>
                <a href="admin-products.html" class="action-card">
                    <div class="action-icon">ğŸ“‹</div>
                    <div class="action-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                    <div class="action-description">Ø¹Ø±Ø¶ ÙˆØªØ¹Ø¯ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                </a>
                <a href="#" class="action-card" onclick="showProductRequests()">
                    <div class="action-icon">ğŸ“</div>
                    <div class="action-title">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                    <div class="action-description">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ø§Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>
                </a>
                <a href="#" class="action-card" onclick="showReports()">
                    <div class="action-icon">ğŸ“Š</div>
                    <div class="action-title">Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</div>
                    <div class="action-description">Ø¹Ø±Ø¶ ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</div>
                </a>
                <a href="#" class="action-card" onclick="showAdvertisingPanel()">
                    <div class="action-icon">ğŸ“¢</div>
                    <div class="action-title">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</div>
                    <div class="action-description">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø© ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</div>
                </a>
            </div>
        </div>

        <!-- Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø£Ø®ÙŠØ± -->
        <div class="recent-activity">
            <h2 class="section-title">Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø£Ø®ÙŠØ±</h2>
            <ul class="activity-list" id="activityList">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
            </ul>
        </div>

        <!-- Ù‚Ø³Ù… Ø¥Ø¯Ø§Ø±Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
        <div id="product-requests-section" class="recent-activity" style="display: none;">
            <h2 class="section-title">Ø¥Ø¯Ø§Ø±Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
            
            <!-- ÙÙ„ØªØ± Ø§Ù„Ø­Ø§Ù„Ø© -->
            <div class="mb-6 flex justify-center gap-4">
                <button class="filter-btn active" data-status="all">Ø§Ù„ÙƒÙ„</button>
                <button class="filter-btn" data-status="pending">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</button>
                <button class="filter-btn" data-status="approved">ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</button>
                <button class="filter-btn" data-status="rejected">Ù…Ø±ÙÙˆØ¶Ø©</button>
            </div>
            
            <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª -->
            <div id="requests-list" class="space-y-4">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
            </div>
            
            <!-- Ø±Ø³Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø·Ù„Ø¨Ø§Øª -->
            <div id="no-requests-message" class="text-center py-8 text-gray-500" style="display: none;">
                Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØ¦Ø©
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± -->
        <div id="reports-section" class="recent-activity" style="display: none;">
            <h2 class="section-title">ğŸ“Š ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
            
            <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ‚Ø±ÙŠØ± -->
            <div class="mb-6 flex justify-center gap-4 flex-wrap">
                <button class="filter-btn active" data-report="products">ğŸ“¦ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
                <button class="filter-btn" data-report="users">ğŸ‘¥ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>
                <button class="filter-btn" data-report="images">ğŸ–¼ï¸ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØµÙˆØ±</button>
                <button class="filter-btn" data-report="performance">âš¡ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡</button>
            </div>
            
            <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± -->
            <div id="reports-content" class="space-y-6">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
            </div>
        </div>

        <!-- Ù‚Ø³Ù… Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª -->
        <div id="advertising-panel" class="recent-activity" style="display: none;">
            <h2 class="section-title">ğŸ“¢ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙˆØ§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ù…ÙŠØ²Ø©</h2>
            
            <!-- ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª -->
            <div class="advertising-tabs">
                <button class="filter-btn active" onclick="switchAdvertisingTab('active-ads')">Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©</button>
                <button class="filter-btn" onclick="switchAdvertisingTab('ad-requests')">Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</button>
                <button class="filter-btn" onclick="showAddAdForm()">â• Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯</button>
                <button class="filter-btn" onclick="showSystemStatistics()">ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©</button>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© -->
            <div id="active-ads-tab" class="tab-content active">
                <div class="ads-stats">
                    <div class="stat-item">
                        <span class="stat-label">Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù†Ø´Ø·Ø©:</span>
                        <span class="stat-value" id="active-ads-count">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø±Ø§Øª:</span>
                        <span class="stat-value" id="total-clicks">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¸Ù‡ÙˆØ±Ø§Øª:</span>
                        <span class="stat-value" id="total-impressions">0</span>
                    </div>
                </div>
                
                <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© -->
                <div id="active-ads-cards" class="ads-cards-container">
                    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                </div>
                
                <!-- Ø±Ø³Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª -->
                <div id="no-ads-message" class="no-ads-message" style="display: none;">
                    <div class="no-ads-icon">ğŸ“¢</div>
                    <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù†Ø´Ø·Ø©</h3>
                    <p>Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯ Ù„Ø¬Ø°Ø¨ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</p>
                    <button class="btn-primary" onclick="showAddAdForm()">
                        <span>â•</span>
                        Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯
                    </button>
                </div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª -->
            <div id="ad-requests-tab" class="tab-content" style="display: none;">
                <div class="requests-filters">
                    <select id="request-status-filter" onchange="filterAdRequests()">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                        <option value="pending">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                        <option value="approved">Ù…Ù‚Ø¨ÙˆÙ„</option>
                        <option value="rejected">Ù…Ø±ÙÙˆØ¶</option>
                        <option value="cancelled">Ù…Ù„ØºÙŠ</option>
                    </select>
                </div>
                
                <div class="requests-table-container">
                    <table class="ads-table">
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                                <th>Ø§Ù„Ø¨Ø§Ø¦Ø¹</th>
                                <th>Ø§Ù„Ù†ÙˆØ¹</th>
                                <th>Ø§Ù„Ù…ÙˆØ¶Ø¹</th>
                                <th>Ø§Ù„Ù…Ø¯Ø© (Ø£ÙŠØ§Ù…)</th>
                                <th>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</th>
                                <th>Ø§Ù„Ø±Ø³Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="ad-requests-table">
                            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø© -->
            <div id="system-stats-tab" class="tab-content" style="display: none;">
                <div class="stats-overview">
                    <h3 class="stats-title">ğŸ“Š Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                    
                    <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
                    <div class="main-stats-grid">
                        <div class="stat-card primary">
                            <div class="stat-icon">ğŸ“¢</div>
                            <div class="stat-content">
                                <div class="stat-value" id="total-ads-stat">0</div>
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</div>
                            </div>
                        </div>
                        
                        <div class="stat-card success">
                            <div class="stat-icon">âœ…</div>
                            <div class="stat-content">
                                <div class="stat-value" id="active-ads-stat">0</div>
                                <div class="stat-label">Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©</div>
                            </div>
                        </div>
                        
                        <div class="stat-card info">
                            <div class="stat-icon">ğŸ‘ï¸</div>
                            <div class="stat-content">
                                <div class="stat-value" id="total-impressions-stat">0</div>
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¸Ù‡ÙˆØ±Ø§Øª</div>
                            </div>
                        </div>
                        
                        <div class="stat-card warning">
                            <div class="stat-icon">ğŸ–±ï¸</div>
                            <div class="stat-content">
                                <div class="stat-value" id="total-clicks-stat">0</div>
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø±Ø§Øª</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡ -->
                    <div class="performance-stats">
                        <h4>Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡</h4>
                        <div class="performance-grid">
                            <div class="performance-item">
                                <span class="performance-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‚Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                                <span class="performance-value" id="overall-ctr-stat">0%</span>
                            </div>
                            <div class="performance-item">
                                <span class="performance-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ø¸Ù‡ÙˆØ±Ø§Øª Ù„ÙƒÙ„ Ø¥Ø¹Ù„Ø§Ù†:</span>
                                <span class="performance-value" id="avg-impressions-stat">0</span>
                            </div>
                            <div class="performance-item">
                                <span class="performance-label">Ù…ØªÙˆØ³Ø· Ø§Ù„Ù†Ù‚Ø±Ø§Øª Ù„ÙƒÙ„ Ø¥Ø¹Ù„Ø§Ù†:</span>
                                <span class="performance-value" id="avg-clicks-stat">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ© -->
                    <div class="detailed-stats">
                        <h4>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©</h4>
                        
                        <!-- Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹ -->
                        <div class="stats-section">
                            <h5>Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</h5>
                            <div id="type-stats" class="stats-table-container">
                                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Ø­Ø³Ø¨ Ø§Ù„Ù…ÙˆØ¶Ø¹ -->
                        <div class="stats-section">
                            <h5>Ø­Ø³Ø¨ Ù…ÙˆØ¶Ø¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</h5>
                            <div id="position-stats" class="stats-table-container">
                                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ -->
                        <div class="stats-section">
                            <h5>Ø­Ø³Ø¨ ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ù†ØªØ¬</h5>
                            <div id="category-stats" class="stats-table-container">
                                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø²Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
                    <div class="stats-actions">
                        <button class="btn-primary" onclick="refreshSystemStatistics()">
                            <span>ğŸ”„</span>
                            ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                        </button>
                        <button class="btn-secondary" onclick="exportStatistics()">
                            <span>ğŸ“¥</span>
                            ØªØµØ¯ÙŠØ± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                        </button>
                    </div>
                </div>
            </div>
                <div class="requests-filters">
                    <select id="request-status-filter" onchange="filterAdRequests()">
                        <option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option>
                        <option value="pending">ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</option>
                        <option value="approved">Ù…Ù‚Ø¨ÙˆÙ„</option>
                        <option value="rejected">Ù…Ø±ÙÙˆØ¶</option>
                        <option value="cancelled">Ù…Ù„ØºÙŠ</option>
                    </select>
                </div>
                
                <div class="requests-table-container">
                    <table class="ads-table">
                        <thead>
                            <tr>
                                <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
                                <th>Ø§Ù„Ø¨Ø§Ø¦Ø¹</th>
                                <th>Ø§Ù„Ù†ÙˆØ¹</th>
                                <th>Ø§Ù„Ù…ÙˆØ¶Ø¹</th>
                                <th>Ø§Ù„Ù…Ø¯Ø© (Ø£ÙŠØ§Ù…)</th>
                                <th>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</th>
                                <th>Ø§Ù„Ø±Ø³Ø§Ù„Ø©</th>
                                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                                <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            </tr>
                        </thead>
                        <tbody id="ad-requests-table">
                            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨ -->
        <div id="request-details-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨</h3>
                    <button class="modal-close" onclick="closeRequestDetails(); return false;">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="request-details-content">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-modal-secondary" onclick="closeRequestDetails(); return false;">Ø¥ØºÙ„Ø§Ù‚</button>
                </div>
            </div>
        </div>

        <!-- Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯ -->
        <div id="add-ad-form" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯</h3>
                    <button class="modal-close" onclick="hideAddAdForm(); return false;">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="new-ad-form">
                        <div class="form-group">
                            <label for="ad-category">Ø§Ù„ØªØµÙ†ÙŠÙ:</label>
                            <select id="ad-category" required onchange="loadProductsForCategory()">
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ</option>
                                <option value="cake">ØªÙˆØ±ØªØ§Øª</option>
                                <option value="koshat">ÙƒÙˆØ´Ø§Øª</option>
                                <option value="mirr">Ù…Ø±Ø§ÙŠØ§</option>
                                <option value="other">Ø¯ÙŠÙƒÙˆØ±Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø©</option>
                                <option value="invitations">Ø¯Ø¹ÙˆØ§Øª ÙˆØªÙˆØ²ÙŠØ¹Ø§Øª</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ad-product">Ø§Ù„Ù…Ù†ØªØ¬:</label>
                            <select id="ad-product" required disabled>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ Ø£ÙˆÙ„Ø§Ù‹</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ad-type">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:</label>
                            <select id="ad-type" required onchange="updateAdPositions()">
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹</option>
                                <option value="featured">Ù…Ù…ÙŠØ²</option>
                                <option value="recommended">Ù…ÙˆØµÙ‰ Ø¨Ù‡</option>
                                <option value="banner">Ø¨Ø§Ù†Ø±</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ad-position">Ø§Ù„Ù…ÙˆØ¶Ø¹:</label>
                            <select id="ad-position" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¶Ø¹</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ad-start-date">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:</label>
                                <input type="datetime-local" id="ad-start-date" required>
                            </div>
                            <div class="form-group">
                                <label for="ad-end-date">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:</label>
                                <input type="datetime-local" id="ad-end-date">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ad-priority">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:</label>
                                <input type="number" id="ad-priority" min="1" max="10" value="1">
                            </div>
                            <div class="form-group">
                                <label for="ad-budget">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©:</label>
                                <input type="number" id="ad-budget" min="0" step="0.01" placeholder="0.00">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-modal-secondary" onclick="hideAddAdForm(); return false;">
                        <span>âŒ</span>
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button class="btn-modal-primary" onclick="createNewAdvertisement(); return false;">
                        <span>âœ¨</span>
                        Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                    </button>
                </div>
            </div>
        </div>

        <!-- Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† -->
        <div id="edit-ad-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</h3>
                    <button class="modal-close" onclick="hideEditAdModal(); return false;">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="edit-ad-form">
                        <input type="hidden" id="edit-ad-id">
                        <div class="form-group">
                            <label for="edit-ad-category">Ø§Ù„ØªØµÙ†ÙŠÙ:</label>
                            <select id="edit-ad-category" required onchange="loadProductsForEditCategory()">
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ</option>
                                <option value="cake">ØªÙˆØ±ØªØ§Øª</option>
                                <option value="koshat">ÙƒÙˆØ´Ø§Øª</option>
                                <option value="mirr">Ù…Ø±Ø§ÙŠØ§</option>
                                <option value="other">Ø¯ÙŠÙƒÙˆØ±Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø©</option>
                                <option value="invitations">Ø¯Ø¹ÙˆØ§Øª ÙˆØªÙˆØ²ÙŠØ¹Ø§Øª</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-ad-product">Ø§Ù„Ù…Ù†ØªØ¬:</label>
                            <select id="edit-ad-product" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ Ø£ÙˆÙ„Ø§Ù‹</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-ad-type">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:</label>
                            <select id="edit-ad-type" required onchange="updateEditAdPositions()">
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹</option>
                                <option value="featured">Ù…Ù…ÙŠØ²</option>
                                <option value="recommended">Ù…ÙˆØµÙ‰ Ø¨Ù‡</option>
                                <option value="banner">Ø¨Ø§Ù†Ø±</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="edit-ad-position">Ø§Ù„Ù…ÙˆØ¶Ø¹:</label>
                            <select id="edit-ad-position" required>
                                <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¶Ø¹</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-ad-start-date">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:</label>
                                <input type="datetime-local" id="edit-ad-start-date" required>
                            </div>
                            <div class="form-group">
                                <label for="edit-ad-end-date">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:</label>
                                <input type="datetime-local" id="edit-ad-end-date">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="edit-ad-priority">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©:</label>
                                <input type="number" id="edit-ad-priority" min="1" max="10" value="1">
                            </div>
                            <div class="form-group">
                                <label for="edit-ad-budget">Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©:</label>
                                <input type="number" id="edit-ad-budget" min="0" step="0.01" placeholder="0.00">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="edit-ad-status">Ø§Ù„Ø­Ø§Ù„Ø©:</label>
                            <select id="edit-ad-status" required>
                                <option value="active">Ù†Ø´Ø·</option>
                                <option value="paused">Ù…ØªÙˆÙ‚Ù Ù…Ø¤Ù‚ØªØ§Ù‹</option>
                                <option value="expired">Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button class="btn-modal-secondary" onclick="hideEditAdModal(); return false;">
                        <span>âŒ</span>
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button class="btn-modal-danger" onclick="deleteAdvertisement(); return false;">
                        <span>ğŸ—‘ï¸</span>
                        Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
                    </button>
                    <button class="btn-modal-primary" onclick="updateAdvertisement(); return false;">
                        <span>ğŸ’¾</span>
                        Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª
                    </button>
                </div>
            </div>
        </div>

        <!-- Ù†Ù…ÙˆØ°Ø¬ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨ Ø¥Ø¹Ù„Ø§Ù† -->
        <div id="review-request-modal" class="modal-overlay" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</h3>
                    <button class="modal-close" onclick="hideReviewRequestModal(); return false;">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="request-details">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ø¨ÙˆØ§Ø³Ø·Ø© JavaScript -->
                    </div>
                    <div class="form-group">
                        <label for="admin-notes">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø¯ÙŠØ±:</label>
                        <textarea id="admin-notes" rows="3" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ù‡Ù†Ø§..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-modal-secondary" onclick="hideReviewRequestModal(); return false;">Ø¥Ù„ØºØ§Ø¡</button>
                    <button class="btn-modal-success" onclick="approveAdRequest(); return false;">Ù‚Ø¨ÙˆÙ„</button>
                    <button class="btn-modal-danger" onclick="rejectAdRequest(); return false;">Ø±ÙØ¶</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ­Ù…ÙŠÙ„ adminSecurity
        let adminSecurityCheckStarted = false;
        
        function checkAdminSecurity() {
            if (adminSecurityCheckStarted) {
                return; // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ±Ø§Ø±
            }
            
            if (!window.adminSecurity) {
                console.log('â³ Waiting for adminSecurity to load...');
                adminSecurityCheckStarted = true;
                setTimeout(checkAdminSecurity, 100);
                return;
            }
            console.log('âœ… adminSecurity loaded successfully');
        }
        
        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ù‚Ù‚ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© - Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
        setTimeout(checkAdminSecurity, 100);
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.onload = async function() {
            // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ adminSecurity
            while (!window.adminSecurity) {
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            await loadDashboardData();
            await loadUserInfo();
            await loadRecentActivity();
            
            // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
            restorePageState();
        };
        
        // Ù†Ø¸Ø§Ù… Ø¨Ø¯ÙŠÙ„ Ù„Ø¶Ù…Ø§Ù† Ø¹Ù…Ù„ Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded - Ø¥Ø¹Ø¯Ø§Ø¯ Ù†Ø¸Ø§Ù… Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©');
            
            // ØªØ£Ø®ÙŠØ± Ù‚ØµÙŠØ± Ù„Ø¶Ù…Ø§Ù† ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±
            setTimeout(() => {
                restorePageState();
            }, 500);
        });
        
        // Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('beforeunload', function() {
            console.log('Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ù‚Ø¨Ù„ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©');
            // Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù‚Ø¨Ù„ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØµÙØ­Ø©
            const currentPanel = getCurrentActivePanel();
            if (currentPanel) {
                saveCurrentPageState(currentPanel);
            }
        });
        
        // Ù…Ø±Ø§Ù‚Ø¨Ø© ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„ØµÙØ­Ø© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ø¯ÙŠØ«
        window.addEventListener('load', function() {
            console.log('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© - Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø§Ù„Ø©');
            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø§Ù„Ø©
            setTimeout(() => {
                restorePageState();
            }, 1000);
        });
        
        // Ø¥Ø¶Ø§ÙØ© Ø£Ø²Ø±Ø§Ø± Ø§Ø®ØªØ¨Ø§Ø± ÙÙŠ Console
        window.testPageState = {
            save: function(page) {
                saveCurrentPageState(page);
                console.log(`ØªÙ… Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙØ­Ø©: ${page}`);
            },
            restore: function() {
                restorePageState();
            },
            clear: function() {
                localStorage.removeItem('adminCurrentPage');
                localStorage.removeItem('adminPageTimestamp');
                console.log('ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©');
            },
            show: function() {
                const savedPage = localStorage.getItem('adminCurrentPage');
                const timestamp = localStorage.getItem('adminPageTimestamp');
                console.log('Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:', { savedPage, timestamp });
            }
        };
        
        console.log('ğŸš€ Ù†Ø¸Ø§Ù… Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ØµÙØ­Ø© Ø¬Ø§Ù‡Ø²!');
        console.log('Ø§Ø³ØªØ®Ø¯Ù… window.testPageState.save("advertising") Ù„Ø­ÙØ¸ Ø­Ø§Ù„Ø©');
        console.log('Ø§Ø³ØªØ®Ø¯Ù… window.testPageState.restore() Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø§Ù„Ø©');
        console.log('Ø§Ø³ØªØ®Ø¯Ù… window.testPageState.show() Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©');

        // Ø­Ø³Ø§Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµÙˆØ± Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
        async function calculateImageStatistics() {
            try {
                let totalImages = 0;
                let productsWithImages = 0;
                let productsWithoutImages = 0;
                const tables = ['products_cake', 'products_koshat', 'products_mirr', 'products_other'];
                
                for (const table of tables) {
                    try {
                        const { data: products, error: productsError } = await window.supabaseClient
                            .from(table)
                            .select('image_urls');
                        
                        if (!productsError && products) {
                            products.forEach(product => {
                                if (product.image_urls && Array.isArray(product.image_urls) && product.image_urls.length > 0) {
                                    totalImages += product.image_urls.length;
                                    productsWithImages++;
                                } else {
                                    productsWithoutImages++;
                                }
                            });
                        } else if (productsError) {
                            console.error(`Error loading images from ${table}:`, productsError);
                        }
                    } catch (tableError) {
                        console.error(`Error accessing table ${table}:`, tableError);
                    }
                }
                
                return {
                    totalImages,
                    productsWithImages,
                    productsWithoutImages,
                    averageImagesPerProduct: productsWithImages > 0 ? (totalImages / productsWithImages).toFixed(1) : 0
                };
            } catch (error) {
                console.error('Error calculating image statistics:', error);
                return {
                    totalImages: 0,
                    productsWithImages: 0,
                    productsWithoutImages: 0,
                    averageImagesPerProduct: 0
                };
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        async function loadDashboardData() {
            try {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¹Ù…ÙŠÙ„ Supabase
                if (!window.supabaseClient) {
                    console.error('Supabase client not initialized');
                    return;
                }

                // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
                const { data: users, error: usersError } = await window.supabaseClient
                    .from('users')
                    .select('*');

                if (!usersError && users) {
                    document.getElementById('totalUsers').textContent = users.length;
                    document.getElementById('activeUsers').textContent = users.filter(u => u.status === 'Ù†Ø´Ø·').length;
                } else if (usersError) {
                    console.error('Error loading users:', usersError);
                }

                // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„
                let totalProducts = 0;
                const tables = ['products_cake', 'products_koshat', 'products_mirr', 'products_other'];
                
                for (const table of tables) {
                    try {
                        const { data: products, error: productsError } = await window.supabaseClient
                            .from(table)
                            .select('*');
                        
                        if (!productsError && products) {
                            totalProducts += products.length;
                        } else if (productsError) {
                            console.error(`Error loading ${table}:`, productsError);
                        }
                    } catch (tableError) {
                        console.error(`Error accessing table ${table}:`, tableError);
                    }
                }
                
                document.getElementById('totalProducts').textContent = totalProducts;
                
                // Ø­Ø³Ø§Ø¨ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµÙˆØ±
                const imageStats = await calculateImageStatistics();
                document.getElementById('totalImages').textContent = imageStats.totalImages;
                document.getElementById('avgImagesPerProduct').textContent = imageStats.averageImagesPerProduct;
                
                // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© ÙÙŠ console Ù„Ù„Ù…Ø·ÙˆØ±ÙŠÙ†
                console.log('ğŸ“Š Image Statistics:', {
                    totalImages: imageStats.totalImages,
                    productsWithImages: imageStats.productsWithImages,
                    productsWithoutImages: imageStats.productsWithoutImages,
                    averageImagesPerProduct: imageStats.averageImagesPerProduct
                });

                // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø³Ø¬Ù„Ø§Øª
                const { data: logs, error: logsError } = await window.supabaseClient
                    .from('admin_logs')
                    .select('*')
                    .gte('created_at', new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString());

                if (!logsError && logs) {
                    document.getElementById('recentLogs').textContent = logs.length;
                } else if (logsError) {
                    console.error('Error loading logs:', logsError);
                }

                // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                try {
                    if (window.ProductRequestsService) {
                        const service = new window.ProductRequestsService();
                        await service.ensureInitialized();
                        const statsResult = await service.getRequestStatistics();
                        
                        if (statsResult.success) {
                            document.getElementById('pendingRequests').textContent = statsResult.data.pending;
                        }
                    }
                } catch (error) {
                    console.error('Error loading request statistics:', error);
                    document.getElementById('pendingRequests').textContent = '0';
                }

            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        async function loadUserInfo() {
            try {
                // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ adminSecurity
                while (!window.adminSecurity) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                const currentUser = await adminSecurity.getCurrentUser();
                if (currentUser) {
                    const userInfoDiv = document.getElementById('userInfo');
                    userInfoDiv.innerHTML = `
                        <div class="user-name">${currentUser.fullName}</div>
                        <div class="user-role">${currentUser.role === 'admin' ? 'Ù…Ø¯ÙŠØ±' : 'Ù…Ø­Ø±Ø±'}</div>
                    `;
                } else {
                    console.log('No current user found');
                }
            } catch (error) {
                console.error('Error loading user info:', error);
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø£Ø®ÙŠØ±
        async function loadRecentActivity() {
            try {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¹Ù…ÙŠÙ„ Supabase
                if (!window.supabaseClient) {
                    console.error('Supabase client not initialized');
                    return;
                }

                const { data: logs, error } = await window.supabaseClient
                    .from('admin_logs')
                    .select('*')
                    .order('created_at', { ascending: false })
                    .limit(10);

                if (error) {
                    throw error;
                }

                const activityList = document.getElementById('activityList');
                activityList.innerHTML = '';

                if (logs && logs.length > 0) {
                    logs.forEach(log => {
                        const activityItem = createActivityItem(log);
                        activityList.appendChild(activityItem);
                    });
                } else {
                    activityList.innerHTML = '<li class="activity-item">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ù†Ø´Ø·Ø© Ø­Ø¯ÙŠØ«Ø©</li>';
                }

            } catch (error) {
                console.error('Error loading recent activity:', error);
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ù†Ø´Ø§Ø·
        function createActivityItem(log) {
            const li = document.createElement('li');
            li.className = 'activity-item';

            const icons = {
                'admin_login': 'ğŸ”',
                'failed_login': 'âŒ',
                'user_added': 'â•',
                'user_deleted': 'ğŸ—‘ï¸',
                'session_timeout': 'â°',
                'default': 'ğŸ“'
            };

            const icon = icons[log.action] || icons.default;
            const actionText = getActionText(log.action);

            li.innerHTML = `
                <div class="activity-icon">${icon}</div>
                <div class="activity-content">
                    <div class="activity-title">${actionText}</div>
                    <div class="activity-time">${new Date(log.created_at).toLocaleString('ar-EG')}</div>
                </div>
            `;

            return li;
        }

        // ØªØ±Ø¬Ù…Ø© Ù†ÙˆØ¹ Ø§Ù„Ù†Ø´Ø§Ø·
        function getActionText(action) {
            const actions = {
                'admin_login': 'ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù…Ø¯ÙŠØ±',
                'failed_login': 'Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙØ§Ø´Ù„Ø©',
                'user_added': 'Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯',
                'user_deleted': 'Ø­Ø°Ù Ù…Ø³ØªØ®Ø¯Ù…',
                'session_timeout': 'Ø§Ù†ØªÙ‡Ø§Ø¡ Ù…Ù‡Ù„Ø© Ø§Ù„Ø¬Ù„Ø³Ø©',
                'default': 'Ù†Ø´Ø§Ø· ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù…'
            };

            return actions[action] || actions.default;
        }

        // Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
        function showReports() {
            navigateToRoute('reports');
            
            // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø©
            if (!document.getElementById('back-to-dashboard')) {
                const backBtn = document.createElement('button');
                backBtn.id = 'back-to-dashboard';
                backBtn.className = 'nav-btn';
                backBtn.innerHTML = 'ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
                backBtn.onclick = backToDashboard;
                document.querySelector('.header-content').appendChild(backBtn);
            }
        }

        // Ø¹Ø±Ø¶ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        function showProductRequests() {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰
            document.querySelector('.welcome-section').style.display = 'none';
            document.querySelector('.stats-grid').style.display = 'none';
            document.querySelector('.quick-actions').style.display = 'none';
            document.querySelector('.recent-activity').style.display = 'none';
            document.getElementById('advertising-panel').style.display = 'none';
            document.getElementById('reports-section').style.display = 'none';
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ù‚Ø³Ù… Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            document.getElementById('product-requests-section').style.display = 'block';
            
            // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø©
            if (!document.getElementById('back-to-dashboard')) {
                const backBtn = document.createElement('button');
                backBtn.id = 'back-to-dashboard';
                backBtn.className = 'nav-btn';
                backBtn.innerHTML = 'ğŸ”™ Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©';
                backBtn.onclick = backToDashboard;
                document.querySelector('.header-content').appendChild(backBtn);
            }
            
            // ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            loadProductRequests();
        }

        // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        function backToDashboard() {
            // Ø¥Ø²Ø§Ù„Ø© Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø©
            const backBtn = document.getElementById('back-to-dashboard');
            if (backBtn) backBtn.remove();
            
            // Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            showDashboardHome();
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
        async function loadReports() {
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
            const reportButtons = document.querySelectorAll('[data-report]');
            reportButtons.forEach(button => {
                button.addEventListener('click', function() {
                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                    reportButtons.forEach(btn => btn.classList.remove('active'));
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù„Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
                    this.classList.add('active');
                    
                    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø­Ø¯Ø¯
                    const reportType = this.getAttribute('data-report');
                    loadSpecificReport(reportType);
                });
            });
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ (Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª)
            loadSpecificReport('products');
        }

        // ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ± Ù…Ø­Ø¯Ø¯
        async function loadSpecificReport(reportType) {
            const reportsContent = document.getElementById('reports-content');
            reportsContent.innerHTML = '<div class="text-center py-8">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±...</div>';
            
            try {
                switch (reportType) {
                    case 'products':
                        await loadProductsReport();
                        break;
                    case 'users':
                        await loadUsersReport();
                        break;
                    case 'images':
                        await loadImagesReport();
                        break;
                    case 'performance':
                        await loadPerformanceReport();
                        break;
                    default:
                        reportsContent.innerHTML = '<div class="text-center py-8 text-gray-500">Ù†ÙˆØ¹ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ</div>';
                }
            } catch (error) {
                console.error('Error loading report:', error);
                reportsContent.innerHTML = '<div class="text-center py-8 text-red-500">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ±</div>';
            }
        }

        // ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        async function loadProductsReport() {
            try {
                const reportsContent = document.getElementById('reports-content');
                let totalProducts = 0;
                let productsByCategory = {};
                let productsWithoutImages = 0;
                let recentProducts = [];
                const tables = ['products_cake', 'products_koshat', 'products_mirr', 'products_other'];
                
                for (const table of tables) {
                    try {
                        const { data: products, error } = await window.supabaseClient
                            .from(table)
                            .select('*')
                            .order('created_at', { ascending: false });
                        
                        if (!error && products) {
                            const categoryName = getCategoryDisplayName(table);
                            productsByCategory[categoryName] = products.length;
                            totalProducts += products.length;
                            
                            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¯ÙˆÙ† ØµÙˆØ±
                            products.forEach(product => {
                                if (!product.image_urls || !Array.isArray(product.image_urls) || product.image_urls.length === 0) {
                                    productsWithoutImages++;
                                }
                            });
                            
                            // Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø«Ø© Ù…Ø¤Ø®Ø±Ø§Ù‹
                            recentProducts.push(...products.slice(0, 3));
                        }
                    } catch (error) {
                        console.error(`Error loading ${table}:`, error);
                    }
                }
                
                // ØªØ±ØªÙŠØ¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØ§Ø±ÙŠØ®
                recentProducts.sort((a, b) => new Date(b.updated_at || b.created_at) - new Date(a.updated_at || a.created_at));
                recentProducts = recentProducts.slice(0, 5);
                
                const reportHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¹Ø§Ù…Ø©</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</span>
                                    <span class="font-bold text-blue-600">${totalProducts}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¯ÙˆÙ† ØµÙˆØ±:</span>
                                    <span class="font-bold text-orange-600">${productsWithoutImages}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¹ ØµÙˆØ±:</span>
                                    <span class="font-bold text-green-600">${totalProducts > 0 ? ((totalProducts - productsWithoutImages) / totalProducts * 100).toFixed(1) : 0}%</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ“‚ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</h3>
                            <div class="space-y-3">
                                ${Object.entries(productsByCategory).map(([category, count]) => `
                                    <div class="flex justify-between">
                                        <span>${category}:</span>
                                        <span class="font-bold text-purple-600">${count}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ•’ Ø¢Ø®Ø± Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª</h3>
                            <div class="space-y-2">
                                ${recentProducts.map(product => `
                                    <div class="text-sm p-2 bg-gray-50 rounded">
                                        <div class="font-medium">${product.name || product.description || 'Ù…Ù†ØªØ¬'}</div>
                                        <div class="text-gray-600">${new Date(product.updated_at || product.created_at).toLocaleDateString('ar-EG')}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
                
                reportsContent.innerHTML = reportHTML;
                
            } catch (error) {
                console.error('Error loading products report:', error);
                document.getElementById('reports-content').innerHTML = '<div class="text-center py-8 text-red-500">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</div>';
            }
        }

        // ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
        async function loadUsersReport() {
            try {
                const { data: users, error } = await window.supabaseClient
                    .from('users')
                    .select('*')
                    .order('created_at', { ascending: false });
                
                if (error) throw error;
                
                const totalUsers = users.length;
                const activeUsers = users.filter(u => u.status === 'Ù†Ø´Ø·').length;
                const newUsers = users.filter(u => {
                    const userDate = new Date(u.created_at);
                    const weekAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1000);
                    return userDate > weekAgo;
                }).length;
                
                const recentUsers = users.slice(0, 5);
                
                const reportHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ‘¥ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†:</span>
                                    <span class="font-bold text-blue-600">${totalUsers}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†:</span>
                                    <span class="font-bold text-green-600">${activeUsers}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ø¬Ø¯Ø¯ (Ø£Ø³Ø¨ÙˆØ¹):</span>
                                    <span class="font-bold text-purple-600">${newUsers}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ“ˆ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù…Ùˆ</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†:</span>
                                    <span class="font-bold text-green-600">${totalUsers > 0 ? (activeUsers / totalUsers * 100).toFixed(1) : 0}%</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ:</span>
                                    <span class="font-bold text-blue-600">${newUsers}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ†• Ø¢Ø®Ø± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                            <div class="space-y-2">
                                ${recentUsers.map(user => `
                                    <div class="text-sm p-2 bg-gray-50 rounded">
                                        <div class="font-medium">${user.full_name || user.email}</div>
                                        <div class="text-gray-600">${new Date(user.created_at).toLocaleDateString('ar-EG')}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('reports-content').innerHTML = reportHTML;
                
            } catch (error) {
                console.error('Error loading users report:', error);
                document.getElementById('reports-content').innerHTML = '<div class="text-center py-8 text-red-500">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</div>';
            }
        }

        // ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØµÙˆØ±
        async function loadImagesReport() {
            try {
                const imageStats = await calculateImageStatistics();
                const tables = ['products_cake', 'products_koshat', 'products_mirr', 'products_other'];
                let imagesByCategory = {};
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„ØµÙˆØ± Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ
                for (const table of tables) {
                    try {
                        const { data: products, error } = await window.supabaseClient
                            .from(table)
                            .select('image_urls');
                        
                        if (!error && products) {
                            const categoryName = getCategoryDisplayName(table);
                            let categoryImages = 0;
                            
                            products.forEach(product => {
                                if (product.image_urls && Array.isArray(product.image_urls)) {
                                    categoryImages += product.image_urls.length;
                                }
                            });
                            
                            imagesByCategory[categoryName] = categoryImages;
                        }
                    } catch (error) {
                        console.error(`Error loading images from ${table}:`, error);
                    }
                }
                
                const reportHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ–¼ï¸ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØµÙˆØ±</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØµÙˆØ±:</span>
                                    <span class="font-bold text-blue-600">${imageStats.totalImages}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¹ ØµÙˆØ±:</span>
                                    <span class="font-bold text-green-600">${imageStats.productsWithImages}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø¯ÙˆÙ† ØµÙˆØ±:</span>
                                    <span class="font-bold text-orange-600">${imageStats.productsWithoutImages}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ“¸ Ø§Ù„ØµÙˆØ± Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</h3>
                            <div class="space-y-3">
                                ${Object.entries(imagesByCategory).map(([category, count]) => `
                                    <div class="flex justify-between">
                                        <span>${category}:</span>
                                        <span class="font-bold text-purple-600">${count}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ“Š Ù…ØªÙˆØ³Ø· Ø§Ù„ØµÙˆØ±</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>Ù…ØªÙˆØ³Ø· Ø§Ù„ØµÙˆØ±/Ù…Ù†ØªØ¬:</span>
                                    <span class="font-bold text-green-600">${imageStats.averageImagesPerProduct}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ø¹ ØµÙˆØ±:</span>
                                    <span class="font-bold text-blue-600">${(imageStats.productsWithImages + imageStats.productsWithoutImages) > 0 ? (imageStats.productsWithImages / (imageStats.productsWithImages + imageStats.productsWithoutImages) * 100).toFixed(1) : 0}%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('reports-content').innerHTML = reportHTML;
                
            } catch (error) {
                console.error('Error loading images report:', error);
                document.getElementById('reports-content').innerHTML = '<div class="text-center py-8 text-red-500">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØµÙˆØ±</div>';
            }
        }

        // ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡
        async function loadPerformanceReport() {
            try {
                const pageLoadTime = performance.now();
                const memoryUsage = performance.memory ? {
                    used: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024),
                    total: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024),
                    limit: Math.round(performance.memory.jsHeapSizeLimit / 1024 / 1024)
                } : null;
                
                const reportHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">âš¡ Ø£Ø¯Ø§Ø¡ Ø§Ù„ØµÙØ­Ø©</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>ÙˆÙ‚Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„:</span>
                                    <span class="font-bold text-blue-600">${pageLoadTime.toFixed(2)}ms</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±:</span>
                                    <span class="font-bold text-green-600">${new Date().toLocaleDateString('ar-EG')}</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ’¾ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°Ø§ÙƒØ±Ø©</h3>
                            <div class="space-y-3">
                                ${memoryUsage ? `
                                    <div class="flex justify-between">
                                        <span>Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©:</span>
                                        <span class="font-bold text-blue-600">${memoryUsage.used} MB</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø©:</span>
                                        <span class="font-bold text-green-600">${memoryUsage.total} MB</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Ø­Ø¯ Ø§Ù„Ø°Ø§ÙƒØ±Ø©:</span>
                                        <span class="font-bold text-purple-600">${memoryUsage.limit} MB</span>
                                    </div>
                                ` : '<div class="text-gray-500">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø°Ø§ÙƒØ±Ø© ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©</div>'}
                            </div>
                        </div>
                        
                        <div class="bg-white p-6 rounded-lg shadow-md">
                            <h3 class="text-lg font-semibold mb-4 text-center">ğŸ”§ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span>Ø§Ù„Ù…ØªØµÙØ­:</span>
                                    <span class="font-bold text-blue-600">${navigator.userAgent.split(' ').pop()}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„:</span>
                                    <span class="font-bold text-green-600">${navigator.platform}</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Ø§Ù„Ù„ØºØ©:</span>
                                    <span class="font-bold text-purple-600">${navigator.language}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('reports-content').innerHTML = reportHTML;
                
            } catch (error) {
                console.error('Error loading performance report:', error);
                document.getElementById('reports-content').innerHTML = '<div class="text-center py-8 text-red-500">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£Ø¯Ø§Ø¡</div>';
            }
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ØªØµÙ†ÙŠÙ Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶
        function getCategoryDisplayName(tableName) {
            const categoryMap = {
                'products_cake': 'ØªÙˆØ±ØªØ§Øª',
                'products_koshat': 'ÙƒÙˆØ´Ø§Øª',
                'products_mirr': 'Ù…Ø±Ø§ÙŠØ§',
                'products_other': 'Ø¯ÙŠÙƒÙˆØ±Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø©'
            };
            return categoryMap[tableName] || tableName;
        }

        // ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        async function loadProductRequests(status = 'all') {
            try {
                // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ ProductRequestsService
                if (!window.ProductRequestsService) {
                    console.error('ProductRequestsService not available');
                    return;
                }

                const service = new window.ProductRequestsService();
                await service.ensureInitialized();

                let result;
                if (status === 'all') {
                    result = await service.getAllProductRequests();
                } else {
                    result = await service.getProductRequestsByStatus(status);
                }

                if (result.success) {
                    displayProductRequests(result.data, status);
                } else {
                    console.error('Error loading product requests:', result.error);
                }
            } catch (error) {
                console.error('Error in loadProductRequests:', error);
            }
        }

        // Ø¹Ø±Ø¶ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
        function displayProductRequests(requests, status) {
            const requestsList = document.getElementById('requests-list');
            const noRequestsMessage = document.getElementById('no-requests-message');

            if (!requests || requests.length === 0) {
                requestsList.style.display = 'none';
                noRequestsMessage.style.display = 'block';
                return;
            }

            requestsList.style.display = 'block';
            noRequestsMessage.style.display = 'none';

            // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„ÙŠÙ‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
            window.currentRequests = requests;

            requestsList.innerHTML = requests.map(request => createRequestCard(request)).join('');

            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« Ù„Ù„Ø£Ø²Ø±Ø§Ø±
            addRequestEventListeners();
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø·Ù„Ø¨
        function createRequestCard(request) {
            const statusClass = `status-${request.status}`;
            const statusText = getStatusText(request.status);
            const createdAt = new Date(request.created_at).toLocaleString('ar-EG');

            return `
                <div class="request-card" data-request-id="${request.id}">
                    <div class="request-header">
                        <h3 class="font-semibold text-lg">Ø·Ù„Ø¨ Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</h3>
                        <span class="request-status ${statusClass}">${statusText}</span>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <p><strong>Ø§Ù„ØªØµÙ†ÙŠÙ:</strong> ${getCategoryName(request.category)}</p>
                            <p><strong>Ø§Ù„ÙˆØµÙ:</strong> ${request.description}</p>
                            <p><strong>Ø§Ù„Ø³Ø¹Ø±:</strong> ${request.price > 0 ? request.price + ' Ø¬.Ù…' : 'Ø§Ù„Ø³Ø¹Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø·Ù„Ø¨'}</p>
                            <p><strong>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª:</strong> ${request.governorate || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                            <p><strong>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨:</strong> ${createdAt}</p>
                        </div>
                        
                        <div>
                            <p><strong>Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨:</strong> ${request.whatsapp}</p>
                            <p><strong>ÙÙŠØ³Ø¨ÙˆÙƒ:</strong> ${request.facebook || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                            <p><strong>Ø¥Ù†Ø³ØªØ¬Ø±Ø§Ù…:</strong> ${request.instagram || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</p>
                        </div>
                    </div>
                    
                    ${request.image_urls && request.image_urls.length > 0 ? `
                        <div class="request-images">
                            ${request.image_urls.map(img => `
                                <img src="${img.url || img}" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬" class="request-image">
                            `).join('')}
                        </div>
                    ` : ''}
                    
                    <div class="request-actions">
                        <button class="btn-view" onclick="viewRequestDetails('${request.id}')">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
                        ${request.status === 'pending' ? `
                            <button class="btn-approve" onclick="approveRequest('${request.id}')">Ù…ÙˆØ§ÙÙ‚Ø©</button>
                            <button class="btn-reject" onclick="rejectRequest('${request.id}')">Ø±ÙØ¶</button>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        function addRequestEventListeners() {
            // Ù…Ø³ØªÙ…Ø¹ÙŠ Ø£Ø­Ø¯Ø§Ø« Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙÙ„ØªØ±
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù„Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
                    this.classList.add('active');
                    
                    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ù„Ø©
                    const status = this.getAttribute('data-status');
                    loadProductRequests(status);
                });
            });
        }

        // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
        function viewRequestDetails(requestId) {
            try {
                console.log('Viewing details for request:', requestId);
                
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø·Ù„Ø¨ ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©
                const requestCard = document.querySelector(`[data-request-id="${requestId}"]`);
                if (!requestCard) {
                    console.warn('Request card not found in DOM');
                }

                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø©
                const requestData = getRequestDataById(requestId);
                if (!requestData) {
                    alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø© ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
                    return;
                }

                console.log('Request data retrieved:', requestData);

                // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©
                showRequestDetailsModal(requestData);
            } catch (error) {
                console.error('Error in viewRequestDetails:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
            }
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ø¨ÙˆØ§Ø³Ø·Ø© ID
        function getRequestDataById(requestId) {
            // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ø­Ø§Ù„ÙŠØ§Ù‹
            const requestsList = document.getElementById('requests-list');
            const requestCard = requestsList.querySelector(`[data-request-id="${requestId}"]`);
            
            if (requestCard) {
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©
                return extractRequestDataFromCard(requestCard);
            }
            
            // Ø¥Ø°Ø§ Ù„Ù… Ù†Ø¬Ø¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©ØŒ Ù†Ø­Ø§ÙˆÙ„ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø®Ø²Ù†Ø©
            if (window.currentRequests && window.currentRequests.length > 0) {
                const storedRequest = window.currentRequests.find(req => req.id == requestId);
                if (storedRequest) {
                    return formatRequestData(storedRequest);
                }
            }
            
            return null;
        }

        // ØªÙ†Ø³ÙŠÙ‚ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨
        function formatRequestData(request) {
            try {
                const createdAt = new Date(request.created_at).toLocaleString('ar-EG');
                const statusText = getStatusText(request.status);
                const categoryName = getCategoryName(request.category);
                const priceText = request.price > 0 ? request.price + ' Ø¬.Ù…' : 'Ø§Ù„Ø³Ø¹Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø·Ù„Ø¨';
                
                return {
                    id: request.id,
                    description: request.description || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    category: categoryName,
                    price: priceText,
                    governorate: request.governorate || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    whatsapp: request.whatsapp || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    facebook: request.facebook || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    instagram: request.instagram || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    status: statusText,
                    created_at: createdAt,
                    image_urls: request.image_urls || []
                };
            } catch (error) {
                console.error('Error formatting request data:', error);
                return null;
            }
        }

        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø©
        function extractRequestDataFromCard(requestCard) {
            try {
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙ‚Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø©
                const paragraphs = requestCard.querySelectorAll('p');
                const requestData = {
                    id: requestCard.getAttribute('data-request-id'),
                    description: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    category: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    price: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    governorate: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    whatsapp: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    facebook: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    instagram: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    status: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    created_at: 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                    image_urls: []
                };

                // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„ÙÙ‚Ø±Ø§Øª Ø¹Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                paragraphs.forEach(p => {
                    const text = p.textContent || '';
                    const strong = p.querySelector('strong');
                    
                    if (strong) {
                        const label = strong.textContent.trim();
                        const value = p.textContent.replace(label, '').trim();
                        
                        if (label.includes('Ø§Ù„ÙˆØµÙ')) {
                            requestData.description = value;
                        } else if (label.includes('Ø§Ù„ØªØµÙ†ÙŠÙ')) {
                            requestData.category = value;
                        } else if (label.includes('Ø§Ù„Ø³Ø¹Ø±')) {
                            requestData.price = value;
                        } else if (label.includes('Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª')) {
                            requestData.governorate = value;
                        } else if (label.includes('Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨')) {
                            requestData.whatsapp = value;
                        } else if (label.includes('ÙÙŠØ³Ø¨ÙˆÙƒ')) {
                            requestData.facebook = value;
                        } else if (label.includes('Ø¥Ù†Ø³ØªØ¬Ø±Ø§Ù…')) {
                            requestData.instagram = value;
                        } else if (label.includes('ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨')) {
                            requestData.created_at = value;
                        }
                    }
                });

                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø­Ø§Ù„Ø©
                const statusElement = requestCard.querySelector('.request-status');
                if (statusElement) {
                    requestData.status = statusElement.textContent.trim();
                }

                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„ØµÙˆØ±
                const images = requestCard.querySelectorAll('.request-image');
                images.forEach(img => {
                    requestData.image_urls.push({
                        url: img.src,
                        original_name: img.alt
                    });
                });

                console.log('Extracted request data:', requestData);
                return requestData;
            } catch (error) {
                console.error('Error extracting request data:', error);
                return null;
            }
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
        function showRequestDetailsModal(requestData) {
            const modal = document.getElementById('request-details-modal');
            const content = document.getElementById('request-details-content');

            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªÙØ§ØµÙŠÙ„
            content.innerHTML = createRequestDetailsHTML(requestData);

            // Ø¹Ø±Ø¶ Ø§Ù„Ù†Ø§ÙØ°Ø©
            modal.style.display = 'flex';
            setTimeout(() => {
                modal.classList.add('show');
            }, 10);
        }

        // Ø¥Ù†Ø´Ø§Ø¡ HTML Ù„ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
        function createRequestDetailsHTML(requestData) {
            const statusClass = `status-${requestData.status === 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±' ? 'pending' : requestData.status === 'ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©' ? 'approved' : 'rejected'}`;
            
            return `
                <div class="request-detail-item">
                    <span class="request-detail-label">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</span>
                    <span class="request-detail-value">#${requestData.id}</span>
                </div>
                
                <div class="request-detail-item">
                    <span class="request-detail-label">Ø§Ù„Ø­Ø§Ù„Ø©:</span>
                    <span class="request-detail-value">
                        <span class="request-status ${statusClass}">${requestData.status}</span>
                    </span>
                </div>
                
                <div class="request-detail-item">
                    <span class="request-detail-label">Ø§Ù„ØªØµÙ†ÙŠÙ:</span>
                    <span class="request-detail-value">${requestData.category}</span>
                </div>
                
                <div class="request-detail-item">
                    <span class="request-detail-label">Ø§Ù„ÙˆØµÙ:</span>
                    <span class="request-detail-value">${requestData.description}</span>
                </div>
                
                <div class="request-detail-item">
                    <span class="request-detail-label">Ø§Ù„Ø³Ø¹Ø±:</span>
                    <span class="request-detail-value">${requestData.price}</span>
                </div>
                
                <div class="request-detail-item">
                    <span class="request-detail-label">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª:</span>
                    <span class="request-detail-value">${requestData.governorate}</span>
                </div>
                
                <div class="request-detail-item">
                    <span class="request-detail-label">Ø±Ù‚Ù… Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨:</span>
                    <span class="request-detail-value">${requestData.whatsapp}</span>
                </div>
                
                <div class="request-detail-item">
                    <span class="request-detail-label">Ø±Ø§Ø¨Ø· Ø§Ù„ÙÙŠØ³Ø¨ÙˆÙƒ:</span>
                    <span class="request-detail-value">${requestData.facebook}</span>
                </div>
                
                <div class="request-detail-item">
                    <span class="request-detail-label">Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ù†Ø³ØªØ¬Ø±Ø§Ù…:</span>
                    <span class="request-detail-value">${requestData.instagram}</span>
                </div>
                
                <div class="request-detail-item">
                    <span class="request-detail-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ù„Ø¨:</span>
                    <span class="request-detail-value">${requestData.created_at}</span>
                </div>
                
                ${requestData.image_urls && requestData.image_urls.length > 0 ? `
                    <div class="request-detail-item">
                        <span class="request-detail-label">Ø§Ù„ØµÙˆØ± Ø§Ù„Ù…Ø±ÙÙ‚Ø©:</span>
                        <div class="request-images-grid">
                            ${requestData.image_urls.map((img, index) => {
                                const imageUrl = typeof img === 'string' ? img : (img.url || img);
                                return `
                                    <div class="request-image-item">
                                        <img src="${imageUrl}" alt="ØµÙˆØ±Ø© ${index + 1}" loading="lazy" onerror="this.style.display='none'">
                                        <div class="request-image-overlay">
                                            <button onclick="openImageInNewTab('${imageUrl}')">Ø¹Ø±Ø¶</button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                ` : ''}
            `;
        }

        // ÙØªØ­ Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ ØªØ¨ÙˆÙŠØ¨ Ø¬Ø¯ÙŠØ¯
        function openImageInNewTab(imageUrl) {
            window.open(imageUrl, '_blank');
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ù†Ø§ÙØ°Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
        function closeRequestDetails() {
            const modal = document.getElementById('request-details-modal');
            modal.classList.remove('show');
            setTimeout(() => {
                modal.style.display = 'none';
            }, 300);
        }

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('request-details-modal');
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeRequestDetails();
                    }
                });
            }
        });

        // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const modal = document.getElementById('request-details-modal');
                if (modal && modal.style.display !== 'none') {
                    closeRequestDetails();
                }
                
                const editModal = document.getElementById('edit-ad-modal');
                if (editModal && editModal.style.display !== 'none') {
                    hideEditAdModal();
                }
            }
        });

        // Ø¥ØºÙ„Ø§Ù‚ Ù†ÙˆØ§ÙØ° Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
        document.addEventListener('DOMContentLoaded', function() {
            const editModal = document.getElementById('edit-ad-modal');
            if (editModal) {
                editModal.addEventListener('click', function(e) {
                    if (e.target === editModal) {
                        hideEditAdModal();
                    }
                });
            }
        });

        // Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù„Ø¨
        async function approveRequest(requestId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬ØŸ')) {
                return;
            }

            try {
                if (!window.ProductRequestsService) {
                    console.error('ProductRequestsService not available');
                    return;
                }

                const service = new window.ProductRequestsService();
                await service.ensureInitialized();

                const result = await service.approveProductRequest(requestId);
                if (result.success) {
                    alert('ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                    loadProductRequests();
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                    loadDashboardData();
                } else {
                    alert('Ø®Ø·Ø£ ÙÙŠ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬: ' + result.error);
                }
            } catch (error) {
                console.error('Error approving request:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬');
            }
        }

        // Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨
        async function rejectRequest(requestId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ØŸ')) {
                return;
            }
            
            try {
                if (!window.ProductRequestsService) {
                    console.error('ProductRequestsService not available');
                    return;
                }

                const service = new window.ProductRequestsService();
                await service.ensureInitialized();

                const result = await service.rejectProductRequest(requestId);
                if (result.success) {
                    alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ Ø¨Ù†Ø¬Ø§Ø­');
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª
                    loadProductRequests();
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                    loadDashboardData();
                } else {
                    alert('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬: ' + result.error);
                }
            } catch (error) {
                console.error('Error rejecting request:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬');
            }
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Øµ Ø§Ù„Ø­Ø§Ù„Ø©
        function getStatusText(status) {
            const statusMap = {
                'pending': 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
                'approved': 'ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©',
                'rejected': 'Ù…Ø±ÙÙˆØ¶'
            };
            return statusMap[status] || status;
        }

        // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ØªØµÙ†ÙŠÙ
        function getCategoryName(category) {
            const categoryMap = {
                'koshat': 'ÙƒÙˆØ´Ø§Øª',
                'mirr': 'Ù…Ø±Ø§ÙŠØ§',
                'cake': 'ØªÙˆØ±ØªØ©',
                'other': 'Ø¯ÙŠÙƒÙˆØ±Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø©'
            };
            return categoryMap[category] || category;
        }

        // Ù…Ø¹Ø§Ù„Ø¬Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        async function handleLogout() {
            try {
                // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ adminSecurity
                while (!window.adminSecurity) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
                console.log('ğŸ”„ Ø¨Ø¯Ø¡ Ø¹Ù…Ù„ÙŠØ© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬...');
                await adminSecurity.logout();
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬:', error);
                // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ù…Ø¨Ø§Ø´Ø± ÙÙŠ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£
                window.location.href = 'admin-login.html';
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        document.addEventListener('DOMContentLoaded', async function() {
            // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Supabase
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            console.log('Loading dashboard data...');
            await loadUserInfo();
            await loadDashboardData();
            await loadRecentActivity();
        });

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ 5 Ø¯Ù‚Ø§Ø¦Ù‚
        setInterval(async function() {
            console.log('Refreshing dashboard data...');
            await loadDashboardData();
            await loadRecentActivity();
        }, 5 * 60 * 1000);

        // ===== Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯ =====
        
        // ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
        const ADMIN_ROUTES = {
            'dashboard': {
                title: 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©',
                handler: showDashboardHome
            },
            'advertising': {
                title: 'Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª',
                handler: showAdvertisingPanel
            },
            'product-requests': {
                title: 'Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª',
                handler: showProductRequests
            },
            'reports': {
                title: 'Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±',
                handler: showReports
            }
        };
        
        // ØªØ­Ø¯ÙŠØ« URL Ø¨Ø¯ÙˆÙ† Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        function updateURL(route) {
            try {
                const newURL = `/admin/${route === 'dashboard' ? '' : route}`;
                window.history.pushState({ route }, ADMIN_ROUTES[route]?.title || 'Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…', newURL);
                console.log(`ØªÙ… ØªØ­Ø¯ÙŠØ« URL Ø¥Ù„Ù‰: ${newURL}`);
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« URL:', error);
            }
        }
        
        // Ø­ÙØ¸ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙŠ localStorage
        function saveCurrentRoute(route) {
            try {
                localStorage.setItem('adminCurrentRoute', route);
                localStorage.setItem('adminRouteTimestamp', Date.now().toString());
                console.log(`ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø³Ø§Ø±: ${route}`);
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ù…Ø³Ø§Ø±:', error);
            }
        }
        
        // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ø­ÙÙˆØ¸
        function restoreRoute() {
            try {
                // Ø£ÙˆÙ„Ø§Ù‹: Ù…Ø­Ø§ÙˆÙ„Ø© Ù‚Ø±Ø§Ø¡Ø© Ù…Ù† URL
                const path = window.location.pathname;
                let route = 'dashboard';
                
                if (path.includes('/admin/')) {
                    const routePart = path.split('/admin/')[1];
                    if (routePart && ADMIN_ROUTES[routePart]) {
                        route = routePart;
                    }
                }
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† URL Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø± Ù…Ø­Ø¯Ø¯ØŒ Ø§Ø³ØªØ®Ø¯Ù… localStorage
                if (route === 'dashboard') {
                    const savedRoute = localStorage.getItem('adminCurrentRoute');
                    const timestamp = localStorage.getItem('adminRouteTimestamp');
                    
                    if (savedRoute && timestamp) {
                        const timeDiff = Date.now() - parseInt(timestamp);
                        if (timeDiff < 3600000 && ADMIN_ROUTES[savedRoute]) { // Ø£Ù‚Ù„ Ù…Ù† Ø³Ø§Ø¹Ø©
                            route = savedRoute;
                            console.log(`Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ø­ÙÙˆØ¸: ${route}`);
                        }
                    }
                }
                
                console.log(`Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${route}`);
                
                // Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
                if (ADMIN_ROUTES[route] && ADMIN_ROUTES[route].handler) {
                    ADMIN_ROUTES[route].handler();
                    updateURL(route);
                } else {
                    console.log('Ø§Ù„Ù…Ø³Ø§Ø± ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙØŒ Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
                    showDashboardHome();
                    updateURL('dashboard');
                }
                
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø³Ø§Ø±:', error);
                showDashboardHome();
                updateURL('dashboard');
            }
        }
        
        // Ù…Ø¹Ø§Ù„Ø¬ ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø³Ø§Ø±
        function navigateToRoute(route) {
            if (!ADMIN_ROUTES[route]) {
                console.error(`Ø§Ù„Ù…Ø³Ø§Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: ${route}`);
                return;
            }
            
            console.log(`Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰: ${route}`);
            
            // Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø©
            ADMIN_ROUTES[route].handler();
            
            // ØªØ­Ø¯ÙŠØ« URL
            updateURL(route);
            
            // Ø­ÙØ¸ Ø§Ù„Ù…Ø³Ø§Ø±
            saveCurrentRoute(route);
        }
        
        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
        function showDashboardHome() {
            // Ø¥Ø¸Ù‡Ø§Ø± Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£ØµÙ„ÙŠØ©
            document.querySelector('.welcome-section').style.display = 'block';
            document.querySelector('.stats-grid').style.display = 'grid';
            document.querySelector('.quick-actions').style.display = 'block';
            document.querySelector('.recent-activity').style.display = 'block';
            
            // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰
            document.getElementById('advertising-panel').style.display = 'none';
            document.getElementById('product-requests-section').style.display = 'none';
            document.getElementById('reports-section').style.display = 'none';
            
            console.log('ØªÙ… Ø¹Ø±Ø¶ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©');
        }
        
        // ===== ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª =====

        // Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        function showAdvertisingPanel() {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰
            document.querySelector('.welcome-section').style.display = 'none';
            document.querySelector('.stats-grid').style.display = 'none';
            document.querySelector('.quick-actions').style.display = 'none';
            document.querySelector('.recent-activity').style.display = 'none';
            document.getElementById('product-requests-section').style.display = 'none';
            document.getElementById('reports-section').style.display = 'none';
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
            document.getElementById('advertising-panel').style.display = 'block';
            
            // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
            loadAdvertisingData();
        }

        // Ø¥Ø®ÙØ§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        function hideAdvertisingPanel() {
            showDashboardHome();
        }

        // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function switchAdvertisingTab(tabName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            document.getElementById('active-ads-tab').style.display = 'none';
            document.getElementById('ad-requests-tab').style.display = 'none';
            document.getElementById('system-stats-tab').style.display = 'none';
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙØ¦Ø© Ø§Ù„Ù†Ø´Ø·Ø© Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.advertising-tabs .filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            if (tabName === 'active-ads') {
                document.getElementById('active-ads-tab').style.display = 'block';
                document.querySelector('.advertising-tabs .filter-btn:first-child').classList.add('active');
                loadActiveAdvertisements();
            } else if (tabName === 'ad-requests') {
                document.getElementById('ad-requests-tab').style.display = 'block';
                document.querySelector('.advertising-tabs .filter-btn:nth-child(2)').classList.add('active');
                loadAdRequests();
            } else if (tabName === 'system-stats') {
                document.getElementById('system-stats-tab').style.display = 'block';
                document.querySelector('.advertising-tabs .filter-btn:nth-child(4)').classList.add('active');
                loadSystemStatistics();
            }
        }
        
        // Ø¥Ø¸Ù‡Ø§Ø± ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©
        function showSystemStatistics() {
            switchAdvertisingTab('system-stats');
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        async function loadAdvertisingData() {
            try {
                await loadActiveAdvertisements();
                await loadAdRequests();
                await loadAdStatistics();
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª:', error);
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©
        async function loadActiveAdvertisements() {
            try {
                if (!window.advertisingService) {
                    console.error('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                console.log('ğŸ” Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ø¹ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...');
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…Ø¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                const advertisements = await window.advertisingService.getAllAdvertisementsWithProducts();
                
                console.log('âœ… ØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª:', advertisements);
                
                displayActiveAdvertisements(advertisements);
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø©:', error);
            }
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø§Ù„Ù†Ø´Ø·Ø© ÙƒØ¨Ø·Ø§Ù‚Ø§Øª
        function displayActiveAdvertisements(advertisements) {
            const cardsContainer = document.getElementById('active-ads-cards');
            const noAdsMessage = document.getElementById('no-ads-message');
            
            if (!cardsContainer) return;

            if (!advertisements || advertisements.length === 0) {
                cardsContainer.style.display = 'none';
                if (noAdsMessage) noAdsMessage.style.display = 'block';
                return;
            }

            cardsContainer.style.display = 'grid';
            if (noAdsMessage) noAdsMessage.style.display = 'none';

            const cards = advertisements.map(ad => createAdCard(ad)).join('');
            cardsContainer.innerHTML = cards;
        }

        // Ø¥Ù†Ø´Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø¥Ø¹Ù„Ø§Ù† Ø£Ù†ÙŠÙ‚Ø©
        function createAdCard(ad) {
            const statusClass = getAdStatusClass(ad);
            const statusText = getAdStatusText(ad);
            const typeText = getAdTypeText(ad);
            const positionText = getAdPositionText(ad);
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            let mainImage = '';
            if (ad.product && ad.has_product && ad.product.image_url) {
                mainImage = ad.product.image_url;
            } else if (ad.image_url) {
                mainImage = ad.image_url;
            } else {
                mainImage = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDMwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xNTAgMTAwQzE2Ni41NDkgMTAwIDE4MCA4Ni41NDkgMTgwIDcwQzE4MCA1My40NTEgMTY2LjU0OSA0MCAxNTAgNDBDMTMzLjQ1MSA0MCAxMjAgNTMuNDUxIDEyMCA3MEMxMjAgODYuNTQ5IDEzMy40NTEgMTAwIDE1MCAxMDBaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0xNTAgMTIwQzEzMy40NTEgMTIwIDEyMCAxMzMuNDUxIDEyMCAxNTBDMTIwIDE2Ni41NDkgMTMzLjQ1MSAxODAgMTUwIDE4MEMxNjYuNTQ5IDE4MCAxODAgMTY2LjU0OSAxODAgMTUwQzE4MCAxMzMuNDUxIDE2Ni41NDkgMTIwIDE1MCAxMjBaIiBmaWxsPSIjOUI5QkEwIi8+Cjwvc3ZnPgo=';
            }
            
            // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ø®ØªØµØ±Ø© Ù„Ù„Ù…Ù†ØªØ¬
            let productName = 'Ø¥Ø¹Ù„Ø§Ù† Ø¨Ø¯ÙˆÙ† Ù…Ù†ØªØ¬';
            let productPrice = '';
            let productCategory = '';
            
            if (ad.product && ad.has_product) {
                productName = ad.product.name || ad.product.description || 'Ù…Ù†ØªØ¬ Ù…Ø±ØªØ¨Ø·';
                productPrice = ad.product.price ? `ğŸ’° ${ad.product.price} Ø¬.Ù…` : '';
                productCategory = ad.product_category ? `ğŸ·ï¸ ${ad.product_category}` : '';
            }
            
            return `
                <div class="ad-card-elegant" data-ad-id="${ad.id}" onclick="openAdDetails('${ad.id}')">
                    <div class="ad-card-image-container">
                        <img src="${mainImage}" alt="ØµÙˆØ±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†" class="ad-card-main-image" 
                             onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDMwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xNTAgMTAwQzE2Ni41NDkgMTAwIDE4MCA4Ni41NDkgMTgwIDcwQzE4MCA1My40NTEgMTY2LjU0OSA0MCAxNTAgNDBDMTMzLjQ1MSA0MCAxMjAgNTMuNDUxIDEyMCA3MEMxMjAgODYuNTQ5IDEzMy40NTEgMTAwIDE1MCAxMDBaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0xNTAgMTIwQzEzMy40NTEgMTIwIDEyMCAxMzMuNDUxIDEyMCAxNTBDMTIwIDE2Ni41NDkgMTMzLjQ1MSAxODAgMTUwIDE4MEMxNjYuNTQ5IDE4MCAxODAgMTY2LjU0OSAxODAgMTUwQzE4MCAxMzMuNDUxIDE2Ni41NDkgMTIwIDE1MCAxMjBaIiBmaWxsPSIjOUI5QkEwIi8+Cjwvc3ZnPgo='">
                        <div class="ad-card-overlay">
                            <div class="ad-card-badges">
                                <span class="ad-type-badge-elegant">${typeText}</span>
                                <span class="ad-status-badge-elegant ${statusClass}">${statusText}</span>
                            </div>
                            <div class="ad-card-hover-info">
                                <span class="hover-text">Ø§Ø¶ØºØ· Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="ad-card-content">
                        <div class="ad-card-header-elegant">
                            <h3 class="ad-card-title-elegant">${ad.title || 'Ø¥Ø¹Ù„Ø§Ù† Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†'}</h3>
                            <p class="ad-card-subtitle-elegant">${positionText}</p>
                        </div>
                        
                        <div class="ad-card-product-info">
                            <h4 class="product-name-elegant">${productName}</h4>
                            ${productPrice ? `<p class="product-price-elegant">${productPrice}</p>` : ''}
                            ${productCategory ? `<p class="product-category-elegant">${productCategory}</p>` : ''}
                        </div>
                        
                        <div class="ad-card-meta">
                            <div class="meta-item">
                                <span class="meta-icon">ğŸš€</span>
                                <span class="meta-text">ÙŠØ¨Ø¯Ø£: ${formatDate(ad.start_date)}</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-icon">â°</span>
                                <span class="meta-text">ÙŠÙ†ØªÙ‡ÙŠ: ${ad.end_date ? formatDate(ad.end_date) : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-icon">â­</span>
                                <span class="meta-text">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©: ${ad.priority || 1}</span>
                            </div>
                        </div>
                        
                        <div class="ad-card-actions-elegant">
                            <button class="ad-action-btn-elegant edit" onclick="event.stopPropagation(); editAdvertisement('${ad.id}')">
                                <span>âœï¸</span>
                                ØªØ¹Ø¯ÙŠÙ„
                            </button>
                            <button class="ad-action-btn-elegant delete" onclick="event.stopPropagation(); deleteAdvertisement('${ad.id}')">
                                <span>ğŸ—‘ï¸</span>
                                Ø­Ø°Ù
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        function getAdStatusClass(ad) {
            if (ad.is_active === true) return 'active';
            if (ad.is_active === false) return 'paused';
            return 'active';
        }

        function getAdStatusText(ad) {
            if (ad.is_active === true) return 'Ù†Ø´Ø·';
            if (ad.is_active === false) return 'Ù…ØªÙˆÙ‚Ù Ù…Ø¤Ù‚ØªØ§Ù‹';
            return 'Ù†Ø´Ø·';
        }

        function getAdTypeText(type) {
            const types = {
                'featured': 'Ù…Ù…ÙŠØ²',
                'recommended': 'Ù…ÙˆØµÙ‰ Ø¨Ù‡',
                'banner': 'Ø¨Ø§Ù†Ø±'
            };
            return types[type] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }

        function getAdPositionText(position) {
            const positions = {
                'homepage_featured': 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù…Ù…ÙŠØ²',
                'homepage_recommended': 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù…ÙˆØµÙ‰ Ø¨Ù‡',
                'category_featured': 'ØµÙØ­Ø© Ø§Ù„ØªØµÙ†ÙŠÙ - Ù…Ù…ÙŠØ²',
                'sidebar': 'Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ'
            };
            return positions[position] || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
        }

        function formatDate(dateString) {
            if (!dateString) return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('ar-SA', {
                    year: 'numeric',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            } catch (error) {
                return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            }
        }

        // Ø¯ÙˆØ§Ù„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        async function editAdvertisement(adId) {
            try {
                if (!window.advertisingService) {
                    alert('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                // Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù…Ø¨Ø§Ø´Ø±Ø©
                const { data: ad, error } = await window.supabaseClient
                    .from('advertisements')
                    .select('*')
                    .eq('id', adId)
                    .single();
                
                if (error || !ad) {
                    alert('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†');
                    return;
                }

                // Ù…Ù„Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
                document.getElementById('edit-ad-id').value = ad.id;
                document.getElementById('edit-ad-type').value = ad.ad_type || '';
                document.getElementById('edit-ad-position').value = ad.position || '';
                document.getElementById('edit-ad-start-date').value = ad.start_date ? ad.start_date.slice(0, 16) : '';
                document.getElementById('edit-ad-end-date').value = ad.end_date ? ad.end_date.slice(0, 16) : '';
                document.getElementById('edit-ad-priority').value = ad.priority || 1;
                document.getElementById('edit-ad-status').value = ad.is_active ? 'active' : 'paused';

                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø©
                document.getElementById('edit-ad-modal').style.display = 'flex';
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†');
            }
        }

        async function updateAdvertisement() {
            try {
                const adId = document.getElementById('edit-ad-id').value;
                const formData = {
                    category: document.getElementById('edit-ad-category').value,
                    product_id: document.getElementById('edit-ad-product').value,
                    ad_type: document.getElementById('edit-ad-type').value,
                    position: document.getElementById('edit-ad-position').value,
                    start_date: document.getElementById('edit-ad-start-date').value,
                    end_date: document.getElementById('edit-ad-end-date').value,
                    priority: parseInt(document.getElementById('edit-ad-priority').value),
                    budget: parseFloat(document.getElementById('edit-ad-budget').value) || 0,
                    status: document.getElementById('edit-ad-status').value
                };

                if (!window.advertisingService) {
                    alert('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                const result = await window.advertisingService.updateAdvertisement(adId, formData);
                if (result.success) {
                    alert('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­');
                    hideEditAdModal();
                    loadActiveAdvertisements();
                } else {
                    alert('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†: ' + result.error);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†');
            }
        }

        async function deleteAdvertisement(adId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.')) {
                return;
            }

            try {
                if (!window.advertisingService) {
                    alert('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                const result = await window.advertisingService.deleteAdvertisement(adId);
                if (result.success) {
                    alert('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­');
                    loadActiveAdvertisements();
                } else {
                    alert('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†: ' + result.error);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†');
            }
        }

        async function pauseAdvertisement(adId) {
            try {
                if (!window.advertisingService) {
                    alert('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                const result = await window.advertisingService.updateAdvertisementStatus(adId, 'paused');
                if (result.success) {
                    alert('ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ø¤Ù‚ØªØ§Ù‹');
                    loadActiveAdvertisements();
                } else {
                    alert('Ø®Ø·Ø£ ÙÙŠ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†: ' + result.error);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†');
            }
        }

        async function activateAdvertisement(adId) {
            try {
                if (!window.advertisingService) {
                    alert('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                const result = await window.advertisingService.updateAdvertisementStatus(adId, 'active');
                if (result.success) {
                    alert('ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­');
                    loadActiveAdvertisements();
                } else {
                    alert('Ø®Ø·Ø£ ÙÙŠ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†: ' + result.error);
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†');
            }
        }

        function hideEditAdModal() {
            document.getElementById('edit-ad-modal').style.display = 'none';
        }

        async function loadProductsForEditCategory() {
            const category = document.getElementById('edit-ad-category').value;
            const productSelect = document.getElementById('edit-ad-product');
            
            if (!category) {
                productSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ Ø£ÙˆÙ„Ø§Ù‹</option>';
                productSelect.disabled = true;
                return;
            }

            try {
                if (!window.productService) {
                    console.error('Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                const products = await window.productService.getProductsByCategory(category);
                productSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬</option>' +
                    products.map(p => `<option value="${p.id}">${p.name}</option>`).join('');
                productSelect.disabled = false;
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:', error);
                productSelect.innerHTML = '<option value="">Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„</option>';
            }
        }

        async function updateEditAdPositions() {
            const adType = document.getElementById('edit-ad-type').value;
            const positionSelect = document.getElementById('edit-ad-position');
            
            if (!adType) {
                positionSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø£ÙˆÙ„Ø§Ù‹</option>';
                return;
            }

            const positions = {
                'featured': [
                    { value: 'homepage_featured', text: 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù…Ù…ÙŠØ²' },
                    { value: 'category_featured', text: 'ØµÙØ­Ø© Ø§Ù„ØªØµÙ†ÙŠÙ - Ù…Ù…ÙŠØ²' }
                ],
                'recommended': [
                    { value: 'homepage_recommended', text: 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù…ÙˆØµÙ‰ Ø¨Ù‡' }
                ],
                'banner': [
                    { value: 'sidebar', text: 'Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ' }
                ]
            };

            const availablePositions = positions[adType] || [];
            positionSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¶Ø¹</option>' +
                availablePositions.map(p => `<option value="${p.value}">${p.text}</option>`).join('');
        }

        // ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        async function loadAdRequests() {
            try {
                if (!window.advertisingService) {
                    console.error('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                // Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø¨Ø³Ø·
                displayAdRequests([]);
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª:', error);
            }
        }

        // Ø¹Ø±Ø¶ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        function displayAdRequests(requests) {
            const tableBody = document.getElementById('ad-requests-table');
            if (!tableBody) return;

            if (!requests || requests.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="10" class="text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¥Ø¹Ù„Ø§Ù†Ø§Øª</td></tr>';
                return;
            }

            const rows = requests.map(request => `
                <tr>
                    <td>${request.products?.name || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                    <td>${request.seller_email || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                    <td>${getAdTypeText(request.ad_type)}</td>
                    <td>${getAdPositionText(request.position)}</td>
                    <td>${request.duration_days}</td>
                    <td>${request.budget} Ø¬.Ù…</td>
                    <td>${request.message || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø³Ø§Ù„Ø©'}</td>
                    <td>${getRequestStatusText(request.status)}</td>
                    <td>${formatDate(request.created_at)}</td>
                    <td>
                        <button onclick="reviewAdRequest('${request.id}')" class="btn-review">Ù…Ø±Ø§Ø¬Ø¹Ø©</button>
                    </td>
                </tr>
            `).join('');

            tableBody.innerHTML = rows;
        }

        // ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        async function loadAdStatistics() {
            try {
                if (!window.advertisingService) {
                    console.error('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                const stats = await window.advertisingService.getActiveAdvertisements();
                updateAdStatistics(stats);
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª:', error);
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        function updateAdStatistics(stats) {
            if (!stats || stats.length === 0) return;

            const totalClicks = stats.reduce((sum, ad) => sum + (ad.clicks_count || 0), 0);
            const totalImpressions = stats.reduce((sum, ad) => sum + (ad.impressions_count || 0), 0);
            const activeAds = stats.filter(ad => ad.is_active === true).length;

            document.getElementById('active-ads-count').textContent = activeAds;
            document.getElementById('total-clicks').textContent = totalClicks;
            document.getElementById('total-impressions').textContent = totalImpressions;
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†
        function showAddAdForm() {
            try {
                const modal = document.getElementById('add-ad-form');
                if (!modal) {
                    console.error('Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©');
                    return;
                }
                
                modal.style.display = 'flex';
                modal.style.opacity = '1';
                modal.style.visibility = 'visible';
                modal.classList.add('show');
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
                const form = document.getElementById('new-ad-form');
                if (form) form.reset();
                
                const productSelect = document.getElementById('ad-product');
                if (productSelect) {
                    productSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ Ø£ÙˆÙ„Ø§Ù‹</option>';
                    productSelect.disabled = true;
                }
                
                const positionSelect = document.getElementById('ad-position');
                if (positionSelect) {
                    positionSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ Ø£ÙˆÙ„Ø§Ù‹</option>';
                }
                
                console.log('ØªÙ… ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© Ø¨Ù†Ø¬Ø§Ø­');
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø©:', error);
            }
        }

        // Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¥Ø¹Ù„Ø§Ù†
        function hideAddAdForm() {
            const modal = document.getElementById('add-ad-form');
            modal.style.display = 'none';
            modal.style.opacity = '0';
            modal.style.visibility = 'hidden';
            modal.classList.remove('show');
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ
        async function loadProductsForCategory() {
            try {
                const category = document.getElementById('ad-category').value;
                const productSelect = document.getElementById('ad-product');
                
                if (!category) {
                    productSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ Ø£ÙˆÙ„Ø§Ù‹</option>';
                    productSelect.disabled = true;
                    return;
                }
                
                // ØªØ­Ø¯ÙŠØ¯ Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙˆÙ„
                let tableName = 'products_other';
                switch (category) {
                    case 'cake':
                        tableName = 'products_cake';
                        break;
                    case 'koshat':
                        tableName = 'products_koshat';
                        break;
                    case 'mirr':
                        tableName = 'products_mirr';
                        break;
                    case 'other':
                        tableName = 'products_other';
                        break;
                    case 'invitations':
                        tableName = 'products_invitations';
                        break;
                }
                
                // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù…Ù† Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯
                const { data: products, error } = await window.supabaseClient
                    .from(tableName)
                    .select('id, description, price')
                    .order('created_at', { ascending: false });
                
                if (error) {
                    console.error('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:', error);
                    productSelect.innerHTML = '<option value="">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</option>';
                    return;
                }
                
                // Ù…Ù„Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
                productSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ù†ØªØ¬</option>';
                if (products && products.length > 0) {
                    products.forEach(product => {
                        const option = document.createElement('option');
                        option.value = product.id;
                        option.textContent = `${product.description} - ${product.price > 0 ? product.price + ' Ø¬.Ù…' : 'Ø§Ù„Ø³Ø¹Ø± Ø¹Ù†Ø¯ Ø§Ù„Ø·Ù„Ø¨'}`;
                        option.setAttribute('data-category', category);
                        productSelect.appendChild(option);
                    });
                } else {
                    productSelect.innerHTML = '<option value="">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ</option>';
                }
                
                productSelect.disabled = false;
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:', error);
                const productSelect = document.getElementById('ad-product');
                productSelect.innerHTML = '<option value="">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</option>';
            }
        }

        // ØªØ­Ø¯ÙŠØ« Ù…ÙˆØ§Ø¶Ø¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
        function updateAdPositions() {
            const adType = document.getElementById('ad-type').value;
            const positionSelect = document.getElementById('ad-position');
            
            positionSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…ÙˆØ¶Ø¹</option>';
            
            if (adType === 'featured') {
                positionSelect.innerHTML += '<option value="homepage_featured">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù…Ù…ÙŠØ²</option>';
                positionSelect.innerHTML += '<option value="category_featured">ØµÙØ­Ø© Ø§Ù„ØªØµÙ†ÙŠÙ - Ù…Ù…ÙŠØ²</option>';
            } else if (adType === 'recommended') {
                positionSelect.innerHTML += '<option value="homepage_recommended">Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù…ÙˆØµÙ‰ Ø¨Ù‡</option>';
            } else if (adType === 'banner') {
                positionSelect.innerHTML += '<option value="sidebar">Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ</option>';
            }
        }





        // Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø¹Ù„Ø§Ù† Ø¬Ø¯ÙŠØ¯
        async function createNewAdvertisement() {
            try {
                const category = document.getElementById('ad-category').value;
                const productSelect = document.getElementById('ad-product');
                const selectedOption = productSelect.options[productSelect.selectedIndex];
                
                const formData = {
                    product_id: document.getElementById('ad-product').value,
                    product_category: category,
                    ad_type: document.getElementById('ad-type').value,
                    position: document.getElementById('ad-position').value,
                    start_date: document.getElementById('ad-start-date').value,
                    end_date: document.getElementById('ad-end-date').value,
                    priority: document.getElementById('ad-priority').value,
                    budget: document.getElementById('ad-budget').value
                };
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                if (!category || !formData.product_id || !formData.ad_type || !formData.position || !formData.start_date) {
                    alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©');
                    return;
                }

                if (!window.advertisingService) {
                    console.error('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }

                const result = await window.advertisingService.createAdvertisement(formData);
                if (result) {
                    if (result.is_request) {
                        // ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø¥Ø¹Ù„Ø§Ù† Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø§Ù„Ù…Ø¨Ø§Ø´Ø±
                        alert(`ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø·Ù„Ø¨ Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­!\n\n${result.message}\n\nØ³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹ØªÙ‡ Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹.`);
                        hideAddAdForm();
                        loadAdRequests(); // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
                    } else {
                        // ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ø¨Ø§Ø´Ø±Ø©
                        alert('ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­');
                        hideAddAdForm();
                        loadActiveAdvertisements();
                    }
                }
            } catch (error) {
                console.error('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†');
            }
        }

        // Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨ Ø¥Ø¹Ù„Ø§Ù†
        function reviewAdRequest(requestId) {
            // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¸Ù‡Ø§Ø± ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨
            document.getElementById('review-request-modal').style.display = 'flex';
        }

        // Ø¥Ø®ÙØ§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨
        function hideReviewRequestModal() {
            document.getElementById('review-request-modal').style.display = 'none';
        }

        // Ù‚Ø¨ÙˆÙ„ Ø·Ù„Ø¨ Ø¥Ø¹Ù„Ø§Ù†
        async function approveAdRequest() {
            // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†ÙÙŠØ° Ù…Ù†Ø·Ù‚ Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨
            alert('ØªÙ… Ù‚Ø¨ÙˆÙ„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
            hideReviewRequestModal();
            loadAdRequests();
        }

        // Ø±ÙØ¶ Ø·Ù„Ø¨ Ø¥Ø¹Ù„Ø§Ù†
        async function rejectAdRequest() {
            // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†ÙÙŠØ° Ù…Ù†Ø·Ù‚ Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨
            alert('ØªÙ… Ø±ÙØ¶ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­');
            hideReviewRequestModal();
            loadAdRequests();
        }

        // ÙÙ„ØªØ±Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        function filterAdRequests() {
            const status = document.getElementById('request-status-filter').value;
            // Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ†ÙÙŠØ° Ù…Ù†Ø·Ù‚ Ø§Ù„ÙÙ„ØªØ±Ø©
        }

        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
        function getAdTypeText(type) {
            const typeMap = {
                'featured': 'Ù…Ù…ÙŠØ²',
                'recommended': 'Ù…ÙˆØµÙ‰ Ø¨Ù‡',
                'banner': 'Ø¨Ø§Ù†Ø±'
            };
            return typeMap[type] || type;
        }

        function getAdPositionText(position) {
            const positionMap = {
                'homepage_featured': 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù…Ù…ÙŠØ²',
                'homepage_recommended': 'Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© - Ù…ÙˆØµÙ‰ Ø¨Ù‡',
                'category_featured': 'ØµÙØ­Ø© Ø§Ù„ØªØµÙ†ÙŠÙ - Ù…Ù…ÙŠØ²',
                'sidebar': 'Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ'
            };
            return positionMap[position] || position;
        }
        
        // ===== Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø© =====
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©
        async function loadSystemStatistics() {
            try {
                console.log('ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©...');
                console.log('ğŸ” ÙØ­Øµ ØªÙˆÙØ± Ø§Ù„Ø®Ø¯Ù…Ø§Øª...');
                
                // ÙØ­Øµ ØªÙˆÙØ± Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
                if (!window.advertisingService) {
                    console.error('âŒ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    console.log('ğŸ” Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø©...');
                    
                    // Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ø¯Ù…Ø©
                    let attempts = 0;
                    while (!window.advertisingService && attempts < 50) {
                        await new Promise(resolve => setTimeout(resolve, 100));
                        attempts++;
                        console.log(`Ù…Ø­Ø§ÙˆÙ„Ø© ${attempts}: Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª...`);
                    }
                    
                    if (!window.advertisingService) {
                        console.error('âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø¨Ø¹Ø¯ 50 Ù…Ø­Ø§ÙˆÙ„Ø©');
                        alert('Ø®Ø·Ø£: Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.');
                        return;
                    }
                }
                
                console.log('âœ… Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ù…ØªÙˆÙØ±Ø©:', window.advertisingService);
                
                // ÙØ­Øµ ØªÙˆÙØ± Ø¯ÙˆØ§Ù„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
                if (!window.advertisingService.getSystemStatistics) {
                    console.error('âŒ Ø¯Ø§Ù„Ø© getSystemStatistics ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    alert('Ø®Ø·Ø£: Ø¯Ø§Ù„Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©. ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙØ­Ø©.');
                    return;
                }
                
                console.log('âœ… Ø¯Ø§Ù„Ø© getSystemStatistics Ù…ØªÙˆÙØ±Ø©');
                
                // Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©
                console.log('ğŸ”„ Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
                const stats = await window.advertisingService.getSystemStatistics();
                
                console.log('ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©:', stats);
                
                if (stats) {
                    console.log('âœ… ØªÙ… Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...');
                    displaySystemStatistics(stats);
                } else {
                    console.error('âŒ ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª - Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙØ§Ø±ØºØ©');
                    alert('ØªØ­Ø°ÙŠØ±: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø¹Ù„Ø§Ù†Ø§Øª. Ù‚Ø¯ ØªÙƒÙˆÙ† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙØ§Ø±ØºØ©.');
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©:', error);
                alert(`Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª: ${error.message}`);
            }
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø´Ø§Ù…Ù„Ø©
        function displaySystemStatistics(stats) {
            // Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            document.getElementById('total-ads-stat').textContent = stats.total_advertisements;
            document.getElementById('active-ads-stat').textContent = stats.active_advertisements;
            document.getElementById('total-impressions-stat').textContent = stats.total_impressions.toLocaleString('ar-EG');
            document.getElementById('total-clicks-stat').textContent = stats.total_clicks.toLocaleString('ar-EG');
            
            // Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ø£Ø¯Ø§Ø¡
            document.getElementById('overall-ctr-stat').textContent = stats.overall_ctr + '%';
            document.getElementById('avg-impressions-stat').textContent = stats.average_impressions_per_ad;
            document.getElementById('avg-clicks-stat').textContent = stats.average_clicks_per_ad;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©
            displayTypeStatistics(stats.by_type);
            displayPositionStatistics(stats.by_position);
            displayCategoryStatistics(stats.by_category);
        }
        
        // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†ÙˆØ¹
        function displayTypeStatistics(typeStats) {
            const container = document.getElementById('type-stats');
            if (!container) return;
            
            let html = '<table class="stats-table">';
            html += '<thead><tr><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„Ø¹Ø¯Ø¯</th><th>Ø§Ù„Ø¸Ù‡ÙˆØ±Ø§Øª</th><th>Ø§Ù„Ù†Ù‚Ø±Ø§Øª</th><th>Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‚Ø±</th></tr></thead><tbody>';
            
            Object.entries(typeStats).forEach(([type, data]) => {
                const ctr = data.impressions > 0 ? ((data.clicks / data.impressions) * 100).toFixed(2) : '0.00';
                html += `<tr>
                    <td>${getAdTypeText(type)}</td>
                    <td>${data.count}</td>
                    <td>${data.impressions.toLocaleString('ar-EG')}</td>
                    <td>${data.clicks.toLocaleString('ar-EG')}</td>
                    <td>${ctr}%</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }
        
        // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ¶Ø¹
        function displayPositionStatistics(positionStats) {
            const container = document.getElementById('position-stats');
            if (!container) return;
            
            let html = '<table class="stats-table">';
            html += '<thead><tr><th>Ø§Ù„Ù…ÙˆØ¶Ø¹</th><th>Ø§Ù„Ø¹Ø¯Ø¯</th><th>Ø§Ù„Ø¸Ù‡ÙˆØ±Ø§Øª</th><th>Ø§Ù„Ù†Ù‚Ø±Ø§Øª</th><th>Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‚Ø±</th></tr></thead><tbody>';
            
            Object.entries(positionStats).forEach(([position, data]) => {
                const ctr = data.impressions > 0 ? ((data.clicks / data.impressions) * 100).toFixed(2) : '0.00';
                html += `<tr>
                    <td>${getAdPositionText(position)}</td>
                    <td>${data.count}</td>
                    <td>${data.impressions.toLocaleString('ar-EG')}</td>
                    <td>${data.clicks.toLocaleString('ar-EG')}</td>
                    <td>${ctr}%</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }
        
        // Ø¹Ø±Ø¶ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØµÙ†ÙŠÙ
        function displayCategoryStatistics(categoryStats) {
            const container = document.getElementById('category-stats');
            if (!container) return;
            
            let html = '<table class="stats-table">';
            html += '<thead><tr><th>Ø§Ù„ØªØµÙ†ÙŠÙ</th><th>Ø§Ù„Ø¹Ø¯Ø¯</th><th>Ø§Ù„Ø¸Ù‡ÙˆØ±Ø§Øª</th><th>Ø§Ù„Ù†Ù‚Ø±Ø§Øª</th><th>Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‚Ø±</th></tr></thead><tbody>';
            
            Object.entries(categoryStats).forEach(([category, data]) => {
                const ctr = data.impressions > 0 ? ((data.clicks / data.impressions) * 100).toFixed(2) : '0.00';
                const categoryText = getCategoryText(category);
                html += `<tr>
                    <td>${categoryText}</td>
                    <td>${data.count}</td>
                    <td>${data.impressions.toLocaleString('ar-EG')}</td>
                    <td>${data.clicks.toLocaleString('ar-EG')}</td>
                    <td>${ctr}%</td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            container.innerHTML = html;
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function refreshSystemStatistics() {
            loadSystemStatistics();
        }
        
        // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function exportStatistics() {
            // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØµØ¯ÙŠØ± Ù‡Ù†Ø§
            alert('Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ²Ø© ØªØµØ¯ÙŠØ± Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø±ÙŠØ¨Ø§Ù‹');
        }
        
        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù†Øµ Ø§Ù„ØªØµÙ†ÙŠÙ
        function getCategoryText(category) {
            const categoryMap = {
                'cake': 'ØªÙˆØ±ØªØ§Øª',
                'koshat': 'ÙƒØ´Ø§Øª',
                'mirr': 'Ù…ÙŠØ±',
                'other': 'Ø£Ø®Ø±Ù‰',
                'invitations': 'Ø¯Ø¹ÙˆØ§Øª ÙˆØªÙˆØ²ÙŠØ¹Ø§Øª'
            };
            return categoryMap[category] || category;
        }

        function getPaymentStatusText(status) {
            const statusMap = {
                'pending': 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
                'paid': 'Ù…Ø¯ÙÙˆØ¹',
                'expired': 'Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©',
                'cancelled': 'Ù…Ù„ØºÙŠ'
            };
            return statusMap[status] || status;
        }

        function getRequestStatusText(status) {
            const statusMap = {
                'pending': 'ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
                'approved': 'Ù…Ù‚Ø¨ÙˆÙ„',
                'rejected': 'Ù…Ø±ÙÙˆØ¶',
                'cancelled': 'Ù…Ù„ØºÙŠ'
            };
            return statusMap[status] || status;
        }

        function formatDate(dateString) {
            if (!dateString) return 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            const date = new Date(dateString);
            return date.toLocaleDateString('ar-EG');
        }

        // ÙØªØ­ ØµÙØ­Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
        async function openAdDetails(adId) {
            try {
                if (!window.advertisingService) {
                    console.error('Ø®Ø¯Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©');
                    return;
                }
                
                console.log('ğŸ” ÙØªØ­ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', adId);
                
                // Ø¬Ù„Ø¨ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ù…Ø¹ Ø§Ù„Ù…Ù†ØªØ¬
                const adWithProduct = await window.advertisingService.getAdvertisementWithProduct(adId);
                
                // ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ø¹ Ø§Ù„ØªÙØ§ØµÙŠÙ„
                const detailsWindow = window.open('', '_blank', 'width=800,height=600,scrollbars=yes,resizable=yes');
                
                if (detailsWindow) {
                    detailsWindow.document.write(createAdDetailsPage(adWithProduct));
                    detailsWindow.document.close();
                } else {
                    // Ø¥Ø°Ø§ ÙØ´Ù„ ÙØªØ­ Ø§Ù„Ù†Ø§ÙØ°Ø©ØŒ Ø§Ø¹Ø±Ø¶ ÙÙŠ Ù†ÙØ³ Ø§Ù„ØµÙØ­Ø©
                    showAdDetailsModal(adWithProduct);
                }
                
            } catch (error) {
                console.error('âŒ Ø®Ø·Ø£ ÙÙŠ ÙØªØ­ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ÙØªØ­ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†');
            }
        }

        // Ø¥Ù†Ø´Ø§Ø¡ ØµÙØ­Ø© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
        function createAdDetailsPage(ad) {
            return `
                <!DOCTYPE html>
                <html lang="ar" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <meta name="viewport" content="width=device-width, initial-scale=1.0">
                    <title>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† - ${ad.title}</title>
                    <style>
                        * {
                            margin: 0;
                            padding: 0;
                            box-sizing: border-box;
                        }
                        
                        body {
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                            background: #f8fafc;
                            color: #1f2937;
                            line-height: 1.6;
                        }
                        
                        .container {
                            max-width: 800px;
                            margin: 0 auto;
                            padding: 20px;
                        }
                        
                        .header {
                            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                            color: white;
                            padding: 30px;
                            border-radius: 15px;
                            margin-bottom: 30px;
                            text-align: center;
                        }
                        
                        .header h1 {
                            font-size: 2.5em;
                            margin-bottom: 10px;
                        }
                        
                        .header .subtitle {
                            font-size: 1.2em;
                            opacity: 0.9;
                        }
                        
                        .content-section {
                            background: white;
                            border-radius: 12px;
                            padding: 25px;
                            margin-bottom: 20px;
                            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                        }
                        
                        .section-title {
                            font-size: 1.5em;
                            color: #374151;
                            margin-bottom: 20px;
                            border-bottom: 2px solid #e5e7eb;
                            padding-bottom: 10px;
                        }
                        
                        .product-images {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                            gap: 20px;
                            margin-bottom: 20px;
                        }
                        
                        .product-image {
                            width: 100%;
                            height: 200px;
                            object-fit: cover;
                            border-radius: 8px;
                            border: 2px solid #e5e7eb;
                        }
                        
                        .product-details {
                            display: grid;
                            grid-template-columns: 1fr 1fr;
                            gap: 20px;
                        }
                        
                        .detail-item {
                            display: flex;
                            align-items: center;
                            gap: 10px;
                            padding: 10px;
                            background: #f8fafc;
                            border-radius: 8px;
                        }
                        
                        .detail-icon {
                            font-size: 1.2em;
                        }
                        
                        .detail-label {
                            font-weight: 600;
                            color: #374151;
                        }
                        
                        .detail-value {
                            color: #6b7280;
                        }
                        
                        .social-links {
                            display: flex;
                            gap: 15px;
                            flex-wrap: wrap;
                        }
                        
                        .social-link {
                            display: flex;
                            align-items: center;
                            gap: 8px;
                            padding: 10px 15px;
                            background: #dbeafe;
                            color: #1e40af;
                            text-decoration: none;
                            border-radius: 8px;
                            font-weight: 500;
                            transition: all 0.3s ease;
                        }
                        
                        .social-link:hover {
                            background: #bfdbfe;
                            transform: translateY(-2px);
                        }
                        
                        .ad-info {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                            gap: 15px;
                        }
                        
                        .info-card {
                            background: #f8fafc;
                            padding: 15px;
                            border-radius: 8px;
                            text-align: center;
                        }
                        
                        .info-value {
                            font-size: 1.5em;
                            font-weight: bold;
                            color: #3b82f6;
                            margin-bottom: 5px;
                        }
                        
                        .info-label {
                            color: #6b7280;
                            font-size: 0.9em;
                        }
                        
                        .close-btn {
                            position: fixed;
                            top: 20px;
                            right: 20px;
                            background: #ef4444;
                            color: white;
                            border: none;
                            padding: 10px 15px;
                            border-radius: 8px;
                            cursor: pointer;
                            font-size: 1.1em;
                            transition: all 0.3s ease;
                        }
                        
                        .close-btn:hover {
                            background: #dc2626;
                            transform: scale(1.1);
                        }
                    </style>
                </head>
                <body>
                    <button class="close-btn" onclick="window.close()">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
                    
                    <div class="container">
                        <div class="header">
                            <h1>${ad.title || 'ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†'}</h1>
                            <p class="subtitle">${ad.description || 'ÙˆØµÙ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†'}</p>
                        </div>
                        
                        ${ad.product && ad.has_product ? `
                            <div class="content-section">
                                <h2 class="section-title">ğŸ–¼ï¸ ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬</h2>
                                <div class="product-images">
                                    ${ad.product.image_urls && ad.product.image_urls.length > 0 ? 
                                        ad.product.image_urls.map(img => `<img src="${img}" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬" class="product-image">`).join('') :
                                        `<img src="${ad.product.image_url || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDMwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIzMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0xNTAgMTAwQzE2Ni41NDkgMTAwIDE4MCA4Ni41NDkgMTgwIDcwQzE4MCA1My40NTEgMTY2LjU0OSA0MCAxNTAgNDBDMTMzLjQ1MSA0MCAxMjAgNTMuNDUxIDEyMCA3MEMxMjAgODYuNTQ5IDEzMy40NTEgMTAwIDE1MCAxMDBaIiBmaWxsPSIjOUI5QkEwIi8+CjxwYXRoIGQ9Ik0xNTAgMTIwQzEzMy40NTEgMTIwIDEyMCAxMzMuNDUxIDEyMCAxNTBDMTIwIDE2Ni41NDkgMTMzLjQ1MSAxODAgMTUwIDE4MEMxNjYuNTQ5IDE4MCAxODAgMTY2LjU0OSAxODAgMTUwQzE4MCAxMzMuNDUxIDE2Ni41NDkgMTIwIDE1MCAxMjBaIiBmaWxsPSIjOUI5QkEwIi8+Cjwvc3ZnPgo='}" alt="ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬" class="product-image">`
                                    }
                                </div>
                            </div>
                            
                            <div class="content-section">
                                <h2 class="section-title">ğŸ›ï¸ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬</h2>
                                <div class="product-details">
                                    <div class="detail-item">
                                        <span class="detail-icon">ğŸ“</span>
                                        <span class="detail-label">Ø§Ù„Ø§Ø³Ù…:</span>
                                        <span class="detail-value">${ad.product.name || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-icon">ğŸ’°</span>
                                        <span class="detail-label">Ø§Ù„Ø³Ø¹Ø±:</span>
                                        <span class="detail-value">${ad.product.price || 0} Ø¬.Ù…</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-icon">ğŸ·ï¸</span>
                                        <span class="detail-label">Ø§Ù„ØªØµÙ†ÙŠÙ:</span>
                                        <span class="detail-value">${ad.product.category || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-icon">ğŸ“‚</span>
                                        <span class="detail-label">Ø§Ù„ÙØ¦Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ©:</span>
                                        <span class="detail-value">${ad.product.subcategory || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-icon">ğŸ›ï¸</span>
                                        <span class="detail-label">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©:</span>
                                        <span class="detail-value">${ad.product.governorate || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                    <div class="detail-item">
                                        <span class="detail-icon">ğŸ™ï¸</span>
                                        <span class="detail-label">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</span>
                                        <span class="detail-value">${ad.product.cities || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                    </div>
                                </div>
                                
                                ${ad.product.description ? `
                                    <div style="margin-top: 20px; padding: 15px; background: #f8fafc; border-radius: 8px;">
                                        <h3 style="margin-bottom: 10px; color: #374151;">ğŸ“– Ø§Ù„ÙˆØµÙ</h3>
                                        <p style="color: #6b7280; line-height: 1.6;">${ad.product.description}</p>
                                    </div>
                                ` : ''}
                                
                                ${(ad.product.whatsapp || ad.product.facebook || ad.product.instagram) ? `
                                    <div style="margin-top: 20px;">
                                        <h3 style="margin-bottom: 15px; color: #374151;">ğŸ“± ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„ØªÙˆØ§ØµÙ„</h3>
                                        <div class="social-links">
                                            ${ad.product.whatsapp ? `<a href="https://wa.me/${ad.product.whatsapp}" target="_blank" class="social-link">ğŸ“± ÙˆØ§ØªØ³Ø§Ø¨: ${ad.product.whatsapp}</a>` : ''}
                                            ${ad.product.facebook ? `<a href="${ad.product.facebook}" target="_blank" class="social-link">ğŸ“˜ ÙÙŠØ³Ø¨ÙˆÙƒ</a>` : ''}
                                            ${ad.product.instagram ? `<a href="https://instagram.com/${ad.product.instagram}" target="_blank" class="social-link">ğŸ“· Ø¥Ù†Ø³ØªØºØ±Ø§Ù…: @${ad.product.instagram}</a>` : ''}
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                        ` : `
                            <div class="content-section">
                                <h2 class="section-title">âš ï¸ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ù†ØªØ¬ Ù…Ø±ØªØ¨Ø·</h2>
                                <p style="text-align: center; color: #6b7280; font-size: 1.1em;">Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ØºÙŠØ± Ù…Ø±ØªØ¨Ø· Ø¨Ù…Ù†ØªØ¬ Ø­Ù‚ÙŠÙ‚ÙŠ</p>
                            </div>
                        `}
                        
                        <div class="content-section">
                            <h2 class="section-title">ğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</h2>
                            <div class="ad-info">
                                <div class="info-card">
                                    <div class="info-value">${ad.ad_type || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                                    <div class="info-label">Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</div>
                                </div>
                                <div class="info-card">
                                    <div class="info-value">${ad.position || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</div>
                                    <div class="info-label">Ø§Ù„Ù…ÙˆÙ‚Ø¹</div>
                                </div>
                                <div class="info-card">
                                    <div class="info-value">${ad.priority || 1}</div>
                                    <div class="info-label">Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</div>
                                </div>
                                <div class="info-card">
                                    <div class="info-value">${ad.is_active ? 'Ù†Ø´Ø·' : 'Ù…ØªÙˆÙ‚Ù'}</div>
                                    <div class="info-label">Ø§Ù„Ø­Ø§Ù„Ø©</div>
                                </div>
                            </div>
                            
                            <div style="margin-top: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                                <div class="detail-item">
                                    <span class="detail-icon">ğŸ“…</span>
                                    <span class="detail-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©:</span>
                                    <span class="detail-value">${formatDate(ad.start_date)}</span>
                                </div>
                                <div class="detail-item">
                                    <span class="detail-icon">â°</span>
                                    <span class="detail-label">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡:</span>
                                    <span class="detail-value">${ad.end_date ? formatDate(ad.end_date) : 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
                                </div>
                            </div>
                        </div>
                        
                        ${ad.link_url ? `
                            <div class="content-section">
                                <h2 class="section-title">ğŸ”— Ø±Ø§Ø¨Ø· Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†</h2>
                                <a href="${ad.link_url}" target="_blank" style="display: inline-block; padding: 15px 25px; background: #3b82f6; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; transition: all 0.3s ease;">
                                    ğŸŒ ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·
                                </a>
                            </div>
                        ` : ''}
                    </div>
                </body>
                </html>
            `;
        }
    </script>
</body>
</html> 