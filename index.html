<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>زينة | Zeina Events – تنوّع يلبي كل الأذواق من الكوشات والتورتات والدعوات</title>
    <meta name="description" content="زينة | Zeina Events: كوشات، تورتات وأنواع الشوكولاتة، مرايا، ديكورات متنوعة، دعوات وتوزيعات. تصفّح التصنيفات وابحث عن كل ما تحتاجه لحفلتك.">
    <meta name="title" content="زينة | Zeina Events – تنوّع يلبي كل الأذواق من الكوشات والتورتات والدعوات">
    <link rel="canonical" href="https://zeinaevents.com/">
    <link rel="icon" type="image/png" href="assets/images/zeina.jpeg">
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"Organization",
      "name":"Zeina Events",
      "url":"https://zeinaevents.com",
      "logo":"https://zeinaevents.com/assets/images/zeina.jpeg"
    }
    </script>
    <script type="application/ld+json">
    {
      "@context":"https://schema.org",
      "@type":"WebSite",
      "url":"https://zeinaevents.com",
      "potentialAction":{
        "@type":"SearchAction",
        "target":"https://zeinaevents.com/search?q={query}",
        "query-input":"required name=query"
      }
    }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" as="script">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js?v=2025-08-22-1"></script>
    <script src="js/cities-service.js?v=2025-08-22-1" defer></script>
    <script src="js/product-service.js?v=2025-08-22-1" defer></script>
    <script src="js/auth-service.js?v=2025-08-22-1" defer></script>
    <script src="js/admin-security.js?v=2025-08-22-1" defer></script>
    <script src="js/governorate-filter.js?v=2025-08-22-1" defer></script>
    <script src="js/enhanced-auto-slideshow.js?v=2025-08-22-1" defer></script>
    <script src="js/product-requests-service.js?v=2025-08-22-1" defer></script>
    <script src="js/advertising-service.js?v=2025-08-22-1" defer></script>
    <script src="js/smart-category-advertising.js?v=2025-08-22-1" defer></script>
    <script src="js/scroll-optimization.js?v=2025-08-22-1" defer></script>
    <script src="js/smooth-scroll.js?v=2025-08-22-1" defer></script>
    <script src="js/common-utils.js?v=2025-08-22-1" defer></script>
    
    <!-- Cities Filter Styles -->
    <style>
        :root {
            --primary-pink: #f8d7e4;
            --primary-green: #d8e9d6;
            --primary-beige: #f5f0e6;
            --gold: #d4af37;
        }
        
        body {
            font-family: 'Tajawal', sans-serif;
            background-color: #f9f9f9;
        }
        
        .hero-image {
            height: 60vh;
            background-position: center;
            background-size: cover;
            transition: all 0.7s ease-in-out;
            position: relative;
        }
        
        .text-shadow {
            text-shadow: none;
        }
        
        .text-shadow-lg {
            text-shadow: none;
        }
        
        .carousel-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .carousel-indicator.active {
            background: #d4af37;
            border-color: #d4af37;
            transform: scale(1.2);
        }
        
        .product-card {
            transition: all 0.3s ease;
            box-shadow: 0 2px 15px rgba(0,0,0,0.05);
        }
        
        /* تنسيق شبكة المنتجات 3x3 موحدة لجميع الشاشات */
        #featured-products-grid,
        #recommended-products-grid {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            grid-template-rows: repeat(3, auto) !important;
            gap: 1.5rem !important;
            width: 100% !important;
        }
        
        /* خمسة أعمدة على الشاشات الكبيرة للأقسام الرئيسية */
        @media (min-width: 1024px) {
            #featured-products-grid,
            #recommended-products-grid {
                grid-template-columns: repeat(5, 1fr) !important;
            }
        }
        
        /* تنسيق بطاقات المنتجات في الشبكة - الآن تستخدم نفس تصميم التصنيفات */
        #featured-products-grid .category-product-card,
        #recommended-products-grid .category-product-card {
            width: 100% !important;
            max-width: none !important;
            flex-shrink: 0 !important;
        }
        
        /* تنسيق موحد لجميع الشاشات - تعديل الفجوات فقط */
        @media (max-width: 1024px) {
            #featured-products-grid,
            #recommended-products-grid {
                gap: 1.25rem !important;
            }
        }
        
        @media (max-width: 768px) {
            #featured-products-grid,
            #recommended-products-grid {
                gap: 1rem !important;
            }
        }
        
        @media (max-width: 640px) {
            #featured-products-grid,
            #recommended-products-grid {
                gap: 0.75rem !important;
            }
        }
        
        @media (max-width: 480px) {
            #featured-products-grid,
            #recommended-products-grid {
                gap: 0.5rem !important;
            }
        }
        
        @media (max-width: 360px) {
            #featured-products-grid,
            #recommended-products-grid {
                gap: 0.375rem !important;
            }
        }
        

        

        

        

        
        /* أنماط السلايدر الجديد */
        .product-image-container {
            position: relative;
            overflow: hidden;
            border-radius: 8px 8px 0 0;
        }
        

        

        
        /* تحسين القائمة الرئيسية للهاتف المحمول */
        #mobile-menu {
            /* منع التمرير في الصفحة الرئيسية عند فتح القائمة */
            overscroll-behavior: contain;
            /* تحسين التمرير باللمس */
            -webkit-overflow-scrolling: touch;
            /* إخفاء شريط التمرير */
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        #mobile-menu::-webkit-scrollbar {
            display: none;
        }
        
        #mobile-menu > div {
            /* تحديد ارتفاع أقصى للقائمة */
            max-height: 80vh;
            /* تفعيل التمرير العمودي */
            overflow-y: auto;
            /* منع التمرير الأفقي */
            overflow-x: hidden;
        }
        
        /* تحسين التمرير على الأجهزة المحمولة */
        @media (max-width: 768px) {
            #mobile-menu > div {
                /* تحسين التمرير على الأجهزة المحمولة */
                -webkit-overflow-scrolling: touch;
                /* منع التمرير في الصفحة الرئيسية */
                overscroll-behavior: contain;
                /* تحسين الأداء */
                will-change: scroll-position;
            }
        }
        
        /* تحسين جودة الصور في الصفحة الرئيسية */
        .category-card img {
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }
        

        
        /* تنسيق رسائل الخطأ */
        .error-message {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        /* تحسينات أقسام التصنيفات */
        #koshat-section,
        #cake-section,
        #mirror-section,
        #other-section,
        #invitations-section {
            transition: all 0.3s ease;
            border: 1px solid #e5e7eb;
        }
        
        #koshat-section:hover,
        #cake-section:hover,
        #mirror-section:hover,
        #other-section:hover,
        #invitations-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            border-color: #d4af37;
        }
        
        /* تحسين أزرار عرض المزيد */
        .category-view-more-btn {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            transition: all 0.3s ease;
        }
        
        .category-view-more-btn:hover {
            background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
            transform: translateY(-1px);
            box-shadow: 0 10px 15px -3px rgba(217, 119, 6, 0.3);
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* تنسيق الحقول التي تحتوي على أخطاء */
        .border-red-500 {
            border-color: #ef4444 !important;
        }
        
        /* Validation Styles */
        .validation-error {
            color: #dc2626;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .validation-error::before {
            content: "⚠️";
            font-size: 1rem;
        }
        
        .validation-error.show {
            display: flex;
        }
        
        .validation-error.hidden {
            display: none;
        }
        
        .field-error {
            border-color: #dc2626 !important;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1) !important;
        }
        
        .field-error:focus {
            border-color: #dc2626 !important;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1) !important;
        }
        
        .required-field {
            color: #dc2626;
            font-weight: 600;
        }
        
        /* Special error styling for governorate and subcategory sections */
        .simple-governorate-filter.field-error .dropdown-btn {
            border-color: #dc2626 !important;
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1) !important;
        }
        
        .simple-governorate-filter.field-error .dropdown-btn:hover {
            border-color: #dc2626 !important;
        }
        
        #request-subcategory-group.field-error {
            border: 2px solid #dc2626;
            border-radius: 8px;
            padding: 1rem;
            background-color: rgba(220, 38, 38, 0.05);
        }
        
        #request-subcategory-options.field-error {
            border: 1px solid #dc2626;
            border-radius: 6px;
            padding: 0.5rem;
            background-color: rgba(220, 38, 38, 0.05);
        }
        
        .field-error {
            border-color: #dc2626 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }
        
        /* تنسيق dropdown المحافظات عند وجود خطأ */
        #request-governorate-dropdown-btn.border-red-500 {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }
        
        /* تنسيق مجموعة التصنيفات الفرعية عند وجود خطأ */
        #request-subcategory-group.border-red-500 {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }
        
        /* تنسيق منطقة رفع الصور عند وجود خطأ */
        #request-upload-area.border-red-500 {
            border-color: #ef4444 !important;
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1) !important;
        }
        

        
        .gold-border {
            border: 1px solid var(--gold);
        }
        
        /* ضمان ظهور الهيدر */
        header {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            position: sticky !important;
            top: 0 !important;
            z-index: 50 !important;
            background-color: white !important;
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06) !important;
        }
        
        /* تحسين التمرير السلس */
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 80px; /* تعويض ارتفاع الهيدر */
        }
        
        /* تحسين التمرير على الأجهزة المحمولة */
        @media (max-width: 768px) {
            html {
                scroll-padding-top: 70px;
            }
        }
        
        /* تأثير بصري للقسم المستهدف */
        #product-request-section {
            scroll-margin-top: 80px;
        }
        
        @media (max-width: 768px) {
            #product-request-section {
                scroll-margin-top: 70px;
            }
        }
        
        header .container {
            display: flex !important;
            align-items: center !important;
            justify-content: space-between !important;
        }
        
        .gold-text {
            color: var(--gold);
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .hero-image {
                height: 40vh;
            }
        }
        
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        /* Logo styles */
        .logo-css {
            width: 100%;
            height: 100%;
        }
        

        
        .logo-text {
            font-family: 'Tajawal', sans-serif;
            color: #d4af37;
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
        }
        
        /* Fallback logo styles */
        .logo-fallback {
            background: linear-gradient(135deg, #d4af37 0%, #b8941f 100%);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-weight: bold;
            text-align: center;
            font-size: 0.875rem;
        }
        
        /* Button Styles */
        .btn-primary {
            background: linear-gradient(135deg, var(--gold) 0%, #b8941f 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3);
        }
        
        .btn-secondary {
            background: transparent;
            color: #666;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            border: 2px solid #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            border-color: #999;
            color: #333;
        }
        
        /* Header CTA Buttons */
        .header-cta {
            background-color: #845FCE;
            color: #fff;
        }
        
        .header-cta:hover {
            background-color: #6f46cf;
        }
        
        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            text-align: center;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        
        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }
        
        .modal-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--gold) 0%, #b8941f 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            box-shadow: 0 10px 25px rgba(212, 175, 55, 0.3);
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1rem;
        }
        
        .modal-message {
            color: #666;
            line-height: 1.6;
            margin-bottom: 2rem;
        }
        
        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        
        .btn-modal-primary {
            background: linear-gradient(135deg, var(--gold) 0%, #b8941f 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-modal-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3);
        }
        
        .btn-modal-secondary {
            background: transparent;
            color: #666;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            border: 2px solid #ddd;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn-modal-secondary:hover {
            border-color: #999;
            color: #333;
        }
        
        /* Custom Modal Styles */
        .custom-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .custom-modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .custom-modal-content {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            transform: scale(0.8);
            transition: all 0.3s ease;
        }
        
        .custom-modal-overlay.active .custom-modal-content {
            transform: scale(1);
        }
        
        .custom-modal-icon {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 2rem;
        }
        
        .custom-modal-icon.warning {
            background: #fef3c7;
            color: #f59e0b;
        }
        
        .custom-modal-icon.success {
            background: #d1fae5;
            color: #10b981;
        }
        
        .custom-modal-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #1f2937;
        }
        
        .custom-modal-message {
            color: #6b7280;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        
        .custom-modal-buttons {
            display: flex;
            gap: 0.75rem;
            justify-content: center;
        }
        
        .custom-modal-btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 100px;
        }
        
        .custom-modal-btn.cancel {
            background: #f3f4f6;
            color: #6b7280;
        }
        
        .custom-modal-btn.cancel:hover {
            background: #e5e7eb;
            transform: translateY(-1px);
        }
        
        .custom-modal-btn.confirm {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }
        
        .custom-modal-btn.confirm:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.3);
        }
        
        .custom-modal-btn.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }
        
        .custom-modal-btn.success:hover {
            transform: translateY(-1px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
        }
        
        /* تأثيرات إضافية لزر "أضف منتجك" */
        #add-product-request-btn {
            position: relative;
            overflow: hidden;
        }
        
        #add-product-request-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        #add-product-request-btn:hover::before {
            left: 100%;
        }
        
        /* تأثير التمرير السلس */
        html {
            scroll-behavior: smooth;
        }
        
        /* تأثير النبض للقسم */
        @keyframes section-pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            }
            50% {
                transform: scale(1.02);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            }
        }
        
        /* تحسينات التصميم المتجاوب للنموذج */
        #product-request-section {
            scroll-margin-top: 100px; /* تعويض ارتفاع الهيدر */
        }
        
        /* تحسينات للأجهزة المحمولة */
        @media (max-width: 768px) {
            #product-request-section {
                scroll-margin-top: 80px;
                padding: 1rem;
            }
            
            #product-request-section .container {
                padding-left: 1rem;
                padding-right: 1rem;
            }
            
            #product-request-form {
                padding: 1.5rem;
                margin: 0 0.5rem;
            }
            
            /* تحسين عرض الحقول على الشاشات الصغيرة */
            .grid.grid-cols-1.md\\:grid-cols-2 {
                grid-template-columns: 1fr;
            }
            
            /* تحسين أحجام الأزرار */
            #product-request-form button[type="submit"] {
                width: 100%;
                padding: 1rem;
                font-size: 1.1rem;
            }
        }
        
        /* تحسينات للشاشات الصغيرة جداً */
        @media (max-width: 480px) {
            #product-request-section {
                padding: 0.5rem;
            }
            
            #product-request-form {
                padding: 1rem;
                border-radius: 16px;
            }
            
            /* تحسين عرض التصنيفات الفرعية */
            #request-subcategory-options {
                grid-template-columns: 1fr;
            }
            
            /* تحسين عرض المحافظات */
            .governorate-options {
                max-height: 250px;
            }
        }
        
        /* تحسينات للشاشات الكبيرة */
        @media (min-width: 1200px) {
            #product-request-section .container {
                max-width: 1200px;
            }
            
            #product-request-form {
                padding: 2.5rem;
            }
        }
        
        /* Categories Products Grid Styles - Always 3x3 */
        .categories-products-grid {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 1rem;
        }
        
        /* Ensure 3x3 grid on all screen sizes */
        #koshat-products-grid,
        #cake-products-grid,
        #mirror-products-grid,
        #other-products-grid,
        #invitations-products-grid {
            display: grid !important;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 1rem;
            max-width: 100%;
        }
        
        /* خمسة أعمدة على الشاشات الكبيرة لأقسام التصنيفات أسفل الصفحة */
        @media (min-width: 1024px) {
            #koshat-products-grid,
            #cake-products-grid,
            #mirror-products-grid,
            #other-products-grid,
            #invitations-products-grid {
                grid-template-columns: repeat(5, 1fr) !important;
            }
        }
        
        /* Product card styles for categories */
        .category-product-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .category-product-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .category-product-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        /* على الشاشات الكبيرة اجعل الصور عمودية (Portrait) */
        @media (min-width: 1024px) {
            .category-product-card img {
                aspect-ratio: 3 / 4; /* نسبة عمودية */
                height: auto; /* احتساب الارتفاع من النسبة */
                object-fit: cover; /* قص مناسب مع الحفاظ على الامتلاء */
            }
        }
        
        .category-product-card:hover img {
            transform: scale(1.05);
        }
        
        .category-product-info {
            padding: 1rem;
        }
        
        .category-product-name {
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .category-product-price {
            color: #d4af37;
            font-weight: 700;
            font-size: 1.1rem;
        }
        
        /* Responsive adjustments for categories */
        @media (max-width: 768px) {
            #koshat-products-grid,
            #cake-products-grid,
            #mirror-products-grid,
            #other-products-grid,
            #invitations-products-grid {
                gap: 0.75rem;
            }
            
            .category-product-card img {
                height: 160px;
            }
            
            .category-product-info {
                padding: 0.75rem;
            }
            
            .category-product-name {
                font-size: 0.9rem;
            }
            
            .category-product-price {
                font-size: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            #koshat-products-grid,
            #cake-products-grid,
            #mirror-products-grid,
            #other-products-grid,
            #invitations-products-grid {
                gap: 0.5rem;
            }
            
            .category-product-card img {
                height: 140px;
            }
            
            .category-product-info {
                padding: 0.5rem;
            }
            
            .category-product-name {
                font-size: 0.85rem;
            }
            
            .category-product-price {
                font-size: 0.95rem;
            }
        }
        
        /* تأثيرات بصرية محسنة للنموذج */
        #product-request-form {
            transition: all 0.3s ease;
            will-change: transform, box-shadow;
        }
        
        #product-request-form:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }
        
        /* تحسين عرض رسائل الخطأ */
        .validation-error {
            font-size: 0.875rem;
            margin-top: 0.5rem;
            padding: 0.5rem;
            border-radius: 6px;
            background-color: #fef2f2;
            border: 1px solid #fecaca;
        }
        
        /* تحسين عرض رسائل النجاح */
        .success-notification {
            background-color: #f0fdf4;
            border: 1px solid #bbf7d0;
            color: #166534;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .cities-filter-container {
            position: relative;
            width: 100%;
            max-width: 400px;
            font-family: 'Tajawal', sans-serif;
        }

        .cities-header {
            position: relative;
        }

        .cities-trigger {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 48px;
        }

        .cities-trigger:hover {
            border-color: #d1d5db;
        }

        .cities-trigger.active {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .trigger-content {
            display: flex;
            align-items: center;
            gap: 8px;
            flex: 1;
        }

        .location-icon {
            width: 20px;
            height: 20px;
            color: #6b7280;
            flex-shrink: 0;
        }

        .trigger-text {
            color: #374151;
            font-weight: 500;
            flex: 1;
        }

        .selected-count {
            background: #3b82f6;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            min-width: 20px;
            text-align: center;
        }

        .chevron-icon {
            width: 16px;
            height: 16px;
            color: #6b7280;
            transition: transform 0.3s ease;
            flex-shrink: 0;
        }

        .cities-trigger.active .chevron-icon {
            transform: rotate(180deg);
        }

        .cities-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            margin-top: 4px;
            max-height: 400px;
            overflow: hidden;
            display: none;
        }

        .cities-dropdown.show {
            display: block;
        }

        .dropdown-header {
            padding: 16px;
            border-bottom: 1px solid #e5e7eb;
        }

        .search-container {
            position: relative;
            margin-bottom: 12px;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            color: #9ca3af;
        }

        .search-input {
            width: 100%;
            padding: 8px 12px 8px 36px;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s ease;
        }

        .search-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 6px 12px;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 12px;
            color: #374151;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }

        .cities-list {
            max-height: 250px;
            overflow-y: auto;
            padding: 8px 0;
        }

        .city-item {
            padding: 8px 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .city-item:hover {
            background-color: #f9fafb;
        }

        .city-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            width: 100%;
        }

        .city-input {
            width: 16px;
            height: 16px;
            accent-color: #3b82f6;
        }

        .city-name {
            color: #374151;
            font-size: 14px;
            flex: 1;
        }

        .dropdown-footer {
            padding: 12px 16px;
            border-top: 1px solid #e5e7eb;
            background: #f9fafb;
        }

        .apply-btn {
            width: 100%;
            padding: 10px 16px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .apply-btn:hover {
            background: #2563eb;
        }

        .selected-cities {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .selected-city-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: #dbeafe;
            color: #1e40af;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .remove-city {
            background: none;
            border: none;
            color: #1e40af;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            padding: 0;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }

        .remove-city:hover {
            background: rgba(30, 64, 175, 0.1);
        }

        /* Sortable Image Styles */
        .sortable-image {
            cursor: grab;
            transition: all 0.3s ease;
            position: relative;
        }

        .sortable-image:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .sortable-image.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
            z-index: 1000;
            cursor: grabbing;
        }

        .sortable-image.drag-over {
            border: 2px dashed #d4af37;
            background: rgba(212, 175, 55, 0.1);
        }

        .image-drag-handle {
            position: absolute;
            top: 0.5rem;
            left: 0.5rem;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: grab;
            transition: all 0.3s ease;
            z-index: 10;
        }

        .image-drag-handle:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.1);
        }

        .image-number {
            position: absolute;
            bottom: 0.5rem;
            left: 0.5rem;
            background: #d4af37;
            color: white;
            border-radius: 50%;
            width: 1.5rem;
            height: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            z-index: 10;
        }

        .image-sort-instructions {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.7;
            }
        }

        /* Simple Governorate Filter Styles */
        .simple-governorate-filter {
            position: relative;
            width: 100%;
        }

        .filter-dropdown {
            position: relative;
        }

        .dropdown-btn {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            color: #374151;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }

        .dropdown-btn:hover {
            border-color: #d4af37;
            background: #fefbf0;
        }
        
        .dropdown-btn:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        .dropdown-arrow {
            width: 16px;
            height: 16px;
            transition: transform 0.3s ease;
        }

        .dropdown-btn.active .dropdown-arrow {
            transform: rotate(180deg);
        }

        .dropdown-content {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            z-index: 1000;
            max-height: 300px;
            overflow-y: auto;
        }

        .governorate-options {
            padding: 8px;
        }

        .governorate-option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            cursor: pointer;
            border-radius: 6px;
            transition: background-color 0.2s ease;
        }

        .governorate-option:hover {
            background-color: #f3f4f6;
        }

        .governorate-checkbox {
            margin-left: 8px;
            width: 16px;
            height: 16px;
            accent-color: #d4af37;
        }

        .dropdown-actions {
            display: flex;
            gap: 8px;
            padding: 8px;
            border-top: 1px solid #e5e7eb;
        }

        .action-btn {
            flex: 1;
            padding: 6px 12px;
            border: 1px solid #d4af37;
            border-radius: 6px;
            background: white;
            color: #d4af37;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            background: #d4af37;
            color: white;
        }

        .selected-governorates {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .selected-governorate-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 6px 12px;
            background: #dbeafe;
            color: #1e40af;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .remove-governorate {
            background: none;
            border: none;
            color: #1e40af;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            padding: 0;
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }

        .remove-governorate:hover {
            background: rgba(30, 64, 175, 0.1);
        }

        /* Responsive Design */
        @media (max-width: 640px) {
            .cities-filter-container {
                max-width: 100%;
            }
            
            .cities-trigger {
                padding: 10px 12px;
                min-height: 44px;
            }
            
            .trigger-text {
                font-size: 14px;
            }
            
            .cities-dropdown {
                max-height: 300px;
            }
            
            .cities-list {
                max-height: 200px;
            }
        }
        
        /* Global Error Banner Styles */
        #global-error-banner {
            background-color: #dc2626;
            color: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            margin-bottom: 1.5rem;
            transition: all 0.3s ease-in-out;
        }
        
        #global-error-banner.show {
            opacity: 1;
            transform: scale(1);
        }
        
        #global-error-banner.hidden {
            opacity: 0;
            transform: scale(0.95);
            display: none;
        }
        
        #close-error-banner {
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px;
            border-radius: 6px;
            transition: all 0.2s ease;
        }
        
        #close-error-banner:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            #global-error-banner .container {
                padding-left: 16px;
                padding-right: 16px;
            }
            
            #global-error-banner h3 {
                font-size: 16px;
            }
            
            #global-error-banner p {
                font-size: 14px;
            }
        }
        

    </style>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1994970196400389"
     crossorigin="anonymous"></script>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-S09FN3CLNC"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);} 
      gtag('js', new Date());

      gtag('config', 'G-S09FN3CLNC');
    </script>
</head>
<body class="text-gray-700">
    <!-- Header -->
    <header class="sticky top-0 z-50 bg-white shadow-sm gold-border" style="display: block !important; visibility: visible !important; opacity: 1 !important;">
        <div class="container mx-auto px-4 py-2 flex items-center justify-between" style="display: flex !important;">
            <!-- Logo -->
            <div class="flex items-center mr-2">
                <span class="logo-text">زِينَة</span>
            </div>
            
            <!-- التصنيفات والروابط للشاشات الكبيرة -->
            <div class="hidden lg:flex items-center space-x-6 space-x-reverse">
                <a href="pages/category-koshat.html" class="text-gray-600 hover:text-yellow-600 transition-colors text-sm font-medium">كوشات</a>
                                        <a href="pages/category-cake.html" class="text-gray-600 hover:text-yellow-600 transition-colors text-sm font-medium">تورتات وأنواع الشوكولاتة</a>
                <a href="pages/category-mirr.html" class="text-gray-600 hover:text-yellow-600 transition-colors text-sm font-medium">مرايا</a>
                <a href="pages/category-other.html" class="text-gray-600 hover:text-yellow-600 transition-colors text-sm font-medium">ديكورات متنوعة</a>
                <a href="pages/category-invitations.html" class="text-gray-600 hover:text-yellow-600 transition-colors text-sm font-medium">دعوات وتوزيعات</a>
                <span class="text-gray-300">|</span>
                <a href="pages/about-us.html" class="text-gray-600 hover:text-yellow-600 transition-colors text-sm font-medium">من نحن</a>
                <a href="pages/contact-us.html" class="text-gray-600 hover:text-yellow-600 transition-colors text-sm font-medium">اتصل بنا</a>
            </div>
            
                            <!-- Desktop Action Buttons -->
                <div class="hidden lg:flex items-center space-x-3 space-x-reverse">
                    <!-- Desktop Favorites Button -->
                    <a href="pages/favorites.html" class="text-pink-500 hover:text-pink-600 transition-colors flex items-center space-x-2 space-x-reverse relative">
                        <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                        <span id="favorites-count-badge-desktop" class="absolute -top-2 -right-2 bg-yellow-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold hidden">0</span>
                    </a>
                    
                                    <!-- Desktop Advertise Button -->
                <a href="pages/advertise-with-us.html" class="header-cta text-white text-xs px-3 py-2 rounded-lg font-semibold transform hover:scale-105 transition-all duration-200">
                    <span class="flex items-center space-x-1 space-x-reverse">
                        <span>⭐</span>
                        <span>أضف إعلانك</span>
                    </span>
                </a>
                    
                    <!-- Desktop Add Product Request Button -->
                    <a href="pages/add-product-request.html" class="header-cta text-white text-xs px-3 py-2 rounded-lg font-semibold transform hover:scale-105 transition-all duration-200" id="add-product-request-btn">
                        <span class="flex items-center space-x-1 space-x-reverse">
                            <span>➕</span>
                            <span>أضف منتجك</span>
                        </span>
                    </a>
                
                <!-- Desktop Admin Dashboard Button (Hidden by default) -->
                <a href="admin/admin-dashboard.html" class="header-cta text-white text-xs px-3 py-2 rounded-lg font-semibold transform hover:scale-105 transition-all duration-200 hidden" id="admin-dashboard-btn-desktop">
                    <span class="flex items-center space-x-1 space-x-reverse">
                        <span>⚙️</span>
                        <span>لوحة الأدمن</span>
                    </span>
                </a>
            </div>
            
            <!-- تم إزالة Desktop Auth Buttons -->
            
            <!-- Mobile Menu Button -->
            <div class="lg:hidden flex items-center space-x-2 space-x-reverse">
                <!-- Mobile Favorites Button -->
                <a href="pages/favorites.html" class="text-pink-500 hover:text-pink-600 transition-colors flex items-center space-x-2 space-x-reverse relative">
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                    </svg>
                    <span id="favorites-count-badge-mobile" class="absolute -top-2 -right-2 bg-yellow-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-bold hidden">0</span>
                </a>
                

                
                <!-- Mobile Advertise Button -->
                <a href="pages/advertise-with-us.html" class="header-cta text-white text-xs px-2 py-2 rounded-lg font-semibold transform hover:scale-105 transition-all duration-200 text-center">
                    <span class="flex items-center justify-center space-x-1 space-x-reverse">
                        <span>⭐</span>
                        <span>أضف إعلانك</span>
                    </span>
                </a>
                
                <!-- Mobile Add Product Request Button -->
                <a href="pages/add-product-request.html" class="header-cta text-white text-xs px-2 py-2 rounded-lg font-semibold transform hover:scale-105 transition-all duration-200 text-center">
                    <span class="flex items-center justify-center space-x-1 space-x-reverse">
                        <span>➕</span>
                        <span>أضف منتجك</span>
                    </span>
                </a>
                
                <!-- Mobile Admin Dashboard Button (Hidden by default) -->
                <a href="admin/admin-dashboard.html" class="header-cta text-white text-xs px-2 py-2 rounded-lg font-semibold transform hover:scale-105 transition-all duration-200 text-center hidden" id="admin-dashboard-btn-mobile">
                    <span class="flex items-center justify-center space-x-1 space-x-reverse">
                        <span>⚙️</span>
                        <span>لوحة الأدمن</span>
                    </span>
                </a>
                
                <!-- Mobile Menu Button -->
                <button id="mobile-menu-btn" class="p-2 text-gray-600 hover:text-yellow-600">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="lg:hidden hidden bg-white border-t border-gray-200">
            <div class="px-4 py-2 space-y-2 max-h-[80vh] overflow-y-auto scrollbar-hide" style="-webkit-overflow-scrolling: touch; overscroll-behavior: contain;">
                <!-- التصنيفات -->
                <div class="border-b border-gray-200 pb-3">
                    <h3 class="text-sm font-semibold text-gray-700 mb-2">التصنيفات</h3>
                    <div class="space-y-2">
                        <a href="pages/category-koshat.html" class="block py-2 px-3 text-gray-600 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 text-sm">كوشات</a>
                        <a href="pages/category-cake.html" class="block py-2 px-3 text-gray-600 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 text-sm">تورتات وأنواع الشوكولاتة</a>
                        <a href="pages/category-mirr.html" class="block py-2 px-3 text-gray-600 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 text-sm">مرايا</a>
                        <a href="pages/category-other.html" class="block py-2 px-3 text-gray-600 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 text-sm">ديكورات متنوعة</a>
                        <a href="pages/category-invitations.html" class="block py-2 px-3 text-gray-600 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 text-sm">دعوات وتوزيعات</a>
                    </div>
                </div>
                
                <!-- روابط مهمة -->
                <div class="border-b border-gray-200 pb-3">
                    <h3 class="text-sm font-semibold text-gray-700 mb-2">روابط مهمة</h3>
                    <div class="space-y-2">
                        <a href="pages/about-us.html" class="block py-2 px-3 text-gray-600 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 text-sm">من نحن</a>
                        <a href="pages/contact-us.html" class="block py-2 px-3 text-gray-600 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 text-sm">اتصل بنا</a>
                        <a href="pages/faq.html" class="block py-2 px-3 text-gray-600 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 text-sm">الأسئلة الشائعة</a>
                    </div>
                </div>
                
                <!-- تواصل معنا -->
                <div class="border-b border-gray-200 pb-3">
                    <h3 class="text-sm font-semibold text-gray-700 mb-2">تواصل معنا</h3>
                    
                    <!-- التواصل الاجتماعي -->
                    <div class="mb-3">
                        <h4 class="text-xs font-medium text-gray-500 mb-2">التواصل الاجتماعي</h4>
                        <div class="space-y-2">
                            <a href="https://www.facebook.com/share/1BCEhAV89y/?mibextid=wwXIfr" target="_blank" class="block py-2 px-3 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 text-sm flex items-center">
                                <span class="mr-2">📘</span>
                                فيسبوك
                            </a>
                            <a href="https://www.instagram.com/zeina.eg_?igsh=MXg4bzNqd213Z3IyaQ==" target="_blank" class="block py-2 px-3 text-gray-600 hover:text-pink-600 hover:bg-pink-50 rounded-lg transition-all duration-200 text-sm flex items-center">
                                <span class="mr-2">📷</span>
                                إنستغرام
                            </a>
                            <a href="https://wa.me/201016436007" target="_blank" class="block py-2 px-3 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-lg transition-all duration-200 text-sm flex items-center">
                                <span class="mr-2">📱</span>
                                واتساب
                            </a>
                        </div>
                    </div>
                    
                    <!-- التواصل المباشر -->
                    <div>
                        <h4 class="text-xs font-medium text-gray-500 mb-2">التواصل المباشر</h4>
                        <div class="space-y-2">
                            <a href="tel:+201016436007" class="block py-2 px-3 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all duration-200 text-sm flex items-center">
                                <span class="mr-2">📞</span>
                                اتصل بنا: 01016436007
                            </a>
                            <a href="pages/contact-us.html" class="block py-2 px-3 text-gray-600 hover:text-yellow-600 hover:bg-yellow-50 rounded-lg transition-all duration-200 text-sm flex items-center">
                                <span class="mr-2">📧</span>
                                راسلنا
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- إضافة منتج في القائمة المتحركة -->
                <div class="border-b border-gray-200 pb-3">
                    <h3 class="text-sm font-semibold text-gray-700 mb-2">إضافة منتج</h3>
                    <div class="space-y-2">
                        <a href="pages/add-product-request.html" class="block py-2 px-3 text-gray-600 hover:text-green-600 hover:bg-green-50 rounded-lg transition-all duration-200 text-sm flex items-center">
                            <span class="mr-2">➕</span>
                            أضف منتجك
                        </a>
                    </div>
                </div>
                
                <!-- لوحة الأدمن في القائمة المتحركة (مخفي افتراضياً) -->
                <div class="border-b border-gray-200 pb-3 hidden" id="admin-menu-mobile">
                    <h3 class="text-sm font-semibold text-gray-700 mb-2">لوحة الإدارة</h3>
                    <div class="space-y-2">
                        <a href="admin/admin-dashboard.html" class="block py-2 px-3 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all duration-200 text-sm flex items-center">
                            <span class="mr-2">⚙️</span>
                            لوحة الأدمن
                        </a>
                    </div>
                </div>
                
                <!-- Mobile Auth Buttons -->
                <div class="auth-buttons-mobile border-t border-gray-200 pt-2 mt-2">
                    <!-- Auth buttons will be dynamically updated -->
                </div>
            </div>
        </div>
    </header>

    <!-- Global Error Banner - Will be moved to below the form -->

    <!-- Hero Section -->
    <div class="relative overflow-hidden">
        <div id="hero-carousel" class="hero-image transition-all duration-700 ease-in-out flex items-center justify-center" style="background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 100%);">
            <!-- Carousel content will be dynamically loaded -->
        </div>
        
        <!-- Carousel Indicators -->
        <div id="carousel-indicators" class="absolute bottom-4 left-0 right-0 flex justify-center space-x-2 space-x-reverse">
            <!-- Indicators will be dynamically generated -->
        </div>
    </div>







    <!-- Browse Categories -->
    <section class="container mx-auto px-4 py-8 md:py-12">
        <h2 class="text-xl sm:text-2xl md:text-3xl font-bold mb-6 md:mb-8 text-center gold-text">تصفح التصنيفات</h2>
        
        <div class="grid grid-cols-2 md:grid-cols-3 gap-2 md:gap-4 lg:gap-6">
            <!-- Koshat Category -->
                            <a href="pages/category-koshat.html" class="group">
                <div class="relative overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                    <img src="assets/images/koshat.jpg" 
                         alt="كوشات" 
                         class="w-full h-40 md:h-48 lg:h-80 object-cover object-center group-hover:scale-110 transition-transform duration-300" loading="lazy">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 left-0 right-0 p-2 md:p-3 lg:p-6 text-white">
                        <h3 class="text-base md:text-lg lg:text-xl font-bold mb-1 md:mb-2">كوشات</h3>
                        <p class="text-xs md:text-sm opacity-90">تصاميم فريدة لحفلاتكم</p>
                    </div>
                </div>
            </a>

            <!-- Cake Category -->
                            <a href="pages/category-cake.html" class="group">
                <div class="relative overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                    <img src="assets/images/cake.jpg" 
                         alt="تورتة" 
                         class="w-full h-40 md:h-48 lg:h-80 object-cover object-center group-hover:scale-110 transition-transform duration-300" loading="lazy">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 left-0 right-0 p-2 md:p-3 lg:p-6 text-white">
                        <h3 class="text-base md:text-lg lg:text-xl font-bold mb-1 md:mb-2">تورتات وأنواع الشوكولاتة</h3>
                        <p class="text-xs md:text-sm opacity-90">تورتات وأنواع الشوكولاتة مخصصة ومميزة</p>
                    </div>
                </div>
            </a>

            <!-- Mirror Category -->
                            <a href="pages/category-mirr.html" class="group">
                <div class="relative overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                                          <img src="assets/images/sarah-penney-1yk6cjyije8-unsplash.jpg"  
                         alt="مرايا ذهبية مزخرفة" 
                         class="w-full h-40 md:h-48 lg:h-80 object-cover object-center group-hover:scale-110 transition-transform duration-300" loading="lazy">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 left-0 right-0 p-2 md:p-3 lg:p-6 text-white">
                        <h3 class="text-base md:text-lg lg:text-xl font-bold mb-1 md:mb-2">مرايا</h3>
                        <p class="text-xs md:text-sm opacity-90">مرايا مزخرفة وأنيقة</p>
                    </div>
                </div>
            </a>

            <!-- Other Category -->
                            <a href="pages/category-other.html" class="group">
                <div class="relative overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                    <img src="assets/images/decorations.jpg" 
                         alt="ديكورات متنوعة" 
                         class="w-full h-40 md:h-48 lg:h-80 object-cover object-center group-hover:scale-110 transition-transform duration-300" loading="lazy">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 left-0 right-0 p-2 md:p-3 lg:p-6 text-white">
                        <h3 class="text-base md:text-lg lg:text-xl font-bold mb-1 md:mb-2">ديكورات متنوعة</h3>
                        <p class="text-xs md:text-sm opacity-90 mb-1 md:mb-2">منتجات متنوعة ومميزة</p>
                        <div class="text-xs opacity-80 space-y-0.5 md:space-y-1">
                            <div>🎈 ديكور عيد ميلاد</div>
                            <div>🏥 ديكور استقبال مستشفى</div>
                            <div>👰 ديكور استقبال عروسة</div>
                            <div>🎉 ديكور حفلات بسيطة</div>
                        </div>
                    </div>
                </div>
            </a>

            <!-- Invitations Category -->
            <a href="pages/category-invitations.html" class="group">
                <div class="relative overflow-hidden rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-2">
                    <img src="assets/images/f.jpg" 
                         alt="دعوات الأفراح والخطوبة" 
                         class="w-full h-40 md:h-48 lg:h-80 object-cover object-center group-hover:scale-110 transition-transform duration-300" loading="lazy">
                    <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent"></div>
                    <div class="absolute bottom-0 left-0 right-0 p-2 md:p-3 lg:p-6 text-white">
                                                    <h3 class="text-base md:text-lg lg:text-xl font-bold mb-1 md:mb-2">دعوات وتوزيعات</h3>
                        <p class="text-xs md:text-sm opacity-90 mb-1 md:mb-2">دعوات وتوزيعات</p>
                        <div class="text-xs opacity-80 space-y-0.5 md:space-y-1">
                            <div>💒 دعوة زفاف</div>
                            <div>💍 دعوة خطوبة</div>
                            <div>🍫 توزيعات بالشوكولاتة</div>
                            <div>🌸 توزيعات بالبرفان</div>
                        </div>
                    </div>
                </div>
            </a>
        </div>
    </section>

    <!-- Featured Products -->
    <section id="featured-products" class="container mx-auto px-4 py-8 md:py-12">
        <div class="bg-white rounded-xl shadow-lg border border-gray-100 p-8 mb-8" id="featured-section">
            <div class="flex items-center justify-between mb-6 md:mb-8">
                <div class="text-right">
                    <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-2 md:mb-3 text-gray-800">منتجات مميزة</h3>
                    <p class="text-gray-600 text-sm md:text-lg">أفضل المنتجات المختارة لكم</p>
                </div>
            </div>
        
            <!-- Loading Indicator -->
            <div id="products-loading" class="text-center py-8">
                <div class="inline-flex items-center space-x-2 space-x-reverse">
                    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"></div>
                    <span class="text-gray-600">جاري تحميل المنتجات المميزة...</span>
                </div>
            </div>
            
            <!-- Search Results Count -->
            <div id="search-results-count" class="text-center mb-4 text-gray-600"></div>
            
            <!-- Products Grid 3x3 -->
            <div id="featured-products-grid" class="hidden">
                <!-- Products will be loaded dynamically -->
            </div>
            
            <!-- No Products Message -->
            <div id="no-products-message" class="text-center py-8 hidden">
                <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                    </svg>
                </div>
                <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد منتجات متاحة</h3>
                <p class="text-gray-500">لم يتم العثور على منتجات في هذه الفئة حالياً</p>
            </div>
        </div>





        <!-- Categories Products Section -->
        <div class="mt-12 md:mt-16">
            <div class="text-center mb-8 md:mb-12">
                <h2 class="text-xl sm:text-2xl md:text-3xl font-bold mb-3 md:mb-4 gold-text">تصفح المنتجات حسب التصنيف</h2>
                <p class="text-gray-600 max-w-2xl mx-auto text-sm md:text-base">
                    اكتشف أحدث المنتجات في كل تصنيف
                </p>
            </div>
            
                        <!-- Koshat Category -->
            <div class="bg-white rounded-xl shadow-lg border border-gray-100 p-8 mb-8" id="koshat-section">
                <div class="flex items-center justify-between mb-6 md:mb-8">
                    <div class="text-right">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-2 md:mb-3 text-gray-800">كوشات</h3>
                        <p class="text-gray-600 text-sm md:text-lg">تصاميم فريدة لحفلاتكم</p>
                    </div>
                    <a href="pages/category-koshat.html" class="inline-flex items-center px-3 md:px-4 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 text-white text-sm md:text-base font-semibold rounded-lg hover:from-yellow-600 hover:to-yellow-700 transform hover:scale-105 transition-all duration-200">
                        <span>عرض المزيد</span>
                        <svg class="w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </a>
                </div>
            
                <!-- Loading state -->
                <div id="koshat-loading" class="text-center py-8">
                    <div class="inline-flex items-center space-x-2 space-x-reverse">
                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"></div>
                        <span class="text-gray-600">جاري تحميل منتجات الكوشات...</span>
                    </div>
                </div>
                
                <!-- Products Grid 3x3 -->
                <div id="koshat-products-grid" class="grid grid-cols-3 gap-4 md:gap-6 hidden">
                    <!-- Products will be loaded dynamically -->
                </div>
                
                                <!-- No products message -->
                <div id="koshat-no-products" class="text-center py-8 hidden">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد منتجات في هذا التصنيف</h3>
                    <p class="text-gray-500">سنقوم بإضافة منتجات جديدة قريباً</p>
                </div>
                

            </div>
            
            <!-- Cake Category -->
            <div class="bg-white rounded-xl shadow-lg border border-gray-100 p-8 mb-8" id="cake-section">
                <div class="flex items-center justify-between mb-6 md:mb-8">
                    <div class="text-right">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-2 md:mb-3 text-gray-800">تورتات وشكولاتات</h3>
                        <p class="text-gray-600 text-sm md:text-lg">تورتات وشوكولاتات مخصصة</p>
                    </div>
                    <a href="pages/category-cake.html" class="inline-flex items-center px-3 md:px-4 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 text-white text-sm md:text-base font-semibold rounded-lg hover:from-yellow-600 hover:to-yellow-700 transform hover:scale-105 transition-all duration-200">
                        <span>عرض المزيد</span>
                        <svg class="w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </a>
                </div>
                
                <!-- Loading state -->
                <div id="cake-loading" class="text-center py-8">
                    <div class="inline-flex items-center space-x-2 space-x-reverse">
                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"></div>
                        <span class="text-gray-600">جاري تحميل منتجات التورتات...</span>
                    </div>
                </div>
                
                <!-- Products Grid 3x3 -->
                <div id="cake-products-grid" class="grid grid-cols-3 gap-4 md:gap-6 hidden">
                    <!-- Products will be loaded dynamically -->
                </div>
                
                <!-- No products message -->
                <div id="cake-no-products" class="text-center py-8 hidden">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد منتجات في هذا التصنيف</h3>
                    <p class="text-gray-500">سنقوم بإضافة منتجات جديدة قريباً</p>
                </div>
                

            </div>
            
            <!-- Mirror Category -->
            <div class="bg-white rounded-xl shadow-lg border border-gray-100 p-8 mb-8" id="mirror-section">
                <div class="flex items-center justify-between mb-6 md:mb-8">
                    <div class="text-right">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-2 md:mb-3 text-gray-800">مرايا</h3>
                        <p class="text-gray-600 text-sm md:text-lg">مرايا مزخرفة وأنيقة</p>
                    </div>
                    <a href="pages/category-mirr.html" class="inline-flex items-center px-3 md:px-4 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 text-white text-sm md:text-base font-semibold rounded-lg hover:from-yellow-600 hover:to-yellow-700 transform hover:scale-105 transition-all duration-200">
                        <span>عرض المزيد</span>
                        <svg class="w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </a>
                </div>
                
                <!-- Loading state -->
                <div id="mirror-loading" class="text-center py-8">
                    <div class="inline-flex items-center space-x-2 space-x-reverse">
                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"></div>
                        <span class="text-gray-600">جاري تحميل منتجات المرايا...</span>
                    </div>
                </div>
                
                <!-- Products Grid 3x3 -->
                <div id="mirror-products-grid" class="grid grid-cols-3 gap-4 md:gap-6 hidden">
                    <!-- Products will be loaded dynamically -->
                </div>
                
                <!-- No products message -->
                <div id="mirror-no-products" class="text-center py-8 hidden">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد منتجات في هذا التصنيف</h3>
                    <p class="text-gray-500">سنقوم بإضافة منتجات جديدة قريباً</p>
                </div>
                

            </div>
            
            <!-- Other Category -->
            <div class="bg-white rounded-xl shadow-lg border border-gray-100 p-8 mb-8" id="other-section">
                <div class="flex items-center justify-between mb-6 md:mb-8">
                    <div class="text-right">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-2 md:mb-3 text-gray-800">ديكورات متنوعة</h3>
                        <p class="text-gray-600 text-sm md:text-lg">منتجات متنوعة ومميزة</p>
                    </div>
                    <a href="pages/category-other.html" class="inline-flex items-center px-3 md:px-4 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 text-white text-sm md:text-base font-semibold rounded-lg hover:from-yellow-600 hover:to-yellow-700 transform hover:scale-105 transition-all duration-200">
                        <span>عرض المزيد</span>
                        <svg class="w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </a>
                </div>
                
                <!-- Loading state -->
                <div id="other-loading" class="text-center py-8">
                    <div class="inline-flex items-center space-x-2 space-x-reverse">
                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"></div>
                        <span class="text-gray-600">جاري تحميل منتجات الديكورات...</span>
                    </div>
                </div>
                
                <!-- Products Grid 3x3 -->
                <div id="other-products-grid" class="grid grid-cols-3 gap-4 md:gap-6 hidden">
                    <!-- Products will be loaded dynamically -->
                </div>
                
                <!-- No products message -->
                <div id="other-no-products" class="text-center py-8 hidden">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد منتجات في هذا التصنيف</h3>
                    <p class="text-gray-500">سنقوم بإضافة منتجات جديدة قريباً</p>
                </div>
                

            </div>
            
            <!-- Invitations Category -->
            <div class="bg-white rounded-xl shadow-lg border border-gray-100 p-8 mb-8" id="invitations-section">
                <div class="flex items-center justify-between mb-6 md:mb-8">
                    <div class="text-right">
                        <h3 class="text-lg sm:text-xl md:text-2xl font-bold mb-2 md:mb-3 text-gray-800">دعوات وتوزيعات</h3>
                        <p class="text-gray-600 text-sm md:text-lg">دعوات وتوزيعات مميزة</p>
                    </div>
                    <a href="pages/category-invitations.html" class="inline-flex items-center px-3 md:px-4 py-2 bg-gradient-to-r from-yellow-500 to-yellow-600 text-white text-sm md:text-base font-semibold rounded-lg hover:from-yellow-600 hover:to-yellow-700 transform hover:scale-105 transition-all duration-200">
                        <span>عرض المزيد</span>
                        <svg class="w-3 h-3 md:w-4 md:h-4 mr-1 md:mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </a>
                </div>
                
                <!-- Loading state -->
                <div id="invitations-loading" class="text-center py-8">
                    <div class="inline-flex items-center space-x-2 space-x-reverse">
                        <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-yellow-600"></div>
                        <span class="text-gray-600">جاري تحميل منتجات الدعوات...</span>
                    </div>
                </div>
                
                <!-- Products Grid 3x3 -->
                <div id="invitations-products-grid" class="grid grid-cols-3 gap-4 md:gap-6 hidden">
                    <!-- Products will be loaded dynamically -->
                </div>
                
                <!-- No products message -->
                <div id="invitations-no-products" class="text-center py-8 hidden">
                    <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4" />
                        </svg>
                    </div>
                    <h3 class="text-lg font-bold text-gray-700 mb-2">لا توجد منتجات في هذا التصنيف</h3>
                    <p class="text-gray-500">سنقوم بإضافة منتجات جديدة قريباً</p>
                </div>
                

            </div>
        </div>
    </section>

    <!-- Advertise Section -->
    <section class="bg-gradient-to-r from-yellow-50 to-pink-50 py-12 md:py-16">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto text-center">
                <h2 class="text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold text-gray-800 mb-4 md:mb-6">أضف إعلانك وزد من مبيعاتك</h2>
                <p class="text-base md:text-xl text-gray-600 mb-6 md:mb-8">
                    هل تريد أن تظهر منتجاتك في أماكن بارزة؟ احصل على الإعلانات المميزة ووصل لعملاء جدد
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <div class="w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                            </svg>
                        </div>
                        <h3 class="font-bold text-lg mb-2">ظهور مميز</h3>
                        <p class="text-gray-600">في الصفحة الرئيسية وصفحات التصنيفات</p>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <div class="w-12 h-12 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-6 h-6 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                            </svg>
                        </div>
                        <h3 class="font-bold text-lg mb-2">جمهور أكبر</h3>
                        <p class="text-gray-600">وصل لعملاء جدد ومهتمين</p>
                    </div>
                    
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <h3 class="font-bold text-lg mb-2">نتائج مضمونة</h3>
                        <p class="text-gray-600">زيادة في المبيعات بنسبة تصل إلى 300%</p>
                    </div>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <a href="pages/advertise-with-us.html#contact" class="bg-gradient-to-r from-yellow-500 to-yellow-600 text-white px-6 md:px-8 py-3 md:py-4 rounded-lg text-base md:text-lg font-semibold hover:from-yellow-600 hover:to-yellow-700 transform hover:scale-105 transition-all duration-200">
                        ابدأ في الإعلان الآن
                    </a>
                    <a href="pages/advertise-with-us.html#features" class="bg-white text-gray-700 px-6 md:px-8 py-3 md:py-4 rounded-lg text-base md:text-lg font-semibold border-2 border-gray-200 hover:border-yellow-500 transition-colors">
                        تعرف على المميزات
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section class="bg-white py-8 md:py-12">
        <div class="container mx-auto px-4">
            <div class="text-center mb-6 md:mb-8">
                <h2 class="text-xl sm:text-2xl md:text-3xl font-bold mb-3 md:mb-4 gold-text">عن زِينَة</h2>
                <p class="text-gray-600 max-w-2xl mx-auto text-sm md:text-base">
                    زِينَة هي وجهتك الأولى لجميع احتياجات حفلات الخطوبة. نقدم مجموعة متنوعة من الكوشات والحلويات والمشروبات بأعلى جودة وأفضل الأسعار.
                </p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center">
                    <div class="w-16 h-16 bg-pink-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-pink-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </div>
                    <h3 class="font-bold text-lg mb-2">جودة عالية</h3>
                    <p class="text-gray-600">نختار أفضل المواد وأجودها لضمان رضاك التام</p>
                </div>
                
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <h3 class="font-bold text-lg mb-2">توصيل سريع</h3>
                    <p class="text-gray-600">نضمن وصول طلبك في الوقت المحدد وبأفضل حالة</p>
                </div>
                
                <div class="text-center">
                    <div class="w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-yellow-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                        </svg>
                    </div>
                    <h3 class="font-bold text-lg mb-2">خدمة متميزة</h3>
                    <p class="text-gray-600">فريق خدمة العملاء متاح دائماً لمساعدتك</p>
                </div>
            </div>
        </div>
    </section>












    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="font-bold text-lg mb-4">زِينَة</h3>
                    <p class="text-gray-300">وجهتك الأولى لجميع احتياجات حفلات الخطوبة</p>
                </div>
                
                <div>
                    <h4 class="font-bold mb-4">روابط سريعة</h4>
                    <ul class="space-y-2">
                        <li><a href="index.html" class="text-gray-300 hover:text-white">الرئيسية</a></li>
                        <li><a href="pages/about-us.html" class="text-gray-300 hover:text-white">من نحن</a></li>
                        <li><a href="pages/contact-us.html" class="text-gray-300 hover:text-white">اتصل بنا</a></li>
                        <li><a href="pages/advertise-with-us.html" class="text-yellow-400 hover:text-yellow-300 font-medium">⭐ أضف إعلانك</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-bold mb-4">الفئات</h4>
                    <ul class="space-y-2">
                        <li><a href="pages/category-koshat.html" class="text-gray-300 hover:text-white">كوشات</a></li>
                        <li><a href="pages/category-mirr.html" class="text-gray-300 hover:text-white">مرايا</a></li>
                        <li><a href="pages/category-cake.html" class="text-gray-300 hover:text-white">تورتات وأنواع الشوكولاتة</a></li>
                        <li><a href="pages/category-other.html" class="text-gray-300 hover:text-white">ديكورات متنوعة</a></li>
                        <li><a href="pages/category-invitations.html" class="text-gray-300 hover:text-white">دعوات وتوزيعات</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-bold mb-4">السياسات</h4>
                    <ul class="space-y-2">
                        <li><a href="legal/privacy-policy.html" class="text-gray-300 hover:text-white">سياسة الخصوصية</a></li>
                        <li><a href="legal/terms-of-use.html" class="text-gray-300 hover:text-white">شروط الاستخدام</a></li>
                        <li><a href="legal/cookies-policy.html" class="text-gray-300 hover:text-white">سياسة الكوكيز</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-bold mb-4">تواصل معنا</h4>
                    <div class="space-y-2">
                        <p class="text-gray-300">📞 الهاتف: <a href="tel:+201016436007" class="hover:text-white">01016436007</a></p>
                        <p class="text-gray-300">📧 البريد الإلكتروني: amrreda1945@outlook.sa</p>
                        <div class="flex space-x-4 space-x-reverse mt-4">
                            <!-- Facebook -->
                            <a href="https://www.facebook.com/share/1BCEhAV89y/?mibextid=wwXIfr" target="_blank" class="text-gray-300 hover:text-blue-400 transition-colors" title="تابعنا على فيسبوك">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                                </svg>
                            </a>
                            <!-- Instagram -->
                            <a href="https://www.instagram.com/zeina.eg_?igsh=MXg4bzNqd213Z3IyaQ==" target="_blank" class="text-gray-300 hover:text-pink-400 transition-colors" title="تابعنا على إنستغرام">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.174-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.402.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.357-.629-2.746-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24.009 12.017 24.009c6.624 0 11.99-5.367 11.99-11.988C24.007 5.367 18.641.001 12.017.001z"/>
                                </svg>
                            </a>
                            <!-- WhatsApp -->
                            <a href="https://wa.me/201016436007" target="_blank" class="text-gray-300 hover:text-green-400 transition-colors" title="تواصل معنا عبر واتساب">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893A11.821 11.821 0 0020.885 3.488"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-8 pt-8 text-center">
                <p class="text-gray-300">&copy; 2024 زِينَة. جميع الحقوق محفوظة.</p>
            </div>
        </div>
    </footer>

    <!-- Custom Sign Out Confirmation Modal -->
    <div id="signout-confirm-modal" class="custom-modal-overlay">
        <div class="custom-modal-content">
            <div class="custom-modal-icon warning">
                ⚠️
            </div>
            <h3 class="custom-modal-title">تأكيد تسجيل الخروج</h3>
            <p class="custom-modal-message">هل أنت متأكد من تسجيل الخروج؟ سيتم إغلاق جلستك الحالية.</p>
            <div class="custom-modal-buttons">
                <button class="custom-modal-btn cancel" onclick="closeSignOutModal()">إلغاء</button>
                <button class="custom-modal-btn confirm" onclick="proceedSignOut()">تأكيد الخروج</button>
            </div>
        </div>
    </div>

    <!-- Custom Success Modal -->
    <div id="signout-success-modal" class="custom-modal-overlay">
        <div class="custom-modal-content">
            <div class="custom-modal-icon success">
                ✅
            </div>
            <h3 class="custom-modal-title">تم تسجيل الخروج بنجاح</h3>
            <p class="custom-modal-message">سيتم توجيهك للصفحة الرئيسية...</p>
            <div class="custom-modal-buttons">
                <button class="custom-modal-btn success" onclick="redirectToHome()">حسناً</button>
            </div>
        </div>
    </div>



            <script>
            // Global variables
            let allProducts = [];
            let currentFilter = 'all';
            
            // UI Helper for managing navigation and UI updates
            const UIHelper = {
                // Update navigation based on user authentication and admin status
                async updateNavigation() {
                    try {
                        // Wait for AuthService to be available
                        if (!window.AuthService) {
                            console.log('⏳ Waiting for AuthService to load...');
                            await new Promise((resolve) => {
                                const checkInterval = setInterval(() => {
                                    if (window.AuthService) {
                                        clearInterval(checkInterval);
                                        console.log('✅ AuthService loaded');
                                        resolve();
                                    }
                                }, 100);
                                
                                setTimeout(() => {
                                    clearInterval(checkInterval);
                                    console.error('❌ AuthService not loaded after 5 seconds');
                                    resolve();
                                }, 5000);
                            });
                        }
                        
                        if (!window.AuthService) {
                            console.error('❌ AuthService not available');
                            return;
                        }
                        
                        const isLoggedIn = await window.AuthService.isLoggedIn();
                        const user = await window.AuthService.getCurrentUser();
                        
                        // Check if user is admin
                        let isAdmin = false;
                        if (isLoggedIn && user) {
                            try {
                                // Check user role from database
                                const { data: userProfile, error } = await window.supabaseClient
                                    .from('users')
                                    .select('role')
                                    .eq('id', user.id)
                                    .single();
                                
                                if (!error && userProfile) {
                                    isAdmin = userProfile.role === 'admin';
                                }
                            } catch (error) {
                                console.error('Error checking admin status:', error);
                            }
                        }
                        
                        // Update desktop navigation - Show admin dashboard button in header
                        const adminDashboardBtnDesktop = document.getElementById('admin-dashboard-btn-desktop');
                        if (adminDashboardBtnDesktop) {
                            if (isAdmin) {
                                adminDashboardBtnDesktop.classList.remove('hidden');
                                console.log('✅ Admin dashboard button shown in desktop header');
                            } else {
                                adminDashboardBtnDesktop.classList.add('hidden');
                            }
                        }
                        
                        // Update mobile navigation - Show admin dashboard button in header
                        const adminDashboardBtnMobile = document.getElementById('admin-dashboard-btn-mobile');
                        if (adminDashboardBtnMobile) {
                            if (isAdmin) {
                                adminDashboardBtnMobile.classList.remove('hidden');
                                console.log('✅ Admin dashboard button shown in mobile header');
                            } else {
                                adminDashboardBtnMobile.classList.add('hidden');
                            }
                        }
                        
                        // Update mobile menu - Show admin section
                        const adminMenuMobile = document.getElementById('admin-menu-mobile');
                        if (adminMenuMobile) {
                            if (isAdmin) {
                                adminMenuMobile.classList.remove('hidden');
                                console.log('✅ Admin menu shown in mobile menu');
                            } else {
                                adminMenuMobile.classList.add('hidden');
                            }
                        }
                        
                        // Mobile navigation is now handled by the buttons in header
                        
                        console.log('✅ Navigation updated successfully');
                    } catch (error) {
                        console.error('❌ Error updating navigation:', error);
                    }
                },
                
                // Show success message
                showSuccess(message) {
                    console.log('✅ Success:', message);
                    
                    // Create success notification
                    const successDiv = document.createElement('div');
                    successDiv.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
                    successDiv.innerHTML = `
                        <div class="flex items-center gap-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                            ${message}
                        </div>
                    `;
                    document.body.appendChild(successDiv);
                    
                    // Remove after 3 seconds
                    setTimeout(() => {
                        successDiv.remove();
                    }, 3000);
                }
            };
            

        

            
            // Confirm sign out function
            function confirmSignOut() {
                document.getElementById('signout-confirm-modal').classList.add('active');
            }
            
            // Close sign out confirmation modal
            function closeSignOutModal() {
                document.getElementById('signout-confirm-modal').classList.remove('active');
            }
            
            // Proceed with sign out
            async function proceedSignOut() {
                closeSignOutModal();
                await handleSignOut();
            }
            
            // Show success modal and redirect
            function showSignOutSuccess() {
                document.getElementById('signout-success-modal').classList.add('active');
            }
            
            // Redirect to home page
            function redirectToHome() {
                window.location.href = 'index.html';
            }
            
            // Global sign out function
            async function handleSignOut() {
                try {
                    // Wait for AuthService to be available
                    if (!window.AuthService) {
                        console.error('❌ AuthService not available');
                        alert('خطأ في تحميل خدمة المصادقة');
                        return;
                    }
                    
                    const result = await window.AuthService.signOut();
                    if (result.success) {
                        showSignOutSuccess();
                        // Redirect after 2 seconds
                        setTimeout(() => {
                            redirectToHome();
                        }, 2000);
                    } else {
                        alert('حدث خطأ أثناء تسجيل الخروج: ' + (result.error || 'خطأ غير معروف'));
                    }
                } catch (error) {
                    console.error('Sign out error:', error);
                    alert('حدث خطأ أثناء تسجيل الخروج: ' + error.message);
                }
            }
            
        // Update favorites count badge
        function updateFavoritesCountBadge() {
            const favorites = JSON.parse(localStorage.getItem('favorites') || '[]');
            const count = favorites.length;
            
            console.log('🔄 Updating favorites count badge:', count);
            console.log('📋 Favorites:', favorites);
            
            // Update all badges
            const badges = [
                'favorites-count-badge',
                'favorites-count-badge-mobile',
                'favorites-count-badge-auth',
                'favorites-count-badge-mobile-auth',
                'favorites-count-badge-desktop'
            ];
            
            badges.forEach(badgeId => {
                const badge = document.getElementById(badgeId);
                if (badge) {
                    console.log(`✅ Found badge: ${badgeId}`);
                    if (count > 0) {
                        badge.textContent = count;
                        badge.classList.remove('hidden');
                        console.log(`📊 Updated ${badgeId} to show: ${count}`);
                    } else {
                        badge.classList.add('hidden');
                        console.log(`📊 Hidden ${badgeId} (count: 0)`);
                    }
                } else {
                    console.log(`❌ Badge not found: ${badgeId}`);
                }
            });
        }

        // Update auth buttons (mobile and desktop)
        async function updateMobileAuthButtons() {
                // Wait for AuthService to be available
                if (!window.AuthService) {
                    console.log('⏳ Waiting for AuthService to load...');
                    await new Promise((resolve) => {
                        const checkInterval = setInterval(() => {
                            if (window.AuthService) {
                                clearInterval(checkInterval);
                                console.log('✅ AuthService loaded');
                                resolve();
                            }
                        }, 100);
                        
                        setTimeout(() => {
                            clearInterval(checkInterval);
                            console.error('❌ AuthService not loaded after 5 seconds');
                            resolve();
                        }, 5000);
                    });
                }
                
                if (!window.AuthService) {
                    console.error('❌ AuthService not available');
                    return;
                }
                
                const isLoggedIn = await window.AuthService.isLoggedIn();
                const user = await window.AuthService.getCurrentUser();
                const mobileAuthButtons = document.querySelector('.auth-buttons-mobile');
                const desktopAuthButtons = document.querySelector('.auth-buttons');
                
                
                // Update mobile auth buttons
                if (mobileAuthButtons) {
                    if (isLoggedIn) {
                        mobileAuthButtons.innerHTML = `
                            <span class="block py-2 text-gray-700">مرحباً، ${user?.user_metadata?.full_name || user?.email}</span>
                            <button onclick="confirmSignOut()" class="block py-2 text-red-600 font-medium">تسجيل الخروج</button>
                        `;
            
                    } else {
                        mobileAuthButtons.innerHTML = `
                            <!-- تم إزالة المفضلة لأنها موجودة في الهيدر -->
                        `;
            
                    }
                }
                
                // Update desktop auth buttons
                if (desktopAuthButtons) {
                    if (isLoggedIn) {
                        desktopAuthButtons.innerHTML = `
                            <span class="text-gray-700 mr-2">مرحباً، ${user?.user_metadata?.full_name || user?.email}</span>
                            <button onclick="confirmSignOut()" class="px-6 py-2 text-red-600 border-2 border-red-600 rounded-full font-medium hover:bg-red-600 hover:text-white transition-all">
                                تسجيل الخروج
                            </button>
                        `;
            
                    } else {
                        desktopAuthButtons.innerHTML = `
                            <!-- تم إزالة زر تسجيل الدخول -->
                        `;
            
                    }
                }
                
                // Update navigation (including admin button)
                await UIHelper.updateNavigation();
                
                // Update favorites count badge
                updateFavoritesCountBadge();
            }
            
            // دالة لتحديث الشبكة حسب حجم الشاشة
            function updateGridLayout() {
                const featuredGrid = document.getElementById('featured-products-grid');
                const recommendedGrid = document.getElementById('recommended-products-grid');
                
                if (featuredGrid && featuredGrid.style.display === 'grid') {
                    updateGridColumns(featuredGrid);
                }
                if (recommendedGrid && recommendedGrid.style.display === 'grid') {
                    updateGridColumns(recommendedGrid);
                }
            }
            
            // دالة لتحديث عدد الأعمدة في الشبكة - دائماً 3 أعمدة
            function updateGridColumns(container) {
                container.classList.remove('grid-cols-1', 'grid-cols-2', 'grid-cols-3');
                container.classList.add('grid-cols-3');
            }
            
            // مراقبة تغيير حجم الشاشة
            window.addEventListener('resize', updateGridLayout);
            
            // Load and display products
            async function loadProducts() {
                try {
                    console.log('🎯 loadProducts() called - Starting to load featured products...');
                    
                    // العناصر المطلوبة
                    const featuredLoading = document.getElementById('products-loading');
                    const featuredGrid = document.getElementById('featured-products-grid');
                    const featuredNoProducts = document.getElementById('no-products-message');
                    
                    // إظهار مؤشر التحميل
                    if (featuredLoading) featuredLoading.style.display = 'block';
                    
                    // إخفاء الشبكة
                    if (featuredGrid) featuredGrid.style.display = 'none';
                    
                    // إخفاء رسالة عدم وجود منتجات
                    if (featuredNoProducts) featuredNoProducts.style.display = 'none';
                    
                    // التحقق من خدمة الإعلانات
                    if (!window.advertisingService) {
                        console.error('❌ AdvertisingService not available!');
                        throw new Error('AdvertisingService not available');
                    }
                    
                    console.log('✅ AdvertisingService is available, proceeding...');
                    
                    // جلب المنتجات المميزة
                    console.log('🔍 Loading featured products...');
                    const featuredAds = await window.advertisingService.getFeaturedProducts(9); // 3x3 grid
                    
                    // إخفاء مؤشر التحميل
                    if (featuredLoading) featuredLoading.style.display = 'none';
                    
                    // عرض المنتجات المميزة
                    if (featuredAds && featuredAds.length > 0) {
                        console.log(`✅ Successfully loaded ${featuredAds.length} featured products`);
                        displayCategoryProducts(document.getElementById('featured-products-grid'), featuredAds, 'featured');
                        
                        // تسجيل ظهور الإعلانات
                        featuredAds.forEach(product => {
                            if (product.ad_id) {
                                window.advertisingService.recordImpression(product.ad_id);
                            }
                        });
                    } else {
                        console.log('⚠️ No featured products found');
                        if (featuredNoProducts) featuredNoProducts.style.display = 'block';
                    }

                    
                } catch (error) {
                    console.error('❌ خطأ في تحميل المنتجات:', error);
                    
                    // إخفاء مؤشر التحميل
                    if (featuredLoading) featuredLoading.style.display = 'none';
                    
                    // إظهار رسالة الخطأ
                    if (featuredNoProducts) {
                        featuredNoProducts.querySelector('h3').textContent = 'خطأ في تحميل المنتجات';
                        featuredNoProducts.querySelector('p').textContent = 'حدث خطأ أثناء تحميل المنتجات. يرجى المحاولة مرة أخرى.';
                        featuredNoProducts.style.display = 'block';
                    }
                }
            }
            
            // خلط المنتجات عشوائياً (جميع المنتجات من جميع الفئات)
            function shuffleProducts() {
                console.log('🔄 Starting shuffleProducts, initial count:', allProducts ? allProducts.length : 0);
                
                if (allProducts && allProducts.length > 1) {
                    // خلط جميع المنتجات عشوائياً
                    const shuffled = [...allProducts];
                    for (let i = shuffled.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                    }
                    allProducts = shuffled;
                    console.log('🔄 تم خلط جميع المنتجات عشوائياً');
                } else {
                    console.log('⚠️ No products to shuffle or only one product');
                }
            }








            


            // Display products in grid
            function displayProducts(products, containerId) {
                console.log('🎨 Displaying products:', products ? products.length : 0, 'in container:', containerId);
                console.log('📋 Products data:', products);
                
                const container = document.getElementById(containerId);
                let noProductsMessage;
                
                // البحث عن رسالة عدم وجود منتجات حسب نوع الحاوية
                if (containerId === 'recommended-products-grid') {
                    noProductsMessage = document.getElementById('recommended-no-products');
                } else if (containerId === 'koshat-products-grid') {
                    noProductsMessage = document.getElementById('koshat-no-products');
                } else if (containerId === 'cake-products-grid') {
                    noProductsMessage = document.getElementById('cake-no-products');
                } else if (containerId === 'mirror-products-grid') {
                    noProductsMessage = document.getElementById('mirror-no-products');
                } else if (containerId === 'other-products-grid') {
                    noProductsMessage = document.getElementById('other-no-products');
                } else if (containerId === 'invitations-products-grid') {
                    noProductsMessage = document.getElementById('invitations-no-products');
                } else {
                    noProductsMessage = document.getElementById('no-products-message');
                }
                
                if (!container) {
                    console.error('❌ لم يتم العثور على الحاوية:', containerId);
                    return;
                }
                
                console.log('📦 Container found:', container);
                
                if (!products || products.length === 0) {
                    console.log('⚠️ No products to display');
                    container.style.display = 'none';
                    if (noProductsMessage) {
                        noProductsMessage.style.display = 'block';
                    }
                    return;
                }
                
                // استخدم نفس تصميم بطاقات صفحة الكوشات لجميع الأقسام
                container.style.display = 'grid';
                if (noProductsMessage) {
                    noProductsMessage.style.display = 'none';
                }
                const sectionType = containerId === 'featured-products-grid' ? 'featured'
                    : containerId === 'recommended-products-grid' ? 'recommended'
                    : containerId.includes('koshat') ? 'koshat'
                    : containerId.includes('cake') ? 'cake'
                    : containerId.includes('mirror') ? 'mirr'
                    : containerId.includes('other') ? 'other'
                    : containerId.includes('invitations') ? 'invitations'
                    : 'featured';
                displayCategoryProducts(container, products, sectionType);
                return;
            }

            /**
             * تحميل المنتجات والإعلانات لكل قسم من أقسام التصنيفات
             * باستخدام خدمة الإعلانات الذكية
             */
            async function loadCategorySectionProducts() {
                try {
                    console.log('🎯 تحميل المنتجات والإعلانات لأقسام التصنيفات...');
                    
                    // التحقق من خدمة الإعلانات الذكية
                    if (!window.smartCategoryAdvertisingService) {
                        console.error('❌ خدمة الإعلانات الذكية غير متوفرة');
                        return;
                    }

                    // تهيئة الخدمة
                    await window.smartCategoryAdvertisingService.initialize();

                    // التصنيفات المتوفرة
                    const categories = [
                        { id: 'koshat', name: 'كوشات', loadingId: 'koshat-loading', gridId: 'koshat-products-grid', noProductsId: 'koshat-no-products' },
                        { id: 'cake', name: 'تورتات', loadingId: 'cake-loading', gridId: 'cake-products-grid', noProductsId: 'cake-no-products' },
                        { id: 'mirr', name: 'مرايا', loadingId: 'mirror-loading', gridId: 'mirror-products-grid', noProductsId: 'mirror-no-products' },
                        { id: 'other', name: 'ديكورات', loadingId: 'other-loading', gridId: 'other-products-grid', noProductsId: 'other-no-products' },
                        { id: 'invitations', name: 'دعوات', loadingId: 'invitations-loading', gridId: 'invitations-products-grid', noProductsId: 'invitations-no-products' }
                    ];

                    // تحميل المنتجات والإعلانات لكل تصنيف باستخدام الخدمة الذكية
                    for (const category of categories) {
                        try {
                            console.log(`🔍 تحميل ${category.name} باستخدام الخدمة الذكية...`);
                            
                            // استخدام الخدمة الذكية لتحميل القسم
                            await window.smartCategoryAdvertisingService.loadCategorySection(
                                category.id, 
                                category.gridId
                            );
                            
                            // الحصول على إحصائيات القسم
                            const stats = window.smartCategoryAdvertisingService.getCategorySectionStats(category.id);
                            if (stats) {
                                console.log(`📊 إحصائيات ${category.name}:`, stats);
                            }
                            
                        } catch (error) {
                            console.error(`❌ خطأ في تحميل ${category.name}:`, error);
                            
                            // إظهار رسالة الخطأ
                            const noProductsElement = document.getElementById(category.noProductsId);
                            if (noProductsElement) {
                                noProductsElement.querySelector('h3').textContent = 'خطأ في تحميل المنتجات';
                                noProductsElement.querySelector('p').textContent = 'حدث خطأ أثناء تحميل المنتجات. يرجى المحاولة مرة أخرى.';
                                noProductsElement.style.display = 'block';
                            }
                        }
                    }
                    
                    console.log('✅ تم تحميل جميع أقسام التصنيفات بنجاح');
                    
                } catch (error) {
                    console.error('❌ خطأ في تحميل أقسام التصنيفات:', error);
                }
            }

            /**
             * الحصول على اسم التصنيف بالعربية
             */
            function getCategoryName(category) {
                const categoryNames = {
                    'koshat': 'كوشات',
                    'cake': 'تورتات وشكولاتات',
                    'mirr': 'مرايا',
                    'other': 'ديكورات متنوعة',
                    'invitations': 'دعوات وتوزيعات'
                };
                return categoryNames[category] || category;
            }

        // ===== وظائف إدارة المفضلة =====
        

        

        

        









        
        // Get category name in Arabic
        function getCategoryName(category) {
                const categories = {
                    'koshat': 'كوشات',
                    'mirr': 'مرايا',
                    'cake': 'تورتات',
                    'other': 'ديكورات متنوعة',
                    'invitations': 'دعوات وتوزيعات'
                };
                return categories[category] || category;
            }
            
            
            // Format date
            function formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('ar-EG');
            }
            
            // Open product details page
            function openProductDetails(productId, adId = null) {
                console.log('🖱️ تم النقر على المنتج:', productId);
                
                // تسجيل النقر على الإعلان إذا كان موجوداً
                if (adId && window.advertisingService) {
                    console.log('📢 تسجيل النقر على الإعلان:', adId);
                    try {
                        window.advertisingService.recordClick(adId);
                        console.log('✅ تم تسجيل النقر بنجاح!');
                    } catch (error) {
                        console.error('❌ خطأ في تسجيل النقر:', error);
                    }
                } else {
                    // محاولة العثور على معرف الإعلان من العنصر
                    const productElement = document.querySelector(`[data-product-id="${productId}"]`);
                    if (productElement) {
                        const elementAdId = productElement.getAttribute('data-ad-id');
                        if (elementAdId && window.advertisingService) {
                            console.log('📢 تم العثور على معرف الإعلان من العنصر:', elementAdId);
                            try {
                                window.advertisingService.recordClick(elementAdId);
                                console.log('✅ تم تسجيل النقر بنجاح!');
                            } catch (error) {
                                console.error('❌ خطأ في تسجيل النقر:', error);
                            }
                        }
                    }
                }
                
                // الانتقال إلى صفحة تفاصيل المنتج
                window.location.href = `pages/product-details.html?id=${productId}`;
            }

            // Filter products by category
            function filterProducts(category) {
                if (category === 'all') {
                    return allProducts;
                }
                
                // Map Arabic category names to database values
                const categoryMap = {
                    'koshat': 'koshat',
                    'cake': 'cake',
                    'decor': 'mirr', // Assuming 'decor' maps to 'mirr' (mirrors)
                    'other': 'other'
                };
                
                const dbCategory = categoryMap[category];
                return allProducts.filter(product => product.category === dbCategory);
            }

            // Apply filter and update display
            function applyFilter(category) {
                console.log('🔍 Applying filter:', category);
                console.log('📊 All products count:', allProducts ? allProducts.length : 0);
                
                currentFilter = category;
                
                // Filter and display products
                const filteredProducts = filterProducts(category);
                console.log('📊 Filtered products count:', filteredProducts ? filteredProducts.length : 0);
                
                displayProducts(filteredProducts, 'featured-products-grid');
            }
            
            // Make loadProducts available globally
            window.loadProducts = loadProducts;



            // تحميل المنتجات عند تحميل الصفحة
            document.addEventListener('DOMContentLoaded', function() {
                console.log('🚀 DOM Content Loaded - Starting to load products...');
                
                // انتظار تحميل خدمة الإعلانات ثم تحميل المنتجات
                waitForAdvertisingService();
                

            });
            
            // انتظار تحميل خدمة الإعلانات
            async function waitForAdvertisingService() {
                try {
                    console.log('⏳ Waiting for AdvertisingService...');
                    
                    // انتظار خدمة الإعلانات
                    while (!window.advertisingService) {
                        await new Promise(resolve => setTimeout(resolve, 100));
                        console.log('⏳ Still waiting for AdvertisingService...');
                    }
                    
                    console.log('✅ AdvertisingService loaded, now loading products...');
                    
                    // تحميل المنتجات المميزة (الإعلانات)
                    await loadProducts();
                    
                } catch (error) {
                    console.error('❌ Error waiting for AdvertisingService:', error);
                }
            }
            
            // إضافة زر اختبار للإعلانات
            function addTestButton() {
                const container = document.querySelector('.container');
                if (container) {
                    const testButton = document.createElement('button');
                    testButton.innerHTML = '🧪 اختبار الإعلانات';
                    testButton.className = 'fixed bottom-4 right-4 bg-yellow-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                    testButton.onclick = async function() {
                        try {
                            if (window.advertisingService) {
                                const result = await window.advertisingService.debugGetAllAdvertisements();
                                if (result) {
                                    alert(`نتائج اختبار الإعلانات:\n\n📊 جميع الإعلانات: ${result.all?.length || 0}\n✅ الإعلانات النشطة: ${result.active?.length || 0}\n📅 الإعلانات بمواعيد صحيحة: ${result.validDates?.length || 0}`);
                                }
                            } else {
                                alert('خدمة الإعلانات غير متوفرة');
                            }
                        } catch (error) {
                            alert('خطأ في اختبار الإعلانات: ' + error.message);
                        }
                    };
                    document.body.appendChild(testButton);
                    
                    // إضافة زر إعادة تحميل المنتجات
                    const reloadButton = document.createElement('button');
                    reloadButton.innerHTML = '🔄 إعادة تحميل';
                    reloadButton.className = 'fixed bottom-4 right-32 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                    reloadButton.onclick = async function() {
                        try {
                            console.log('🔄 Manual reload triggered...');
                            await loadProducts();
                        } catch (error) {
                            console.error('❌ Error in manual reload:', error);
                            alert('خطأ في إعادة التحميل: ' + error.message);
                        }
                    };
                    document.body.appendChild(reloadButton);

                    // إضافة زر تنظيف فوري
                    const cleanupButton = document.createElement('button');
                    cleanupButton.innerHTML = '🧹 تنظيف فوري';
                    cleanupButton.className = 'fixed bottom-4 right-60 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50';
                    cleanupButton.onclick = async function() {
                        try {
                            if (window.advertisingService) {
                                console.log('🧹 بدء التنظيف الفوري...');
                                await window.advertisingService.autoCleanup();
                                alert('تم التنظيف! سيتم تحديث الصفحة تلقائياً');
                                setTimeout(() => location.reload(), 2000);
                            } else {
                                alert('خدمة الإعلانات غير متوفرة');
                            }
                        } catch (error) {
                            console.error('❌ خطأ في التنظيف:', error);
                            alert('خطأ في التنظيف: ' + error.message);
                        }
                    };
                    document.body.appendChild(cleanupButton);
                }
            }
        
        // Hero Carousel JavaScript
        class HeroCarousel {
            constructor() {
                this.currentSlide = 0;
                this.slides = [
                    {
                        title: 'مرحبًا بك في زينة',
                        description: 'موقعك الأول لاختيار كل ما يخص المناسبات والأفراح. كوشات، تورتات، شوكولاتة، دعوات وديكورات.. كل ما تحتاجه لتجعل يومك مميزًا في مكان واحد.',
                        buttonText: 'ابدأ رحلتك',
                        buttonLink: '#featured-products'
                    },
                    {
                        title: 'تنوع يلبي كل الأذواق',
                        description: 'من الكوشات الفخمة إلى المرايا والدعوات الأنيقة، نوفر لك خيارات واسعة تناسب جميع الأذواق والمناسبات.',
                        buttonText: 'تصفح التصنيفات',
                        buttonLink: '#categories'
                    },
                    {
                        title: 'لأن لحظاتك تستحق الأفضل',
                        description: 'في زينة نهتم بالجودة والتفاصيل، لتجد منتجات تعكس شخصيتك وتترك أثرًا لا يُنسى في مناسبتك الخاصة.',
                        buttonText: 'اكتشف المنتجات',
                        buttonLink: '#featured-products'
                    },
                    {
                        title: 'زينة.. لمناسبات تبقى في الذاكرة',
                        description: 'ابدأ رحلتك الآن مع زينة، واختر من بين أجمل المنتجات لتصنع لحظاتك المميزة.',
                        buttonText: 'ابدأ الآن',
                        buttonLink: '#featured-products'
                    }
                ];
                
                this.carousel = document.getElementById('hero-carousel');
                this.indicatorsContainer = document.getElementById('carousel-indicators');
                
                this.init();
            }
            
            init() {
                this.createIndicators();
                this.showSlide(0);
                this.setupEventListeners();
                this.startAutoPlay();
            }
            
            createIndicators() {
                this.indicatorsContainer.innerHTML = '';
                this.slides.forEach((_, index) => {
                    const indicator = document.createElement('button');
                    indicator.className = 'carousel-indicator';
                    indicator.addEventListener('click', () => this.showSlide(index));
                    this.indicatorsContainer.appendChild(indicator);
                });
            }
            
            showSlide(index) {
                this.currentSlide = index;
                const slide = this.slides[index];
                
                // Update indicators
                const indicators = this.indicatorsContainer.querySelectorAll('.carousel-indicator');
                indicators.forEach((indicator, i) => {
                    indicator.classList.toggle('active', i === index);
                });
                
                // Update content
                this.carousel.innerHTML = `
                    <div class="flex items-center justify-center h-full">
                        <!-- Content -->
                        <div class="text-center text-gray-800 px-8 max-w-4xl">
                            <h1 class="text-3xl md:text-5xl lg:text-6xl font-bold mb-6 text-shadow-lg leading-tight">${slide.title}</h1>
                            <p class="text-lg md:text-xl lg:text-2xl text-shadow max-w-3xl mx-auto leading-relaxed opacity-90">${slide.description}</p>
                        </div>
                    </div>
                `;
            }
            
            nextSlide() {
                const nextIndex = (this.currentSlide + 1) % this.slides.length;
                this.showSlide(nextIndex);
            }
            
            prevSlide() {
                const prevIndex = (this.currentSlide - 1 + this.slides.length) % this.slides.length;
                this.showSlide(prevIndex);
            }
            
            setupEventListeners() {
                // Keyboard navigation
                document.addEventListener('keydown', (e) => {
                    if (e.key === 'ArrowLeft') {
                        this.prevSlide();
                    } else if (e.key === 'ArrowRight') {
                        this.nextSlide();
                    }
                });
            }
            
            startAutoPlay() {
                setInterval(() => {
                    this.nextSlide();
                }, 4000); // Change slide every 4 seconds
            }
        }

        // منع التمرير التلقائي عند تحميل الصفحة
        if (window.location.hash) {
            // إزالة hash من URL بدون تمرير
            history.replaceState(null, null, window.location.pathname);
        }
        
        // Simple JavaScript for basic interactions
        document.addEventListener('DOMContentLoaded', async function() {
            // Add styles for governorate display
            GovernorateDisplay.addStyles();
            
            // Initialize hero carousel
            const heroCarousel = new HeroCarousel();
            window.heroCarousel = heroCarousel; // Make it globally accessible
            
            // Update mobile auth buttons and navigation
            await updateMobileAuthButtons();
            
            // Load products immediately for better performance
            loadProducts().catch(error => {
                console.error('Error loading products:', error);
            });
            
            // Load category section products and advertisements
            loadCategorySectionProducts().catch(error => {
                console.error('Error loading category section products:', error);
            });
            
                    // ضمان ظهور الهيدر
        function ensureHeaderVisibility() {
            const header = document.querySelector('header');
            if (header) {
                header.style.display = 'block';
                header.style.visibility = 'visible';
                header.style.opacity = '1';
                header.style.position = 'sticky';
                header.style.top = '0';
                header.style.zIndex = '50';
                header.style.backgroundColor = 'white';
                console.log('✅ تم ضمان ظهور الهيدر');
            }
        }
        
        // Mobile menu functionality
        const mobileMenuBtn = document.getElementById('mobile-menu-btn');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuBtn && mobileMenu) {
            mobileMenuBtn.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
            });
        }
        
        // التأكد من ظهور الهيدر عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', ensureHeaderVisibility);
        window.addEventListener('load', ensureHeaderVisibility);
        // إعادة التأكد بعد فترة قصيرة
        setTimeout(ensureHeaderVisibility, 100);
        setTimeout(ensureHeaderVisibility, 500);
        setTimeout(ensureHeaderVisibility, 1000);
        
        // معالجة التغييرات في hash
        window.addEventListener('hashchange', function() {
            if (window.location.hash === '#product-request-section') {
                // عند تغيير hash، نتمرير إلى القسم
                setTimeout(() => {
                    const productRequestSection = document.getElementById('product-request-section');
                    if (productRequestSection) {
                        const header = document.querySelector('header.sticky');
                        const headerHeight = header ? header.offsetHeight : 0;
                        const sectionTop = productRequestSection.offsetTop;
                        const targetScrollPosition = sectionTop - headerHeight - 20;
                        
                        window.scrollTo({
                            top: targetScrollPosition,
                            behavior: 'smooth'
                        });
                    }
                }, 100);
            }
        });
            

            

            

            

            

            
            // Add search event listeners

            

            

            


            
            // Product card click handlers - Removed as cards now have onclick handlers
            

            

            
            // Make functions available globally
            window.handleSignOut = handleSignOut;
            window.confirmSignOut = confirmSignOut;
            window.closeSignOutModal = closeSignOutModal;
            window.proceedSignOut = proceedSignOut;
            window.showSignOutSuccess = showSignOutSuccess;
            window.redirectToHome = redirectToHome;
            
            // Close custom modals when clicking outside
            document.addEventListener('click', function(e) {
                const signoutConfirmModal = document.getElementById('signout-confirm-modal');
                const signoutSuccessModal = document.getElementById('signout-success-modal');
                
                if (signoutConfirmModal && e.target === signoutConfirmModal) {
                    closeSignOutModal();
                }
                
                if (signoutSuccessModal && e.target === signoutSuccessModal) {
                    redirectToHome();
                }
            });
            
            // Close modals with Escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    closeSignOutModal();
                }
            });
            
            // Listen for auth state changes
            if (window.AuthService) {
                window.AuthService.onAuthStateChange(async (event, session) => {
                    if (event === 'SIGNED_IN') {
                        await UIHelper.updateNavigation();
                        await updateMobileAuthButtons();
                        await loadProducts(); // Reload products to show user's products
                        UIHelper.showSuccess('تم تسجيل الدخول بنجاح!');
                    } else if (event === 'SIGNED_OUT') {
                        await UIHelper.updateNavigation();
                        await updateMobileAuthButtons();
                        await loadProducts(); // Reload products to hide user's products
                        UIHelper.showSuccess('تم تسجيل الخروج بنجاح!');
                    }
                });
            }
            
            // Update favorites count badge on page load
            updateFavoritesCountBadge();
            
            // Force update after a short delay to ensure DOM is ready
            setTimeout(() => {
                updateFavoritesCountBadge();
                console.log('🔄 Force update after delay');
            }, 500);
            
            // تهيئة المفضلة بعد تحميل الصفحة
            setTimeout(() => {
                // تم إزالة دوال المفضلة والسلايدر
                console.log('🔄 تم إزالة دوال المفضلة والسلايدر');
            }, 1000);
            
            // Listen for changes in localStorage (favorites)
            window.addEventListener('storage', function(e) {
                if (e.key === 'favorites') {
                    updateFavoritesCountBadge();
                }
            });
            
            // مستمع للحدث المخصص لضمان التزامن
            window.addEventListener('favoritesChanged', function(e) {
                console.log('🔄 Favorites changed via custom event, updating favorites...');
                updateFavoritesCountBadge();
            });

                    // إعداد أزرار "أضف منتجك" في الهيدر
        setupHeaderButtons();
        
        // إعداد نموذج طلب المنتج بعد تحميل الصفحة بالكامل
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupProductRequestForm);
        } else {
            // Page already loaded, wait a bit more for scripts
            setTimeout(setupProductRequestForm, 1000);
        }
        });
        
        // إعداد أزرار الهيدر
        function setupHeaderButtons() {
            console.log('🔄 Setting up header buttons...');
            
            // زر "أضف منتجك" في الهيدر - الآن يعمل كرابط عادي
            const addProductRequestBtn = document.getElementById('add-product-request-btn');
            if (addProductRequestBtn) {
                console.log('✅ Found add product request button - now working as normal link');
                // إزالة preventDefault للسماح بالانتقال الطبيعي
                addProductRequestBtn.addEventListener('click', function(e) {
                    console.log('🖱️ Button clicked, navigating to add-product-request.html...');
                    // السماح بالانتقال الطبيعي إلى الصفحة
                });
            } else {
                console.error('❌ Add product request button not found');
            }
            
            // أزرار "أضف منتجك" في القائمة المتحركة - الآن تعمل كروابط عادية
            const mobileAddProductRequestBtns = document.querySelectorAll('a[href="pages/add-product-request.html"]');
            console.log(`📱 Found ${mobileAddProductRequestBtns.length} mobile buttons - now working as normal links`);
            mobileAddProductRequestBtns.forEach((btn, index) => {
                btn.addEventListener('click', function(e) {
                    console.log(`🖱️ Mobile button ${index + 1} clicked, navigating to add-product-request.html...`);
                    // السماح بالانتقال الطبيعي إلى الصفحة
                });
            });
        }
        


        // إعداد نموذج طلب المنتج
        let citiesService;
        let selectedCities = new Set();
        let currentGovernorates = [];
        let uploadedImages = [];
        let draggedElement = null;
        let draggedIndex = null;

        function setupProductRequestForm() {
            console.log('🚀 Setting up Product Request Form...');
            
            // Wait for all required services to be available
            waitForServices().then(() => {
                // Initialize advanced governorate filter
                setupAdvancedGovernorateFilter();
                
                // Initialize cities filter
                initializeCitiesFilter();
                
                // Setup form event listeners
                setupFormEventListeners();
                
                // Setup image upload
                setupImageUpload();
                
                // Setup global error banner
                setupGlobalErrorBanner();
                
                console.log('✅ Product Request Form setup completed');
            }).catch(error => {
                console.error('❌ Failed to setup Product Request Form:', error);
            });
        }
        
        // Wait for all required services to be available
        function waitForServices() {
            return new Promise((resolve, reject) => {
                const maxAttempts = 50; // 5 seconds max
                let attempts = 0;
                
                const checkServices = () => {
                    attempts++;
                    
                    const services = {
                        'CitiesService': typeof CitiesService !== 'undefined',
                        'ProductRequestsService': typeof ProductRequestsService !== 'undefined',
                        'Supabase': typeof supabaseClient !== 'undefined'
                    };
                    
                    console.log(`🔍 Checking services (attempt ${attempts}):`, services);
                    
                    const allAvailable = Object.values(services).every(available => available);
                    
                    if (allAvailable) {
                        console.log('✅ All required services are available');
                        resolve();
                    } else if (attempts >= maxAttempts) {
                        console.error('❌ Timeout waiting for services');
                        reject(new Error('Services timeout'));
                    } else {
                        setTimeout(checkServices, 100);
                    }
                };
                
                checkServices();
            });
        }
        
        // Setup form event listeners
        function setupFormEventListeners() {
            const form = document.getElementById('product-request-form');
            const categorySelect = document.getElementById('request-category');
            
            // Form submission
            form.addEventListener('submit', submitProductRequest);
            
            // Category change
            categorySelect.addEventListener('change', handleCategoryChange);
            
            // Setup validation event listeners
            setupValidationEventListeners();
        }
        
        // Setup validation event listeners
        function setupValidationEventListeners() {
            // Clear errors when user starts typing/selecting
            const descriptionField = document.getElementById('request-description');
            const categoryField = document.getElementById('request-category');
            const whatsappField = document.getElementById('request-whatsapp');
            const facebookField = document.getElementById('request-facebook');
            const instagramField = document.getElementById('request-instagram');
            
            descriptionField.addEventListener('input', () => clearFieldError('request-description'));
            categoryField.addEventListener('change', () => clearFieldError('request-category'));
            whatsappField.addEventListener('input', () => {
                clearFieldError('request-whatsapp');
                validateSocialMediaFields();
            });
            facebookField.addEventListener('input', () => {
                clearFieldError('request-facebook');
                validateSocialMediaFields();
            });
            instagramField.addEventListener('input', () => {
                clearFieldError('request-instagram');
                validateSocialMediaFields();
            });
            
            // Clear governorate error when selection changes
            const governorateCheckboxes = document.querySelectorAll('.governorate-checkbox');
            governorateCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', () => {
                    // Clear error after a short delay to allow the selection to update
                    setTimeout(() => {
                        if (currentGovernorates.length > 0) {
                            clearFieldError('request-governorate');
                        }
                    }, 100);
                });
            });
            
            // Clear subcategory error when selection changes
            document.addEventListener('change', (e) => {
                if (e.target.closest('#request-subcategory-options')) {
                    // Clear error after a short delay to allow the selection to update
                    setTimeout(() => {
                        const selectedSubcategories = document.querySelectorAll('#request-subcategory-options input[type="checkbox"]:checked');
                        if (selectedSubcategories.length > 0) {
                            clearFieldError('request-subcategory');
                        }
                    }, 100);
                }
            });
        }
        
        // Validate social media fields in real-time
        function validateSocialMediaFields() {
            const whatsapp = document.getElementById('request-whatsapp').value.trim();
            const facebook = document.getElementById('request-facebook').value.trim();
            const instagram = document.getElementById('request-instagram').value.trim();
            
            // Clear social media error if at least one is filled
            if (whatsapp || facebook || instagram) {
                clearFieldError('social-media');
            }
            
            // Validate individual fields if they are filled
            if (whatsapp && !isValidWhatsAppNumber(whatsapp)) {
                showFieldError('request-whatsapp', 'يرجى إدخال رقم واتساب صحيح');
            } else if (whatsapp) {
                clearFieldError('request-whatsapp');
            }
            
                            if (facebook && !isValidFacebookUrl(facebook)) {
                    showFieldError('request-facebook', 'يرجى إدخال رابط فيسبوك صحيح (يقبل جميع أنواع الروابط: صفحات، مجموعات، أحداث، منشورات، صور، فيديوهات، hashtags، روابط قصيرة)');
                } else if (facebook) {
                    clearFieldError('request-facebook');
                }
            
            if (instagram && !isValidInstagramUsername(instagram)) {
                showFieldError('request-instagram', 'يرجى إدخال اسم مستخدم إنستجرام صحيح');
            } else if (instagram) {
                clearFieldError('request-instagram');
            }
        }
        
        // Global Error Banner Functions
        function showGlobalErrorBanner() {
            const banner = document.getElementById('global-error-banner');
            if (banner) {
                banner.classList.remove('hidden');
                // Use setTimeout to ensure the element is visible before animating
                setTimeout(() => {
                    banner.classList.add('show');
                }, 10);
                
                // Scroll to the banner smoothly
                banner.scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'center' 
                });
            }
        }
        
        function hideGlobalErrorBanner() {
            const banner = document.getElementById('global-error-banner');
            if (banner) {
                banner.classList.remove('show');
                setTimeout(() => {
                    banner.classList.add('hidden');
                }, 300);
            }
        }
        
        // Handle category change
        function handleCategoryChange() {
            const selectedCategory = this.value;
            const subcategoryGroup = document.getElementById('request-subcategory-group');
            const subcategoryOptions = document.getElementById('request-subcategory-options');
            
            // Clear subcategory options
            subcategoryOptions.innerHTML = '';
            
            // Clear any existing subcategory errors
            clearFieldError('request-subcategory');
            
            if (selectedCategory && subcategories[selectedCategory]) {
                // Add subcategory options as checkboxes
                subcategories[selectedCategory].forEach(sub => {
                    const checkboxDiv = document.createElement('div');
                    checkboxDiv.className = 'flex items-center';
                    checkboxDiv.innerHTML = `
                        <input type="checkbox" 
                               id="sub-${sub.value}" 
                               value="${sub.value}" 
                               class="w-4 h-4 text-yellow-600 bg-gray-100 border-gray-300 rounded focus:ring-yellow-500 focus:ring-2">
                        <label for="sub-${sub.value}" class="mr-2 text-sm text-gray-700 cursor-pointer">
                            ${sub.label}
                        </label>
                    `;
                    subcategoryOptions.appendChild(checkboxDiv);
                });
                
                // Show subcategory group
                subcategoryGroup.style.display = 'block';
            } else {
                // Hide subcategory group
                subcategoryGroup.style.display = 'none';
            }
        }
        
        // Subcategory definitions - Updated to match category page filters
        const subcategories = {
            'koshat': [
                { value: 'koshat-wedding', label: 'كوشات زفاف' },
                { value: 'koshat-engagement', label: 'كوشات خطوبة' }
            ],
            'mirr': [
                { value: 'mirror-wedding', label: 'مرآة زفاف' },
                { value: 'mirror-engagement', label: 'مرآة خطوبة' },
                { value: 'mirror-decorative', label: 'مرآة ديكور' }
            ],
            'cake': [
                { value: 'cake-wedding', label: 'تورتة زفاف' },
                { value: 'cake-engagement', label: 'تورتة خطوبة' },
                { value: 'cake-birthday', label: 'تورتة عيد ميلاد' },
                { value: 'cake-chocolate', label: 'تورتة شوكولاتة' },
                { value: 'cake-fruit', label: 'تورتة فواكه' },
                { value: 'cake-chocolate-tray', label: 'صينية شوكولاتة' }
            ],
            'other': [
                { value: 'other-birthday', label: 'ديكور عيد ميلاد' },
                { value: 'other-hospital', label: 'استقبال المولود بالمستشفى' },
                { value: 'other-bride', label: 'ديكور استقبال عروسة' },
                { value: 'other-party', label: 'ديكور حفلات بسيطة' }
            ],
            'invitations': [
                { value: 'invitation-wedding', label: 'دعوة زفاف' },
                { value: 'invitation-engagement', label: 'دعوة خطوبة' },
                { value: 'invitation-chocolate', label: 'توزيعات بالشوكولاتة' },
                { value: 'invitation-perfumed', label: 'توزيعات بالبرفان' },
                { value: 'invitation-gift', label: 'توزيعات مع هدية صغيرة' },
                { value: 'invitation-digital', label: 'دعوة رقمية' },
                { value: 'invitation-innovative', label: 'دعوة مبتكرة' }
            ]
        };
        

        
        // Setup Global Error Banner Event Listeners
        function setupGlobalErrorBanner() {
            // Close button event listener
            const closeBtn = document.getElementById('close-error-banner');
            if (closeBtn) {
                closeBtn.addEventListener('click', hideGlobalErrorBanner);
            }
        }
        
        // Setup Advanced Governorate Filter
        function setupAdvancedGovernorateFilter() {
            console.log('🔍 setupAdvancedGovernorateFilter called');
            console.log('🔍 Stack trace:', new Error().stack);
            
            const dropdownBtn = document.getElementById('request-governorate-dropdown-btn');
            const dropdownContent = document.getElementById('request-governorate-dropdown-content');
            const checkboxes = document.querySelectorAll('.governorate-checkbox');
            const selectAllBtn = document.getElementById('request-select-all-governorates');
            const clearAllBtn = document.getElementById('request-clear-all-governorates');
            const selectedContainer = document.getElementById('request-selected-governorates');

            console.log('🔍 Setting up Advanced Governorate Filter...');
            console.log('📱 Elements found:', {
                dropdownBtn: !!dropdownBtn,
                dropdownBtnId: dropdownBtn?.id,
                dropdownContent: !!dropdownContent,
                dropdownContentId: dropdownContent?.id,
                checkboxes: checkboxes.length,
                selectAllBtn: !!selectAllBtn,
                clearAllBtn: !!clearAllBtn,
                selectedContainer: !!selectedContainer
            });

            // Toggle dropdown
            dropdownBtn.addEventListener('click', function() {
                dropdownContent.classList.toggle('hidden');
                dropdownBtn.classList.toggle('active');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(event) {
                if (!dropdownBtn.contains(event.target) && !dropdownContent.contains(event.target)) {
                    dropdownContent.classList.add('hidden');
                    dropdownBtn.classList.remove('active');
                }
            });
            
            // Hover event removed - no validation needed

            // Handle checkbox changes
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    updateSelectedGovernorates();
                    updatePlaceholder();
                    updateCitiesFilter(currentGovernorates);
                });
            });

            // Select all
            selectAllBtn.addEventListener('click', function() {
                checkboxes.forEach(checkbox => {
                    checkbox.checked = true;
                });
                updateSelectedGovernorates();
                updatePlaceholder();
                updateCitiesFilter(currentGovernorates);
            });

            // Clear all
            clearAllBtn.addEventListener('click', function() {
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                updateSelectedGovernorates();
                updatePlaceholder();
                updateCitiesFilter(currentGovernorates);
            });

            function updateSelectedGovernorates() {
                const selected = [];
                checkboxes.forEach(checkbox => {
                    if (checkbox.checked) {
                        selected.push(checkbox.value);
                    }
                });
                currentGovernorates = selected;
                displaySelectedGovernorates();
                
                // Clear governorate error if governorates are selected
                if (selected.length > 0) {
                    clearFieldError('request-governorate');
                }
            }

            function updatePlaceholder() {
                const placeholder = document.getElementById('request-governorate-placeholder');
                if (currentGovernorates.length === 0) {
                    placeholder.textContent = 'اختر المحافظات';
                } else if (currentGovernorates.length === 1) {
                    placeholder.textContent = currentGovernorates[0];
                } else {
                    placeholder.textContent = `${currentGovernorates.length} محافظة مختارة`;
                }
            }

            function displaySelectedGovernorates() {
                if (currentGovernorates.length === 0) {
                    selectedContainer.innerHTML = '';
                    return;
                }

                selectedContainer.innerHTML = currentGovernorates.map(gov => `
                    <div class="selected-governorate-tag">
                        ${gov}
                        <button class="remove-governorate" onclick="removeRequestGovernorate('${gov}')">×</button>
                    </div>
                `).join('');
            }
        }

        // Remove specific governorate from request form
        function removeRequestGovernorate(governorate) {
            const checkbox = document.querySelector(`.governorate-checkbox[value="${governorate}"]`);
            if (checkbox) {
                checkbox.checked = false;
                currentGovernorates = currentGovernorates.filter(g => g !== governorate);
                
                const placeholder = document.getElementById('request-governorate-placeholder');
                placeholder.textContent = currentGovernorates.length === 0 ? 'اختر المحافظات' : 
                    currentGovernorates.length === 1 ? currentGovernorates[0] :
                    `${currentGovernorates.length} محافظة مختارة`;
                
                displaySelectedGovernorates();
                updateCitiesFilter(currentGovernorates);
            }
        }

        // Initialize Cities Filter
        function initializeCitiesFilter() {
            try {
                // Wait for CitiesService to be available
                if (typeof CitiesService === 'undefined') {
                    console.log('⏳ Waiting for CitiesService to load...');
                    setTimeout(() => initializeCitiesFilter(), 100);
                    return;
                }
                
                // Initialize CitiesService
                citiesService = new CitiesService();
                console.log('✅ CitiesService initialized successfully');
                
                // Setup cities filter functionality
                setupCitiesFilter();
            } catch (error) {
                console.error('❌ Error initializing CitiesService:', error);
                // Retry after a delay
                setTimeout(() => initializeCitiesFilter(), 500);
            }
        }
        
        // Setup Cities Filter
        function setupCitiesFilter() {
            const citiesTrigger = document.getElementById('request-cities-trigger');
            const citiesDropdown = document.getElementById('request-cities-dropdown');
            const citiesSearch = document.getElementById('request-cities-search');
            const selectAllCitiesBtn = document.getElementById('request-select-all-cities-btn');
            const clearAllCitiesBtn = document.getElementById('request-clear-all-cities-btn');
            const applyCitiesFilterBtn = document.getElementById('request-apply-cities-filter');

            // Toggle dropdown
            citiesTrigger.addEventListener('click', function() {
                citiesDropdown.classList.toggle('show');
                citiesTrigger.classList.toggle('active');
            });

            // Close dropdown when clicking outside
            document.addEventListener('click', function(event) {
                if (!citiesTrigger.contains(event.target) && !citiesDropdown.contains(event.target)) {
                    citiesDropdown.classList.remove('show');
                    citiesTrigger.classList.remove('active');
                }
            });

            // Search functionality
            citiesSearch.addEventListener('input', function() {
                filterCities(this.value);
            });

            // Select all cities
            selectAllCitiesBtn.addEventListener('click', function() {
                const checkboxes = document.querySelectorAll('.city-input');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = true;
                    selectedCities.add(checkbox.value);
                });
                updateCitiesDisplay();
            });

            // Clear all cities
            clearAllCitiesBtn.addEventListener('click', function() {
                const checkboxes = document.querySelectorAll('.city-input');
                checkboxes.forEach(checkbox => {
                    checkbox.checked = false;
                });
                selectedCities.clear();
                updateCitiesDisplay();
            });

            // Apply filter
            applyCitiesFilterBtn.addEventListener('click', function() {
                citiesDropdown.classList.remove('show');
                citiesTrigger.classList.remove('active');
            });
        }
        

        
        // Update Cities Filter based on selected governorates
        function updateCitiesFilter(selectedGovernorates) {
            console.log('🔄 Updating Cities Filter for governorates:', selectedGovernorates);
            
            const citiesGroup = document.getElementById('request-cities-group');
            const citiesList = document.getElementById('request-cities-list');
            const citiesTrigger = document.getElementById('request-cities-trigger');
            const citiesSearch = document.getElementById('request-cities-search');

            if (selectedGovernorates.length === 0) {
                // Hide cities filter if no governorates selected
                citiesGroup.style.display = 'none';
                selectedCities.clear();
                updateCitiesDisplay();
                return;
            }

            // Show cities filter
            citiesGroup.style.display = 'block';

            // Check if citiesService is available
            if (!citiesService) {
                console.error('❌ CitiesService not available');
                console.log('🔍 Current citiesService:', citiesService);
                console.log('🔍 Window CitiesService:', typeof window.CitiesService);
                return;
            }

            // Get all cities for selected governorates
            let allCities = [];
            selectedGovernorates.forEach(governorate => {
                try {
                    const cities = citiesService.getCitiesForGovernorate(governorate);
                    if (cities && cities.length > 0) {
                        allCities = allCities.concat(cities);
                    }
                } catch (error) {
                    console.error(`Error getting cities for ${governorate}:`, error);
                }
            });

            // Remove duplicates
            allCities = [...new Set(allCities)];

            console.log('Available cities for selected governorates:', allCities);

            // Populate cities list
            citiesList.innerHTML = allCities.map(city => `
                <div class="city-item">
                    <label class="city-checkbox">
                        <input type="checkbox" value="${city}" class="city-input">
                        <span class="city-name">${city}</span>
                    </label>
                </div>
            `).join('');

            // Add event listeners to new checkboxes
            const cityCheckboxes = document.querySelectorAll('.city-input');
            cityCheckboxes.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    if (this.checked) {
                        selectedCities.add(this.value);
                    } else {
                        selectedCities.delete(this.value);
                    }
                    updateCitiesDisplay();
                });
            });

            // Clear search
            citiesSearch.value = '';
            
            // Update display
            updateCitiesDisplay();
        }
        
        // Filter cities based on search term
        function filterCities(searchTerm) {
            const cityItems = document.querySelectorAll('.city-item');
            
            cityItems.forEach(item => {
                const cityName = item.querySelector('.city-name').textContent.toLowerCase();
                const matches = cityName.includes(searchTerm.toLowerCase());
                item.style.display = matches ? 'block' : 'none';
            });
        }
        
        // Update cities display
        function updateCitiesDisplay() {
            const selectedCount = document.getElementById('request-cities-selected-count');
            const selectedCitiesContainer = document.getElementById('request-selected-cities');
            const triggerText = document.querySelector('#request-cities-trigger .trigger-text');

            // Update count
            if (selectedCities.size === 0) {
                selectedCount.style.display = 'none';
                triggerText.textContent = 'اختر المناطق/المدن (اختياري)';
            } else {
                selectedCount.style.display = 'inline-block';
                selectedCount.textContent = selectedCities.size;
                triggerText.textContent = `${selectedCities.size} منطقة مختارة`;
            }

            // Update selected cities tags
            if (selectedCities.size === 0) {
                selectedCitiesContainer.innerHTML = '';
            } else {
                selectedCitiesContainer.innerHTML = Array.from(selectedCities).map(city => `
                    <div class="selected-city-tag">
                        ${city}
                        <button class="remove-city" onclick="removeCity('${city}')">×</button>
                    </div>
                `).join('');
            }
        }
        
        // Remove specific city
        function removeCity(city) {
            selectedCities.delete(city);
            
            // Uncheck the corresponding checkbox
            const checkbox = document.querySelector(`.city-input[value="${city}"]`);
            if (checkbox) {
                checkbox.checked = false;
            }
            
            updateCitiesDisplay();
        }
        
        // Get selected cities for form submission
        function getSelectedCities() {
            return Array.from(selectedCities);
        }
        
        // Setup image upload
        function setupImageUpload() {
            const uploadArea = document.getElementById('request-upload-area');
            const imageUpload = document.getElementById('request-image-upload');
            const imagePreview = document.getElementById('request-image-preview');
            
            // Initialize image counter
            updateImageCounter();
            
            // Click to upload
            uploadArea.addEventListener('click', () => {
                // Check if already at limit
                if (uploadedImages.length >= 3) {
                    showNotification('يمكنك تحميل 3 صور كحد أقصى فقط', 'error');
                    return;
                }
                imageUpload.click();
            });
            
            // Drag and drop functionality
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('dragover');
            });

            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('dragover');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                
                // Check if adding files would exceed limit
                if (uploadedImages.length >= 3) {
                    showNotification('يمكنك تحميل 3 صور كحد أقصى فقط', 'error');
                    return;
                }
                
                const files = e.dataTransfer.files;
                handleImageFiles(files);
            });
            
            // File input change
            imageUpload.addEventListener('change', (e) => {
                handleImageFiles(e.target.files);
                // Clear input to allow selecting same file again
                e.target.value = '';
            });
        }
        
        // Handle image files
        function handleImageFiles(files) {
            // Check if adding these files would exceed the limit
            const currentCount = uploadedImages.length;
            const newFiles = Array.from(files).filter(file => file.type.startsWith('image/'));
            
            if (currentCount + newFiles.length > 3) {
                showNotification('يمكنك تحميل 3 صور كحد أقصى فقط', 'error');
                return;
            }
            
            // Process each image file
            newFiles.forEach(file => {
                processAndAddImage(file);
            });
        }
        
        // Process image: compress and add preview
        async function processAndAddImage(file) {
            try {
                // Compress image before adding
                const compressedFile = await compressImage(file);
                addImagePreview(compressedFile);
            } catch (error) {
                console.error('Error processing image:', error);
                // Fallback to original file if compression fails
                addImagePreview(file);
            }
        }
        
        // Compress image to reduce quality and size
        async function compressImage(file) {
            return new Promise((resolve) => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                const img = new Image();
                
                img.onload = () => {
                    // Calculate new dimensions (max width: 800px, maintain aspect ratio)
                    const maxWidth = 800;
                    let { width, height } = img;
                    
                    if (width > maxWidth) {
                        height = (height * maxWidth) / width;
                        width = maxWidth;
                    }
                    
                    // Set canvas dimensions
                    canvas.width = width;
                    canvas.height = height;
                    
                    // Draw and compress image
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // Convert to blob with reduced quality (0.7 = 70% quality)
                    canvas.toBlob((blob) => {
                        const compressedFile = new File([blob], file.name, {
                            type: 'image/jpeg',
                            lastModified: Date.now()
                        });
                        resolve(compressedFile);
                    }, 'image/jpeg', 0.7);
                };
                
                img.src = URL.createObjectURL(file);
            });
        }
        
        // Add image preview with drag and drop functionality
        function addImagePreview(file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                const imageItem = document.createElement('div');
                imageItem.className = 'image-item sortable-image';
                imageItem.draggable = true;
                imageItem.setAttribute('data-index', uploadedImages.length);
                
                // Calculate file size in KB
                const fileSizeKB = (file.size / 1024).toFixed(1);
                
                imageItem.innerHTML = `
                    <div class="image-drag-handle">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8h16M4 16h16" />
                        </svg>
                    </div>
                    <img src="${e.target.result}" alt="${file.name}" class="w-full h-32 object-cover rounded-lg">
                    <div class="image-number">${uploadedImages.length + 1}</div>
                    <div class="image-info text-xs text-gray-500 mt-1 text-center">
                        ${fileSizeKB} KB
                    </div>
                    <button type="button" class="image-remove" onclick="removeImage(this)">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                `;
                
                // Add drag and drop event listeners
                imageItem.addEventListener('dragstart', handleDragStart);
                imageItem.addEventListener('dragover', handleDragOver);
                imageItem.addEventListener('drop', handleDrop);
                imageItem.addEventListener('dragenter', handleDragEnter);
                imageItem.addEventListener('dragleave', handleDragLeave);
                
                const imagePreview = document.getElementById('request-image-preview');
                if (imagePreview) {
                    imagePreview.appendChild(imageItem);
                }
                uploadedImages.push({ src: e.target.result, name: file.name, file: file });
                
                // Hide instructions after first image
                const instructions = document.querySelector('.image-sort-instructions');
                if (instructions) {
                    instructions.style.display = 'none';
                }
                
                // Update image counter
                updateImageCounter();
            };
            reader.readAsDataURL(file);
        }
        
        // Drag and drop functions for image sorting
        function handleDragStart(e) {
            draggedElement = this;
            draggedIndex = parseInt(this.getAttribute('data-index'));
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDragEnter(e) {
            e.preventDefault();
            this.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            this.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            this.classList.remove('drag-over');
            
            if (draggedElement !== this) {
                const dropIndex = parseInt(this.getAttribute('data-index'));
                
                // Reorder the uploadedImages array
                const draggedImage = uploadedImages[draggedIndex];
                uploadedImages.splice(draggedIndex, 1);
                uploadedImages.splice(dropIndex, 0, draggedImage);
                
                // Reorder the DOM elements
                const imagePreview = document.getElementById('request-image-preview');
                if (imagePreview) {
                    const allImages = Array.from(imagePreview.querySelectorAll('.sortable-image'));
                    const draggedDOM = allImages[draggedIndex];
                    
                    if (draggedIndex < dropIndex) {
                        imagePreview.insertBefore(draggedDOM, allImages[dropIndex].nextSibling);
                    } else {
                        imagePreview.insertBefore(draggedDOM, allImages[dropIndex]);
                    }
                }
                
                // Update order
                updateImageOrder();
                
                // Show success message
                showSortSuccess();
            }
            
            draggedElement.classList.remove('dragging');
            draggedElement = null;
            draggedIndex = null;
        }

        function showSortSuccess() {
            const message = document.createElement('div');
            message.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 flex items-center';
            message.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                تم تغيير ترتيب الصور بنجاح
            `;
            
            document.body.appendChild(message);
            
            // Remove message after 3 seconds
            setTimeout(() => {
                message.remove();
            }, 3000);
        }

        function updateImageOrder() {
            const imagePreview = document.getElementById('request-image-preview');
            if (!imagePreview) return;
            
            const imageItems = imagePreview.querySelectorAll('.sortable-image');
            imageItems.forEach((item, index) => {
                item.setAttribute('data-index', index);
                const numberElement = item.querySelector('.image-number');
                if (numberElement) {
                    numberElement.textContent = index + 1;
                }
            });
            
            // Update image counter after reordering
            updateImageCounter();
        }
        
        // Remove image
        function removeImage(button) {
            const imagePreview = document.getElementById('request-image-preview');
            if (!imagePreview) return;
            
            const imageItem = button.parentElement;
            const index = Array.from(imagePreview.children).indexOf(imageItem);
            uploadedImages.splice(index, 1);
            imageItem.remove();
            
            // Update image numbers and data-index attributes
            updateImageOrder();
            
            // Update image counter
            updateImageCounter();
            
            // Show instructions if no images left
            if (uploadedImages.length === 0) {
                const instructions = document.querySelector('.image-sort-instructions');
                if (instructions) {
                    instructions.style.display = 'block';
                }
            }
        }
        
        // Update image counter display
        function updateImageCounter() {
            const counter = document.getElementById('image-counter');
            if (counter) {
                counter.textContent = `${uploadedImages.length}/3`;
                
                // Change color based on count
                if (uploadedImages.length >= 3) {
                    counter.classList.add('text-red-500');
                    counter.classList.remove('text-green-500', 'text-yellow-500');
                } else if (uploadedImages.length >= 2) {
                    counter.classList.add('text-yellow-500');
                    counter.classList.remove('text-green-500', 'text-red-500');
                } else {
                    counter.classList.add('text-green-500');
                    counter.classList.remove('text-yellow-500', 'text-red-500');
                }
            }
        }



        // إرسال طلب المنتج
        async function submitProductRequest(e) {
            e.preventDefault();
            
            // Clear all previous errors
            clearAllFieldErrors();
            
            // Validate form before submission
            if (!validateForm()) {
                return; // Stop submission if validation fails
            }
            
            // Check image count
            if (uploadedImages.length === 0) {
                showNotification('يجب رفع صورة واحدة على الأقل للمنتج', 'error');
                return;
            }
            
            // Get form data after validation
            const description = document.getElementById('request-description').value.trim();
            const price = document.getElementById('request-price').value;
            const category = document.getElementById('request-category').value;
            
            // Get selected subcategories
            const selectedSubcategories = [];
            const subcategoryCheckboxes = document.querySelectorAll('#request-subcategory-options input[type="checkbox"]:checked');
            subcategoryCheckboxes.forEach(checkbox => {
                selectedSubcategories.push(checkbox.value);
            });
            
            const selectedGovernorates = currentGovernorates;
            const whatsapp = document.getElementById('request-whatsapp').value;
            const facebook = document.getElementById('request-facebook').value;
            const instagram = document.getElementById('request-instagram').value;
            
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            showLoading(submitBtn);
            
            try {
                // Get selected cities
                const selectedCitiesArray = getSelectedCities();
                
                // Prepare request data
                const requestData = {
                    description: description,
                    price: price || null,
                    category: category,
                    subcategory: selectedSubcategories.length > 0 ? selectedSubcategories : null,
                    governorate: selectedGovernorates.join(', '),
                    cities: selectedCitiesArray.length > 0 ? selectedCitiesArray.join(', ') : null,
                    whatsapp: whatsapp,
                    facebook: facebook || null,
                    instagram: instagram || null
                };
                
                // Convert uploaded images to File objects
                const imageFiles = [];
                for (let i = 0; i < uploadedImages.length; i++) {
                    if (uploadedImages[i].file) {
                        imageFiles.push(uploadedImages[i].file);
                    } else {
                        // Convert data URL to File object
                        const response = await fetch(uploadedImages[i].src);
                        const blob = await response.blob();
                        const file = new File([blob], uploadedImages[i].name, { type: blob.type });
                        imageFiles.push(file);
                    }
                }
                
                // Submit request
                const productRequestsService = new ProductRequestsService();
                const result = await productRequestsService.submitProductRequest(requestData, imageFiles);
                
                if (result.success) {
                    // ✅ 1. رسالة النجاح
                    showSuccessMessage('تم إرسال طلبك بنجاح! سنقوم بمراجعته وإضافته للموقع قريباً.');
                    
                    // ✅ 2. مسح النموذج
                    e.target.reset();
                    uploadedImages.length = 0;
                    const imagePreview = document.getElementById('request-image-preview');
                    imagePreview.innerHTML = '';
                    
                    // ✅ 3. مسح فلتر المدن
                    selectedCities.clear();
                    updateCitiesDisplay();
                    
                    // ✅ 4. إخفاء مجموعات التصنيفات
                    document.getElementById('request-subcategory-group').style.display = 'none';
                    document.getElementById('request-cities-group').style.display = 'none';
                    
                    // ✅ 5. إعادة عرض تعليمات الصور
                    const instructions = document.createElement('div');
                    instructions.className = 'image-sort-instructions mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg col-span-2 md:col-span-4';
                    instructions.innerHTML = `
                        <div class="flex items-center text-blue-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 ml-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4" />
                            </svg>
                            <span class="text-sm font-medium">اسحب الصور لترتيبها - الصورة الأولى ستكون الصورة الرئيسية</span>
                        </div>
                    `;
                    imagePreview.appendChild(instructions);
                    
                    // ✅ 6. إعادة تعيين اختيارات المحافظات
                    currentGovernorates = [];
                    const governorateCheckboxes = document.querySelectorAll('.governorate-checkbox');
                    governorateCheckboxes.forEach(checkbox => {
                        checkbox.checked = false;
                    });
                    
                    // ✅ 7. تحديث النص التوضيحي
                    const placeholder = document.getElementById('request-governorate-placeholder');
                    if (placeholder) {
                        placeholder.textContent = 'اختر المحافظات';
                    }
                    
                    // ✅ 8. مسح عرض المحافظات المختارة
                    const selectedContainer = document.getElementById('request-selected-governorates');
                    if (selectedContainer) {
                        selectedContainer.innerHTML = '';
                    }
                    
                    // ✅ 9. إعادة تحميل الصفحة مع البقاء في نفس العنوان
                    setTimeout(() => {
                        // حفظ موقع النموذج في الذاكرة المؤقتة
                        sessionStorage.setItem('scrollToForm', 'true');
                        location.reload();
                    }, 2000); // انتظار ثانيتين لعرض رسالة النجاح
                } else {
                    submitBtn.innerHTML = originalText;
                    showErrorMessage('حدث خطأ في إرسال الطلب. يرجى المحاولة مرة أخرى.');
                }
            } catch (error) {
                submitBtn.innerHTML = originalText;
                showErrorMessage('حدث خطأ في إرسال الطلب. يرجى المحاولة مرة أخرى.');
                console.error('Error:', error);
            }
        }
        
                // Form validation function
        function validateForm() {
            let isValid = true;
            
            // Validate description
            const description = document.getElementById('request-description').value.trim();
            if (!description) {
                showFieldError('request-description', 'هذا الحقل مطلوب');
                isValid = false;
            }
            
            // Validate category
            const category = document.getElementById('request-category').value;
            if (!category) {
                showFieldError('request-category', 'يرجى اختيار التصنيف الرئيسي');
                isValid = false;
            }
            
            // Validate subcategory (only if category is selected)
            if (category) {
                const subcategoryCheckboxes = document.querySelectorAll('#request-subcategory-options input[type="checkbox"]:checked');
                if (subcategoryCheckboxes.length === 0) {
                    showFieldError('request-subcategory', 'يرجى اختيار التصنيف الفرعي');
                    isValid = false;
                }
            }
            
            // Validate governorate
            if (currentGovernorates.length === 0) {
                showFieldError('request-governorate', 'يرجى اختيار محافظة واحدة على الأقل');
                isValid = false;
            }
            
            // Validate social media - at least one must be filled
            const whatsapp = document.getElementById('request-whatsapp').value.trim();
            const facebook = document.getElementById('request-facebook').value.trim();
            const instagram = document.getElementById('request-instagram').value.trim();
            
            if (!whatsapp && !facebook && !instagram) {
                showFieldError('social-media', 'يجب ملء حقل واحد على الأقل من وسائل التواصل الاجتماعي');
                isValid = false;
            } else {
                // Clear social media error if at least one is filled
                clearFieldError('social-media');
            }
            
            // Validate individual social media fields if they are filled
            if (whatsapp && !isValidWhatsAppNumber(whatsapp)) {
                showFieldError('request-whatsapp', 'يرجى إدخال رقم واتساب صحيح');
                isValid = false;
            }
            
            if (facebook && !isValidFacebookUrl(facebook)) {
                showFieldError('request-facebook', 'يرجى إدخال رابط فيسبوك صحيح (يقبل جميع أنواع الروابط: صفحات، مجموعات، أحداث، منشورات، صور، فيديوهات، hashtags، روابط قصيرة)');
                isValid = false;
            }
            
            if (instagram && !isValidInstagramUsername(instagram)) {
                showFieldError('request-instagram', 'يرجى إدخال اسم مستخدم إنستجرام صحيح');
                isValid = false;
            }
            
            // Show global error banner if validation fails
            if (!isValid) {
                showGlobalErrorBanner();
            } else {
                hideGlobalErrorBanner();
            }
            
            return isValid;
        }
        
        // Validate WhatsApp number format
        function isValidWhatsAppNumber(phone) {
            // Remove all non-digit characters
            const cleanPhone = phone.replace(/\D/g, '');
            
            // Check if it's a valid Egyptian phone number
            // Egyptian numbers start with 01 and are 11 digits long
            if (cleanPhone.length === 11 && cleanPhone.startsWith('01')) {
                return true;
            }
            
            // Check if it's a valid international format
            if (cleanPhone.length === 12 && cleanPhone.startsWith('20')) {
                return true;
            }
            
            // Check if it's a valid international format with +
            if (phone.startsWith('+') && (cleanPhone.length === 12 || cleanPhone.length === 11)) {
                return true;
            }
            
            return false;
        }
        
        // Validate Facebook URL format - يقبل جميع أنواع روابط الفيس بوك
        function isValidFacebookUrl(url) {
            // تنظيف الرابط من المسافات
            url = url.trim();
            
            // إذا كان الرابط فارغاً، يعتبر صحيحاً (حقل اختياري)
            if (!url) {
                return true;
            }
            
            // نمط مبسط وشامل لجميع أنواع روابط فيسبوك
            // يقبل أي رابط يحتوي على facebook.com أو fb.me
            const facebookRegex = /^https?:\/\/(www\.)?(facebook\.com|fb\.me)\/.+/;
            
            return facebookRegex.test(url);
        }
        
        // Validate Instagram username format
        function isValidInstagramUsername(username) {
            const instagramRegex = /^[a-zA-Z0-9._]{1,30}$/;
            return instagramRegex.test(username);
        }
        
        // Show field error
        function showFieldError(fieldId, message) {
            const errorElement = document.getElementById(`${fieldId}-error`);
            let fieldElement = document.getElementById(fieldId);
            
            if (errorElement) {
                errorElement.textContent = message;
                errorElement.classList.remove('hidden');
                errorElement.classList.add('show');
                
                // Add error styling to field
                if (fieldElement) {
                    fieldElement.classList.add('field-error');
                }
                
                // Special handling for governorate and subcategory
                if (fieldId === 'request-governorate') {
                    const dropdownBtn = document.getElementById('request-governorate-dropdown-btn');
                    if (dropdownBtn) {
                        dropdownBtn.classList.add('field-error');
                        // Also add error styling to the entire governorate section
                        const governorateSection = dropdownBtn.closest('.simple-governorate-filter');
                        if (governorateSection) {
                            governorateSection.classList.add('field-error');
                        }
                    }
                } else if (fieldId === 'request-subcategory') {
                    const subcategoryGroup = document.getElementById('request-subcategory-group');
                    if (subcategoryGroup) {
                        subcategoryGroup.classList.add('field-error');
                        // Add error styling to the subcategory options container
                        const subcategoryOptions = document.getElementById('request-subcategory-options');
                        if (subcategoryOptions) {
                            subcategoryOptions.classList.add('field-error');
                        }
                    }
                }
            }
        }
        
        // Clear field error
        function clearFieldError(fieldId) {
            const errorElement = document.getElementById(`${fieldId}-error`);
            let fieldElement = document.getElementById(fieldId);
            
            if (errorElement) {
                errorElement.classList.add('hidden');
                errorElement.classList.remove('show');
                
                // Remove error styling from field
                if (fieldElement) {
                    fieldElement.classList.remove('field-error');
                }
                
                // Special handling for governorate and subcategory
                if (fieldId === 'request-governorate') {
                    const dropdownBtn = document.getElementById('request-governorate-dropdown-btn');
                    if (dropdownBtn) {
                        dropdownBtn.classList.remove('field-error');
                        // Also remove error styling from the entire governorate section
                        const governorateSection = dropdownBtn.closest('.simple-governorate-filter');
                        if (governorateSection) {
                            governorateSection.classList.remove('field-error');
                        }
                    }
                } else if (fieldId === 'request-subcategory') {
                    const subcategoryGroup = document.getElementById('request-subcategory-group');
                    if (subcategoryGroup) {
                        subcategoryGroup.classList.remove('field-error');
                        // Remove error styling from the subcategory options container
                        const subcategoryOptions = document.getElementById('request-subcategory-options');
                        if (subcategoryOptions) {
                            subcategoryOptions.classList.remove('field-error');
                        }
                    }
                }
            }
        }
        
        // Clear all field errors
        function clearAllFieldErrors() {
            const errorElements = document.querySelectorAll('.validation-error');
            const fieldElements = document.querySelectorAll('.field-error');
            
            errorElements.forEach(element => {
                element.classList.add('hidden');
                element.classList.remove('show');
            });
            
            fieldElements.forEach(element => {
                element.classList.remove('field-error');
            });
            
            // Also clear any special error styling
            const governorateSection = document.querySelector('.simple-governorate-filter.field-error');
            if (governorateSection) {
                governorateSection.classList.remove('field-error');
            }
            
            const subcategoryGroup = document.getElementById('request-subcategory-group');
            if (subcategoryGroup && subcategoryGroup.classList.contains('field-error')) {
                subcategoryGroup.classList.remove('field-error');
            }
            
            const subcategoryOptions = document.getElementById('request-subcategory-options');
            if (subcategoryOptions && subcategoryOptions.classList.contains('field-error')) {
                subcategoryOptions.classList.remove('field-error');
            }
        }
        
        // Show loading state
        function showLoading(button) {
            button.innerHTML = `
                <svg class="animate-spin h-5 w-5 inline ml-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                جاري الإرسال...
            `;
            button.disabled = true;
        }
        
        // Show success message
        function showSuccessMessage(message) {
            // Show success notification
            showNotification(message, 'success');
        }
        
        // Show error message
        function showErrorMessage(message, fieldId = null) {
            if (fieldId) {
                showFieldError(fieldId, message);
            } else {
                showNotification(message, 'error');
            }
        }


        
        // الانتقال التلقائي للنموذج بعد إعادة التحميل
        function scrollToFormAfterReload() {
            if (sessionStorage.getItem('scrollToForm') === 'true') {
                // إزالة العلامة من الذاكرة المؤقتة
                sessionStorage.removeItem('scrollToForm');
                
                // انتظار قليل لضمان تحميل الصفحة
                setTimeout(() => {
                    const formSection = document.getElementById('product-request-section');
                    if (formSection) {
                        // الانتقال السلس للنموذج مع تعويض ارتفاع الهيدر
                        const headerHeight = document.querySelector('header').offsetHeight;
                        const formTop = formSection.offsetTop - headerHeight - 20;
                        
                        window.scrollTo({
                            top: formTop,
                            behavior: 'smooth'
                        });
                        
                        // إضافة تأثير بصري للنموذج
                        formSection.style.transition = 'all 0.3s ease';
                        formSection.style.transform = 'scale(1.02)';
                        formSection.style.boxShadow = '0 20px 40px rgba(0,0,0,0.1)';
                        
                        setTimeout(() => {
                            formSection.style.transform = 'scale(1)';
                            formSection.style.boxShadow = '0 4px 12px rgba(0,0,0,0.05)';
                        }, 300);
                    }
                }, 500);
            }
        }
        
        // تشغيل الانتقال التلقائي عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', scrollToFormAfterReload);
        
        // Load category products
        document.addEventListener('DOMContentLoaded', loadCategoryProducts);
        
        // Function to load products for each category
        async function loadCategoryProducts() {
            console.log('🎯 Loading category products...');
            
            // Load products for each category
            await Promise.all([
                loadCategoryProductsByType('koshat', 'koshat'),
                loadCategoryProductsByType('cake', 'cake'),
                loadCategoryProductsByType('mirr', 'mirror'),
                loadCategoryProductsByType('other', 'other'),
                loadCategoryProductsByType('invitations', 'invitations')
            ]);
        }
        
        // Function to load products for a specific category
        async function loadCategoryProductsByType(categoryType, sectionId) {
            try {
                console.log(`🔄 Loading ${categoryType} products...`);
                
                const loadingElement = document.getElementById(`${sectionId}-loading`);
                const gridElement = document.getElementById(`${sectionId}-products-grid`);
                const noProductsElement = document.getElementById(`${sectionId}-no-products`);
                
                if (!loadingElement || !gridElement || !noProductsElement) {
                    console.error(`❌ Missing elements for ${sectionId}`);
                    return;
                }
                
                // Show loading
                loadingElement.classList.remove('hidden');
                gridElement.classList.add('hidden');
                noProductsElement.classList.add('hidden');
                
                // Get products - PRIORITY: Ads first, then regular products
                let products = [];
                
                // 1. FIRST: Try to get advertisements (paid priority)
                if (window.advertisingService) {
                    try {
                        const ads = await window.advertisingService.getProductsByCategory(categoryType, 9);
                        if (ads && ads.length > 0) {
                            products = ads;
                            console.log(`✅ Found ${ads.length} ads for ${categoryType}`);
                        }
                    } catch (error) {
                        console.log(`No ads found for ${categoryType}:`, error);
                    }
                }
                
                // تم إزالة المنتجات العادية - الإعلانات فقط
                console.log(`🎯 Showing only ads for ${categoryType} - no regular products`);
                
                // Hide loading
                loadingElement.classList.add('hidden');
                
                if (products.length > 0) {
                    console.log(`✅ Found ${products.length} products for ${categoryType}`);
                    
                    // إخفاء رسالة "لا توجد منتجات" عند وجود منتجات
                    if (noProductsElement) {
                        noProductsElement.classList.add('hidden');
                    }
                    
                    // Display products in 3x3 grid
                    displayCategoryProducts(gridElement, products, categoryType);
                    gridElement.classList.remove('hidden');
                    
                } else {
                    console.log(`⚠️ No products found for ${categoryType}`);
                    
                    // إخفاء شبكة المنتجات عند عدم وجود منتجات
                    if (gridElement) {
                        gridElement.classList.add('hidden');
                    }
                    
                    // إظهار رسالة "لا توجد منتجات" مع النص الصحيح
                    if (noProductsElement) {
                        const titleElement = noProductsElement.querySelector('h3');
                        const messageElement = noProductsElement.querySelector('p');
                        
                        if (titleElement) titleElement.textContent = 'لا توجد منتجات في هذا التصنيف';
                        if (messageElement) messageElement.textContent = 'سنقوم بإضافة منتجات جديدة قريباً';
                        
                        noProductsElement.classList.remove('hidden');
                    }
                }
                
            } catch (error) {
                console.error(`❌ Error loading ${categoryType} products:`, error);
                
                // Hide loading and show error
                const loadingElement = document.getElementById(`${sectionId}-loading`);
                const noProductsElement = document.getElementById(`${sectionId}-no-products`);
                
                if (loadingElement) loadingElement.classList.add('hidden');
                if (noProductsElement) {
                    // تغيير رسالة الخطأ لتكون أكثر وضوحاً
                    const titleElement = noProductsElement.querySelector('h3');
                    const messageElement = noProductsElement.querySelector('p');
                    
                    if (titleElement) titleElement.textContent = 'خطأ في تحميل المنتجات';
                    if (messageElement) messageElement.textContent = 'حدث خطأ أثناء تحميل المنتجات. يرجى المحاولة مرة أخرى.';
                    
                    noProductsElement.classList.remove('hidden');
                }
            }
        }
        
        // Function to display products in 3x3 grid
        function displayCategoryProducts(gridElement, products, categoryType) {
            // Limit to 9 products maximum
            const limitedProducts = products.slice(0, 9);
            
            // Create HTML for products
            const productsHTML = limitedProducts.map((product, index) => {
                // Handle different product formats
                let imageUrl, productName, productPrice, productId;
                
                if (product.ad_id) {
                    // This is an advertisement
                    imageUrl = product.image_url || 'https://placehold.co/300x200/EEE/31343C?text=لا+توجد+صورة';
                    productName = product.name || product.description || 'منتج مميز';
                    productPrice = product.price || 0;
                    productId = product.product_id || product.id;
                } else {
                    // This is a regular product
                    imageUrl = product.image_urls && product.image_urls.length > 0 
                        ? product.image_urls[0] 
                        : 'https://placehold.co/300x200/EEE/31343C?text=لا+توجد+صورة';
                    productName = product.description || 'منتج';
                    productPrice = product.price || 0;
                    productId = product.id;
                }
                
                // تم إزالة اسم التصنيف للمنتجات المميزة والموصى بها
                // let categoryDisplay = '';
                // if (categoryType === 'featured' || categoryType === 'recommended') {
                //     categoryDisplay = `<div class="category-product-name mb-2">${productName}</div>`;
                // }
                
                return `
                    <div class="category-product-card" onclick="openProductDetails('${productId}', '${product.ad_id || ''}')">
                        <img src="${imageUrl}" 
                             alt="${productName}" 
                             loading="lazy"
                             decoding="async">
                        <div class="category-product-info">
                            <div class="mb-2">
                                <div class="flex flex-wrap gap-1">
                                    ${product.governorate ? `<span class="inline-flex items-center bg-gray-100 text-gray-800 text-xs px-2 py-1 rounded-full whitespace-nowrap">${product.governorate}</span>` : ''}
                                    ${product.cities && product.cities.trim() !== '' && product.cities !== 'جميع المدن' ? `<span class="inline-flex items-center bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded-full whitespace-nowrap">${product.cities.split(',')[0].trim()}</span>` : ''}
                                </div>
                            </div>
                            <div class="category-product-price">${productPrice > 0 ? 'ج.م ' + productPrice : 'سعر عند الطلب'}</div>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Update grid content
            gridElement.innerHTML = productsHTML;
        }
    </script>
    
    <!-- Floating Add Product Button -->
    <div class="fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50" id="floating-add-product-btn">
        <a href="pages/add-product-request.html" class="inline-flex items-center justify-center text-white px-6 py-4 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 font-semibold text-lg" style="background: #845FCE;">
            <svg class="w-6 h-6 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
            أضف منتجك
        </a>
    </div>

    <script>
        // إخفاء الزر العائم في صفحة إضافة المنتج
        function hideFloatingButtonOnAddProductPage() {
            // التحقق من أننا في الصفحة الرئيسية
            if (window.location.pathname.endsWith('index.html') || window.location.pathname === '/' || window.location.pathname === '') {
                // إظهار الزر العائم في الصفحة الرئيسية
                const floatingBtn = document.getElementById('floating-add-product-btn');
                if (floatingBtn) {
                    floatingBtn.style.display = 'block';
                }
            } else {
                // إخفاء الزر العائم في الصفحات الأخرى
                const floatingBtn = document.getElementById('floating-add-product-btn');
                if (floatingBtn) {
                    floatingBtn.style.display = 'none';
                }
            }
        }

        // تشغيل الدالة عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', hideFloatingButtonOnAddProductPage);
        
        // تشغيل الدالة أيضاً عند تغيير الصفحة (للصفحات التي تستخدم JavaScript routing)
        window.addEventListener('popstate', hideFloatingButtonOnAddProductPage);
    </script>
</body>
</html> 