# إصلاح مشكلة التصنيفات في صفحة المنتجات المميزة والمفضلة

## المشكلة الأصلية

كانت هناك عدة مشاكل في عرض التصنيفات:

1. **في الصفحة الرئيسية**: التصنيفات الفرعية للمرايا تظهر باللغة الإنجليزية بدلاً من العربية
2. **في صفحة المفضلة**: المنتجات من تصنيف "مرايا" تظهر تحت تصنيف "ديكور" بالخطأ
3. **عدم توحيد منطق التصنيفات** بين الصفحات المختلفة

## الإصلاحات المطبقة

### 1. إنشاء ملف مشترك للتصنيفات (`js/common-utils.js`)

تم إنشاء ملف يحتوي على دوال موحدة لإدارة التصنيفات:

- `getCategoryName(category)`: ترجمة التصنيفات الرئيسية للعربية
- `getSubcategoryName(subcategory)`: ترجمة التصنيفات الفرعية للعربية
- `getSubcategoryDisplayInfo(subcategory)`: معلومات العرض مع الألوان

### 2. تصحيح مفاتيح التصنيفات الفرعية للمرايا

تم إضافة دعم للمفاتيح المختلفة:
- `mirr-wedding` → `مرايا زفاف`
- `mirror-wedding` → `مرايا زفاف` (مفتاح بديل)
- `mirr-engagement` → `مرايا خطوبة`
- `mirr-birthday` → `مرايا عيد ميلاد`
- `mirr-decorative` → `مرايا ديكور`
- `mirr-custom` → `مرايا مخصصة`
- `mirr-classic` → `مرايا كلاسيكية`
- `mirr-modern` → `مرايا عصرية`
- `mirr-luxury` → `مرايا فاخرة`

### 3. إضافة التصنيف الرئيسي عند حفظ المنتج في المفضلة

تم تحديث جميع الصفحات لتحفظ التصنيف الرئيسي مع المنتج:

- **الصفحة الرئيسية**: `category: getProductCategory(productId)`
- **صفحة المرايا**: `category: 'mirr'`
- **صفحة الكوشات**: `category: 'koshat'`
- **صفحة التورتات**: `category: 'cake'`
- **صفحة الدعوات**: `category: 'invitations'`
- **صفحة الديكورات الأخرى**: `category: 'other'`
- **صفحة تفاصيل المنتج**: `category: currentProduct.category || 'other'`

### 4. تحديث عرض التصنيفات في صفحة المفضلة

تم تحديث صفحة المفضلة لتعرض:
- **التصنيف الرئيسي** (مثل: مرايا، كوشات، تورتات)
- **التصنيفات الفرعية** (مثل: مرآة زفاف، مرآة خطوبة)

### 5. توحيد منطق التصنيفات

تم إضافة ملف `common-utils.js` إلى جميع الصفحات:
- `index.html`
- `pages/favorites.html`
- `pages/category-mirr.html`
- `pages/category-koshat.html`
- `pages/category-cake.html`
- `pages/category-invitations.html`
- `pages/category-other.html`
- `pages/product-details.html`

## النتيجة المتوقعة

بعد تطبيق هذه الإصلاحات:

✅ **في الصفحة الرئيسية**: التصنيفات الفرعية للمرايا تظهر باللغة العربية  
✅ **في صفحة المفضلة**: المنتجات تحتفظ بتصنيفها الصحيح (مرايا) دون تغيير  
✅ **توحيد منطق التصنيفات** في جميع الصفحات والأقسام  

## كيفية الاختبار

1. افتح الصفحة الرئيسية وتأكد من ظهور التصنيفات الفرعية للمرايا بالعربية
2. أضف منتج من تصنيف المرايا إلى المفضلة
3. انتقل إلى صفحة المفضلة وتأكد من ظهوره تحت تصنيف "مرايا" وليس "ديكور"
4. تأكد من ظهور التصنيفات الفرعية باللغة العربية في جميع الصفحات

## الملفات المعدلة

- `js/common-utils.js` (جديد)
- `index.html`
- `pages/favorites.html`
- `pages/category-mirr.html`
- `pages/category-koshat.html`
- `pages/category-cake.html`
- `pages/category-invitations.html`
- `pages/category-other.html`
- `pages/product-details.html`
